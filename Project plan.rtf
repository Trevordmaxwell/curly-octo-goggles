{\rtf1\ansi\ansicpg1252{\fonttbl{\f0\fbidis\froman\fcharset0 Times New Roman;}{\f1\fbidis\froman\fcharset0 Cambria;}{\f2\fbidis\fswiss\fcharset0 Arial;}{\f3\fbidis\fswiss\fcharset0 MS PGothic;}{\f4\fbidis\fswiss\fcharset0 Segoe UI Symbol;}}{\colortbl ;\red0 \green0 \blue0;}{\stylesheet{\fs22\f2\sqformat\spriority1 Normal}{\s1\f2\fs22\sbasedon0\sqformat\spriority1 Body Text}{\s2\li233\fi-133\sb38\f2\sbasedon0\sqformat\spriority1 List Paragraph}{\s3\sbasedon0\sqformat\spriority1 Table Paragraph}}{\*\listtable{\list\listtemplateid2181{\listlevel\levelnfc23\leveljc0\li234\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1172\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2104\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3036\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3968\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4900\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5832\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6764\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7696\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1026}{\list\listtemplateid2182{\listlevel\levelnfc23\leveljc0\li234\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1172\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2104\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3036\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3968\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4900\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5832\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6764\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7696\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1027}{\list\listtemplateid2183{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1028}{\list\listtemplateid2184{\listlevel\levelnfc0\levelstartat1\leveljc0\li100\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'01.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li344\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1702\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2825\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3947\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6192\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7315\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1029}{\list\listtemplateid2185{\listlevel\levelnfc23\leveljc0\li722\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1604\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2488\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3372\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4256\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5140\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6024\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6908\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7792\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1030}{\list\listtemplateid2186{\listlevel\levelnfc0\levelstartat1\leveljc0\li833\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1712\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2584\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3456\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4328\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5200\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6072\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6944\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7816\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1031}{\list\listtemplateid2187{\listlevel\levelnfc23\leveljc0\li478\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2296\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3204\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4112\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5020\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5928\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6836\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7744\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1032}{\list\listtemplateid2188{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li661\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1648\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2637\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3626\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4615\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5604\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6593\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7582\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1033}{\list\listtemplateid2189{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1034}{\list\listtemplateid2190{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li344\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1577\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2575\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3573\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4571\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5568\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6566\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7564\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1035}{\list\listtemplateid2191{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1036}{\list\listtemplateid2192{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1037}{\list\listtemplateid2193{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1038}{\list\listtemplateid2194{\listlevel\levelnfc0\levelstartat1\leveljc0\li833\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1712\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2584\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3456\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4328\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5200\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6072\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6944\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7816\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1039}{\list\listtemplateid2195{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1040}{\list\listtemplateid2196{\listlevel\levelnfc23\leveljc0\li588\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1041}{\list\listtemplateid2197{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1046\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1992\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2938\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3884\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4830\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5776\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6722\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7668\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1042}{\list\listtemplateid2198{\listlevel\levelnfc0\levelstartat1\leveljc0\li344\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1262\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2184\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3106\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4028\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4950\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5872\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6794\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7716\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1043}{\list\listtemplateid2199{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li356\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1382\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2404\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3426\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4448\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5471\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6493\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7515\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1044}{\list\listtemplateid2200{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1046\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1992\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2938\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3884\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4830\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5776\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6722\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7668\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1045}{\list\listtemplateid2201{\listlevel\levelnfc0\levelstartat1\leveljc0\li344\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li234\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1364\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3413\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4437\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5462\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6486\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7511\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1046}{\list\listtemplateid2202{\listlevel\levelnfc0\levelstartat1\leveljc0\li344\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li234\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1364\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3413\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4437\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5462\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6486\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7511\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1047}{\list\listtemplateid2203{\listlevel\levelnfc0\levelstartat1\leveljc0\li344\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1364\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3413\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4437\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5462\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6486\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7511\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1048}{\list\listtemplateid2204{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1046\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1992\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2938\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3884\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4830\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5776\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6722\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7668\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1049}{\list\listtemplateid2205{\listlevel\levelnfc23\leveljc0\li100\fi-190{\leveltext\'01>;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex99}{\listlevel\levelnfc23\leveljc0\li1046\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1992\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2938\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3884\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4830\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5776\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6722\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7668\fi-190{\leveltext\'01\'95;}{\levelnumbers;}}\listid1050}{\list\listtemplateid2206{\listlevel\levelnfc23\leveljc0\li478\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2296\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3204\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4112\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5020\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5928\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6836\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7744\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1051}{\list\listtemplateid2207{\listlevel\levelnfc23\leveljc0\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li921\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1843\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2764\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3686\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4607\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5529\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6450\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7372\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1052}{\list\listtemplateid2208{\listlevel\levelnfc23\leveljc0\li344\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1262\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2184\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3106\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4028\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4950\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5872\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6794\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7716\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1053}{\list\listtemplateid2209{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1054}{\list\listtemplateid2210{\listlevel\levelnfc23\leveljc0\li478\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1388\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2296\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3204\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4112\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5020\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5928\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6836\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7744\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1055}{\list\listtemplateid2211{\listlevel\levelnfc0\levelstartat1\leveljc0\li588\fi-245{\leveltext\'02\'00.;}{\levelnumbers\'01;}\f2\fs22\b0\i0\expnd0\expndtw-1\charscalex100}{\listlevel\levelnfc23\leveljc0\li1478\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2376\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3274\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4172\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5070\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5968\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6866\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7764\fi-245{\leveltext\'01\'95;}{\levelnumbers;}}\listid1056}{\list\listtemplateid2212{\listlevel\levelnfc23\leveljc0\li100\fi-135{\leveltext\'01-;}{\levelnumbers;}\f2\fs22\b0\i0\expnd0\expndtw0\charscalex100}{\listlevel\levelnfc23\leveljc0\li1046\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li1992\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li2938\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li3884\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li4830\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li5776\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li6722\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}{\listlevel\levelnfc23\leveljc0\li7668\fi-135{\leveltext\'01\'95;}{\levelnumbers;}}\listid1057}}{\*\listoverridetable{\listoverride\listoverridecount0\listid1057\ls32}{\listoverride\listoverridecount0\listid1056\ls31}{\listoverride\listoverridecount0\listid1055\ls30}{\listoverride\listoverridecount0\listid1054\ls29}{\listoverride\listoverridecount0\listid1053\ls28}{\listoverride\listoverridecount0\listid1052\ls27}{\listoverride\listoverridecount0\listid1051\ls26}{\listoverride\listoverridecount0\listid1050\ls25}{\listoverride\listoverridecount0\listid1049\ls24}{\listoverride\listoverridecount0\listid1048\ls23}{\listoverride\listoverridecount0\listid1047\ls22}{\listoverride\listoverridecount0\listid1046\ls21}{\listoverride\listoverridecount0\listid1045\ls20}{\listoverride\listoverridecount0\listid1044\ls19}{\listoverride\listoverridecount0\listid1043\ls18}{\listoverride\listoverridecount0\listid1042\ls17}{\listoverride\listoverridecount0\listid1041\ls16}{\listoverride\listoverridecount0\listid1040\ls15}{\listoverride\listoverridecount0\listid1039\ls14}{\listoverride\listoverridecount0\listid1038\ls13}{\listoverride\listoverridecount0\listid1037\ls12}{\listoverride\listoverridecount0\listid1036\ls11}{\listoverride\listoverridecount0\listid1035\ls10}{\listoverride\listoverridecount0\listid1034\ls9}{\listoverride\listoverridecount0\listid1033\ls8}{\listoverride\listoverridecount0\listid1032\ls7}{\listoverride\listoverridecount0\listid1031\ls6}{\listoverride\listoverridecount0\listid1030\ls5}{\listoverride\listoverridecount0\listid1029\ls4}{\listoverride\listoverridecount0\listid1028\ls3}{\listoverride\listoverridecount0\listid1027\ls2}{\listoverride\listoverridecount0\listid1026\ls1}}{\info{\creatim\yr2025\mo10\dy3\hr16\min30\sec34}{\title Untitled document}}{\*\userprops {\propname Producer}\proptype30{\staticval Skia/PDF m142 Google Docs Renderer}}\jexpand\dntblnsbdb\viewkind1\noxlattoyen\nospaceforul\useltbaln\paperw12240\paperh15840\margl1340\margr1340\margt1360\margb280\noindnmbrts\sectd\sbknone\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-2\expndtw-11  \expnd0\expndtw0 Project\expnd-2\expndtw-8  \expnd0\expndtw0 Brief:\expnd-2\expndtw-9  \expnd0\expndtw0 Unified\expnd-2\expndtw-8  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-2\expndtw-9  \expnd0\expndtw0 Architecture\expnd-2\expndtw-8  \expnd0\expndtw0 (Option\expnd-2\expndtw-8  \expnd-1\expndtw-5 3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Goal**:\expnd-1\expndtw-5  \expnd0\expndtw0 Create\expnd-1\expndtw-5  \expnd0\expndtw0 a\expnd-1\expndtw-5  \expnd0\expndtw0 theoretically\expnd-1\expndtw-5  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw0 architecture\expnd-1\expndtw-5  \expnd0\expndtw0 where\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-5  \expnd0\expndtw0 computation\expnd-1\expndtw-5  \expnd0\expndtw0 *is* the Hopfield energy minimization process. Memory retrieval, state evolution, and reasoning converge to a single equilibrium that simultaneously satisfies both the DEQ dynamics and the Hopfield energy minimum.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri256\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Core\expnd-1\expndtw-3  \expnd0\expndtw0 Insight**:\expnd-1\expndtw-3  \expnd0\expndtw0 Rather\expnd-1\expndtw-3  \expnd0\expndtw0 than\expnd-1\expndtw-3  \expnd0\expndtw0 treating\expnd-1\expndtw-3  \expnd0\expndtw0 MHN\expnd-1\expndtw-3  \expnd0\expndtw0 as\expnd-1\expndtw-3  \expnd0\expndtw0 a\expnd-1\expndtw-3  \expnd0\expndtw0 separate\expnd-1\expndtw-3  \expnd0\expndtw0 memory\expnd-1\expndtw-3  \expnd0\expndtw0 module,\expnd-1\expndtw-3  \expnd0\expndtw0 we\expnd-1\expndtw-3  \expnd0\expndtw0 embed\expnd-1\expndtw-3  \expnd0\expndtw0 Hopfield dynamics\expnd-1\expndtw-4  \expnd0\expndtw0 directly\expnd-1\expndtw-4  \expnd0\expndtw0 into\expnd-1\expndtw-4  \expnd0\expndtw0 the\expnd-1\expndtw-4  \expnd0\expndtw0 DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 iteration\expnd-1\expndtw-4  \expnd0\expndtw0 structure.\expnd-1\expndtw-4  \expnd0\expndtw0 Each\expnd-1\expndtw-4  \expnd0\expndtw0 DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 step\expnd-1\expndtw-4  \expnd0\expndtw0 performs\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw0 state\expnd-1\expndtw-4  \expnd0\expndtw0 updates (Mamba-driven) and memory operations (Hopfield-driven) until the system reaches a joint \expnd0\expndtw-2 equilibrium.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Target**: Research-grade implementation with rigorous mathematical foundations, energy-based\expnd-1\expndtw-6  \expnd0\expndtw0 training\expnd-1\expndtw-6  \expnd0\expndtw0 objectives,\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 experiments\expnd-1\expndtw-6  \expnd0\expndtw0 validating\expnd-1\expndtw-6  \expnd0\expndtw0 the\expnd-1\expndtw-6  \expnd0\expndtw0 unified\expnd-1\expndtw-6  \expnd0\expndtw0 convergence \expnd0\expndtw-2 properties.\par
{\shp{\*\shpinst
\shpleft1440\shptop441\shpright1807\shpbottom442
\shpfhdr0\shpwr3\shpwrk0\shplid31\shpz0
\shpbxpage\shpbypara\shpwr1{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn dxWrapDistLeft}{\sv 0}}{\sp{\sn dxWrapDistRight}{\sv 0}}{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
}}
\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb187\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-2\expndtw-10  \expnd0\expndtw0 Step-by-Step\expnd-2\expndtw-9  \expnd0\expndtw0 Implementation\expnd-2\expndtw-9  \expnd-1\expndtw-4 Plan\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-6  \expnd0\expndtw0 **Phase\expnd-1\expndtw-6  \expnd0\expndtw0 1:\expnd-1\expndtw-6  \expnd0\expndtw0 Theoretical\expnd-1\expndtw-6  \expnd0\expndtw0 Foundation\expnd-1\expndtw-6  \expnd0\expndtw0 &\expnd-1\expndtw-6  \expnd0\expndtw0 Repository\expnd-1\expndtw-6  \expnd0\expndtw0 Structure** #### **Repository Structure**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 unified-mamba-hopfield-\expnd-1\expndtw-4 deq/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd-1\expndtw-4 src/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  core/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3150\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  mamba.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-3  \expnd0\expndtw0 Mamba\expnd-1\expndtw-3  \expnd0\expndtw0 SSM\expnd-1\expndtw-3  \expnd0\expndtw-2 layers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3012\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  energy.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Energy\expnd-1\expndtw-5  \expnd0\expndtw0 function\expnd-1\expndtw-5  \expnd0\expndtw-2 definitions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3163\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  dynamics.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Unified\expnd-1\expndtw-4  \expnd0\expndtw0 dynamics\expnd-1\expndtw-4  \expnd0\expndtw0 (f\expnd-1\expndtw-4  \expnd0\expndtw0 that\expnd-1\expndtw-3  \expnd0\expndtw0 is\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw0 DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-3  \expnd0\expndtw-2 Hopfield)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3114\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  equilibrium.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Joint\expnd-1\expndtw-6  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-5  \expnd0\expndtw-2 solver\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  models/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2943\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  unified.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Full\expnd-1\expndtw-4  \expnd0\expndtw0 unified\expnd-1\expndtw-4  \expnd0\expndtw-2 architecture\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3310\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  components.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Modular\expnd-1\expndtw-5  \expnd0\expndtw0 building\expnd-1\expndtw-5  \expnd0\expndtw-2 blocks\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3102\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  pretrained.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Interface\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 loading\expnd-1\expndtw-5  \expnd0\expndtw0 base\expnd-1\expndtw-4  \expnd0\expndtw-2 models\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  solvers/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3114\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  fixed_point.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-5  \expnd0\expndtw-2 solvers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3261\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  energy_min.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 minimization\expnd-1\expndtw-6  \expnd0\expndtw-2 solvers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3224\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  hybrid_solver.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Unified\expnd-1\expndtw-5  \expnd0\expndtw0 solver\expnd-1\expndtw-5  \expnd0\expndtw0 (both\expnd-1\expndtw-4  \expnd0\expndtw-2 objectives)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  training/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3090\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  objectives.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Energy-based\expnd-1\expndtw-6  \expnd0\expndtw0 loss\expnd-1\expndtw-5  \expnd0\expndtw-2 functions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\tx2906\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  trainer.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Training\expnd-2\expndtw-8  \expnd-1\expndtw-4 loop\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3163\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  schedules.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Curriculum\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw-2 annealing\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  analysis/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3310\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  convergence.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Convergence\expnd-1\expndtw-7  \expnd0\expndtw0 analysis\expnd-1\expndtw-6  \expnd0\expndtw-2 tools\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd5\expndtw26   \expnd0\expndtw0 \uc1\u9474 ?\expnd5\expndtw27   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  \expnd0\expndtw0 energy_landscape.py\expnd5\expndtw26   \expnd0\expndtw0 #\expnd0\expndtw-2  \expnd0\expndtw0 Energy\expnd-1\expndtw-3  \expnd0\expndtw-2 visualization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2890\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  stability.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Lyapunov\expnd-2\expndtw-8  \expnd0\expndtw-2 analysis\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  utils/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx664\tx3038\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u9474 ?\expnd0\expndtw0 \tab \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 math_utils.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Linear\expnd-1\expndtw-5  \expnd0\expndtw0 algebra\expnd-1\expndtw-4  \expnd0\expndtw-2 helpers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx664\tx3050\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u9474 ?\expnd0\expndtw0 \tab \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-5  \expnd0\expndtw-2 visualization.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Plotting\expnd-1\expndtw-4  \expnd0\expndtw-2 utilities\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 experiments/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  theory/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd5\expndtw24   \expnd0\expndtw0 \uc1\u9474 ?\expnd5\expndtw25   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw0 convergence_proofs.py\expnd-1\expndtw-4  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 Empirical\expnd-1\expndtw-4  \expnd0\expndtw0 validation\expnd-1\expndtw-4  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw-2 theory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3395\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  energy_analysis.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Energy\expnd-1\expndtw-5  \expnd0\expndtw0 landscape\expnd-1\expndtw-5  \expnd0\expndtw-2 studies\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  tasks/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3419\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  memory_tasks.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-11  \expnd0\expndtw0 Memory-intensive\expnd-2\expndtw-8  \expnd0\expndtw-2 benchmarks\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3408\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  reasoning_tasks.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Multi-step\expnd-1\expndtw-5  \expnd0\expndtw-2 reasoning\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3407\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  streaming_tasks.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Long-sequence\expnd-1\expndtw-7  \expnd0\expndtw-2 processing\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  configs/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 notebooks/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd15\expndtw76\charscalex150  \expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-5  \expnd0\expndtw0 theory_walkthrough.ipynb\expnd10\expndtw51  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 Mathematical\expnd-1\expndtw-5  \expnd0\expndtw-2 foundations\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  energy_visualization.ipynb\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  convergence_analysis.ipynb\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 tests/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  test_energy.py\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  test_convergence.py\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  test_gradients.py\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-5  \expnd0\expndtw-2 docs/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2948\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  theory.md\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Mathematical\expnd-1\expndtw-6  \expnd0\expndtw-2 documentation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3135\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  architecture.md\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Design\expnd-1\expndtw-3  \expnd0\expndtw-2 decisions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2830\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  api.md\expnd0\expndtw0 \tab #\expnd-1\expndtw-5  \expnd0\expndtw0 Code\expnd0\expndtw-2  reference\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 requirements.txt\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 setup.py\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 README.md\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-9  \expnd0\expndtw0 **Dependencies\expnd-2\expndtw-9  \expnd0\expndtw-2 (requirements.txt)**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8060\sl276\slmult1\f2\fs22\b0\expnd-1\expndtw-4\charscalex100 ``` \expnd0\expndtw-2 torch>=2.0.0 einops\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 scipy\expnd11\expndtw54  \expnd0\expndtw0 #\expnd-1\expndtw-3  \expnd0\expndtw0 For\expnd-1\expndtw-4  \expnd0\expndtw0 advanced\expnd-1\expndtw-3  \expnd0\expndtw-2 solvers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 jax[cpu]\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 Optional:\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 Hessian\expnd-1\expndtw-7  \expnd0\expndtw0 computations \expnd0\expndtw-2 mamba-ssm\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8798\qj\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 wandb pytest jupyter\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8060\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 matplotlib seaborn\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 networkx\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 For\expnd-1\expndtw-7  \expnd0\expndtw0 visualizing\expnd-1\expndtw-7  \expnd0\expndtw0 convergence\expnd-1\expndtw-7  \expnd0\expndtw0 graphs plotly\expnd8\expndtw40  \expnd0\expndtw0 # Interactive energy landscapes\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 sympy\expnd10\expndtw52  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 Symbolic\expnd-1\expndtw-4  \expnd0\expndtw0 math\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 theoretical\expnd-1\expndtw-4  \expnd0\expndtw-2 analysis\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par
{\shp{\*\shpinst
\shpleft1440\shptop478\shpright1807\shpbottom479
\shpfhdr0\shpwr3\shpwrk0\shplid104\shpz1
\shpbxpage\shpbypara\shpwr1{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn dxWrapDistLeft}{\sv 0}}{\sp{\sn dxWrapDistRight}{\sv 0}}{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
}}
\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb224\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd0\expndtw-2  \expnd0\expndtw0 **Phase\expnd0\expndtw-2  \expnd0\expndtw0 2:\expnd0\expndtw-2  \expnd0\expndtw0 Mathematical\expnd0\expndtw-2  \expnd0\expndtw0 Framework\expnd0\expndtw-2  \expnd0\expndtw0 &\expnd0\expndtw-2  \expnd0\expndtw0 Energy\expnd0\expndtw-2  \expnd0\expndtw0 Functions** ####\expnd-2\expndtw-8  \expnd0\expndtw0 **Step\expnd-1\expndtw-6  \expnd0\expndtw0 2.1:\expnd-1\expndtw-6  \expnd0\expndtw0 Unified\expnd-1\expndtw-6  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 Function\expnd-1\expndtw-5  \expnd0\expndtw-2 (src/core/energy.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Define\expnd-1\expndtw-4  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 single\expnd-1\expndtw-4  \expnd0\expndtw0 energy\expnd-1\expndtw-4  \expnd0\expndtw0 function\expnd-1\expndtw-4  \expnd0\expndtw0 that\expnd-1\expndtw-4  \expnd0\expndtw0 encompasses\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-4  \expnd0\expndtw0 memory\expnd-1\expndtw-4  \expnd0\expndtw0 retrieval\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw0 DEQ \expnd0\expndtw-2 equilibrium:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Theoretical\expnd-3\expndtw-13  \expnd0\expndtw-2 foundation**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E(z,\expnd-1\expndtw-5  \expnd0\expndtw0 x,\expnd-1\expndtw-4  \expnd0\expndtw0 M)\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 E_hopfield(z,\expnd-1\expndtw-4  \expnd0\expndtw0 M)\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 E_consistency(z,\expnd-1\expndtw-5  \expnd0\expndtw0 x)\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw-2 E_regularization(z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 where:\par\pard\plain\s2\ls1\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb35\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_hopfield(z,\expnd-2\expndtw-8  \expnd0\expndtw0 M)\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 -log(\uc1\u931 ?\uc1\u7522 ?\expnd-1\expndtw-7  \expnd0\expndtw0 exp(\uc1\u946 ?\f1 \uc1\u10216 ?\f2 z,\expnd-1\expndtw-7  \expnd0\expndtw0 m\uc1\u7522 ?\f1 \uc1\u10217 ?\f2 ))\expnd-1\expndtw-7  \expnd0\expndtw0 //\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw0 over\expnd-1\expndtw-7  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 patterns\expnd-1\expndtw-7  \expnd-2\expndtw-10 M\par\pard\plain\s2\ls1\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb36\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_consistency(z,\expnd-1\expndtw-6  \expnd0\expndtw0 x)\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 ||z\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-5  \expnd0\expndtw0 f_mamba(z,\expnd-1\expndtw-6  \expnd0\expndtw0 x)||\'B2\expnd-1\expndtw-5  \expnd0\expndtw0 //\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-5  \expnd0\expndtw-2 residual\par\pard\plain\s2\ls1\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb20\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_regularization(z)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u955 ?\f3 \uc1\u8321 ?\f2 ||z||\'B2\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u955 ?\f3 \uc1\u8322 ?\f2 ||\f3 \uc1\u8711 ?\f2 E||\'B2\expnd-1\expndtw-5  \expnd0\expndtw0 //\expnd-1\expndtw-6  \expnd0\expndtw0 Smoothness\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw-2 boundedness\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb23\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Key\expnd-2\expndtw-10  \expnd0\expndtw0 insight**:\expnd-2\expndtw-8  \expnd0\expndtw0 By\expnd-1\expndtw-7  \expnd0\expndtw0 minimizing\expnd-2\expndtw-8  \expnd0\expndtw0 this\expnd-2\expndtw-8  \expnd0\expndtw0 joint\expnd-1\expndtw-7  \expnd0\expndtw0 energy,\expnd-2\expndtw-8  \expnd0\expndtw0 we\expnd-1\expndtw-7  \expnd0\expndtw-2 simultaneously:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-9  \expnd0\expndtw0 Retrieve\expnd-1\expndtw-7  \expnd0\expndtw0 relevant\expnd-1\expndtw-7  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 patterns\expnd-1\expndtw-7  \expnd0\expndtw0 (Hopfield\expnd-1\expndtw-6  \expnd0\expndtw-2 objective)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Find\expnd-1\expndtw-5  \expnd0\expndtw0 a\expnd-1\expndtw-5  \expnd0\expndtw0 fixed\expnd-1\expndtw-5  \expnd0\expndtw0 point\expnd-1\expndtw-4  \expnd0\expndtw0 consistent\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 (DEQ\expnd-1\expndtw-4  \expnd0\expndtw-2 objective)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Ensure\expnd-1\expndtw-6  \expnd0\expndtw0 stable,\expnd-1\expndtw-6  \expnd0\expndtw0 bounded\expnd-1\expndtw-6  \expnd0\expndtw0 solutions\expnd-1\expndtw-6  \expnd0\expndtw-2 (regularization)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Implementation**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 UnifiedEnergyFunction(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-2\expndtw-8  \expnd0\expndtw0 function\expnd-1\expndtw-6  \expnd0\expndtw0 that\expnd-1\expndtw-6  \expnd0\expndtw0 unifies\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 retrieval\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-6  \expnd0\expndtw-2 equilibrium.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri1939\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-7  \expnd0\expndtw0 system\expnd-1\expndtw-7  \expnd0\expndtw0 naturally\expnd-1\expndtw-7  \expnd0\expndtw0 minimizes\expnd-1\expndtw-7  \expnd0\expndtw0 this\expnd-1\expndtw-7  \expnd0\expndtw0 energy,\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 the\expnd-1\expndtw-7  \expnd0\expndtw0 minimum\expnd-1\expndtw-7  \expnd0\expndtw0 corresponds to both a fixed point and an optimal memory retrieval state.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri7600\qr\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri7515\qr\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 d_model,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri3818\sl276\slmult1\sb38\tx2733\tx2782\tx3075\f2\fs22\b0\expnd0\expndtw-2\charscalex100 beta=1.0,\expnd0\expndtw0 \tab #\expnd-3\expndtw-14  \expnd0\expndtw0 Hopfield\expnd-3\expndtw-14  \expnd0\expndtw0 inverse\expnd-3\expndtw-14  \expnd0\expndtw0 temperature \expnd0\expndtw-2 alpha=1.0,\expnd0\expndtw0 \tab \tab # DEQ consistency weight \expnd0\expndtw-2 lambda_l2=0.01,\expnd0\expndtw0 \tab \tab # L2 regularization lambda_smooth=0.001 # Smoothness penalty\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 super().\f0\expnd16\expndtw80\charscalex150{\ul  \f2\expnd0\expndtw0\charscalex100}\f2\expnd0\expndtw0\charscalex100 init\f0\expnd16\expndtw80\charscalex150{\ul  \f2\expnd0\expndtw0\charscalex100}\f2\expnd0\expndtw0\charscalex100 () self.d_model\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 d_model self.beta = beta self.alpha = alpha\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.lambda_l2 = lambda_l2 self.lambda_smooth\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 lambda_smooth\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 hopfield_energy(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl-255\f2\fs22\b0\expnd0\expndtw0\charscalex100 Modern\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 energy:\expnd-1\expndtw-7  \expnd0\expndtw0 E\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 -log(\uc1\u931 ?\uc1\u7522 ?\expnd-1\expndtw-6  \expnd0\expndtw0 exp(\uc1\u946 ?\f1 \uc1\u10216 ?\f2 z,\expnd-1\expndtw-7  \expnd0\expndtw-2 m\uc1\u7522 ?\f1 \uc1\u10217 ?\f2 ))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb74\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z:\expnd-1\expndtw-5  \expnd0\expndtw0 Current\expnd-1\expndtw-4  \expnd0\expndtw0 state\expnd-1\expndtw-4  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri4507\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 memory_patterns:\expnd-2\expndtw-10  \expnd0\expndtw0 Stored\expnd-2\expndtw-10  \expnd0\expndtw0 patterns\expnd-2\expndtw-10  \expnd0\expndtw0 (M,\expnd-2\expndtw-10  \expnd0\expndtw0 D) \expnd0\expndtw-2 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-2\expndtw-8  \expnd0\expndtw0 scalar\expnd-1\expndtw-5  \expnd0\expndtw0 (minimized\expnd-1\expndtw-6  \expnd0\expndtw0 when\expnd-1\expndtw-5  \expnd0\expndtw0 z\expnd-1\expndtw-5  \expnd0\expndtw0 aligns\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 stored\expnd-1\expndtw-5  \expnd0\expndtw-2 patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Compute\expnd-1\expndtw-5  \expnd0\expndtw0 similarities\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 all\expnd-1\expndtw-5  \expnd0\expndtw-2 patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 similarities\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.beta\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 torch.matmul(z,\expnd-1\expndtw-6  \expnd0\expndtw0 memory_patterns.T)\expnd10\expndtw48  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (B,\expnd-1\expndtw-6  \expnd-1\expndtw-5 M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Log-sum-exp\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 numerical\expnd-1\expndtw-6  \expnd0\expndtw-2 stability\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 energy\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 -torch.logsumexp(similarities,\expnd-1\expndtw-7  \expnd0\expndtw0 dim=-1)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (B,) return energy.mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5224\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 consistency_energy(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 z_next): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 DEQ\expnd-1\expndtw-7  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-4  \expnd0\expndtw0 residual:\expnd-1\expndtw-4  \expnd0\expndtw0 E\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 ||z\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw-2 f(z)||\'B2\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Measures\expnd-1\expndtw-5  \expnd0\expndtw0 how\expnd-1\expndtw-5  \expnd0\expndtw0 far\expnd-1\expndtw-5  \expnd0\expndtw0 z\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw0 from\expnd-1\expndtw-5  \expnd0\expndtw0 being\expnd-1\expndtw-5  \expnd0\expndtw0 a\expnd-1\expndtw-5  \expnd0\expndtw0 fixed\expnd-1\expndtw-5  \expnd0\expndtw0 point. Minimum (0) achieved when z = f(z).\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 residual\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 z\expnd-1\expndtw-3  \expnd0\expndtw0 -\expnd0\expndtw-2  z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 energy\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.sum(residual\expnd-1\expndtw-6  \expnd0\expndtw0 **\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 dim=-1)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 (B,) return energy.mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 regularization_energy(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z,\expnd-2\expndtw-10  \expnd0\expndtw-2 grad_z=None):\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Regularization\expnd-2\expndtw-11  \expnd0\expndtw0 terms\expnd-2\expndtw-11  \expnd0\expndtw0 for\expnd-2\expndtw-11  \expnd0\expndtw0 stable\expnd-2\expndtw-11  \expnd0\expndtw0 solutions. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 L2\expnd-1\expndtw-5  \expnd0\expndtw0 norm\expnd-1\expndtw-5  \expnd0\expndtw0 penalty\expnd-1\expndtw-6  \expnd0\expndtw0 (prevents\expnd-1\expndtw-5  \expnd0\expndtw0 unbounded\expnd-1\expndtw-5  \expnd0\expndtw-2 states)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 l2_energy\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 self.lambda_l2\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-6  \expnd0\expndtw0 torch.sum(z\expnd-1\expndtw-7  \expnd0\expndtw0 **\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 dim=-\expnd0\expndtw-2 1).mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1939\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Smoothness\expnd-1\expndtw-7  \expnd0\expndtw0 penalty\expnd-1\expndtw-7  \expnd0\expndtw0 (encourages\expnd-1\expndtw-7  \expnd0\expndtw0 smooth\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw0 landscapes) smooth_energy = 0.0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-4  \expnd0\expndtw0 grad_z\expnd-1\expndtw-3  \expnd0\expndtw0 is\expnd-1\expndtw-3  \expnd0\expndtw0 not\expnd-1\expndtw-3  \expnd0\expndtw-2 None:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri511\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 smooth_energy\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 self.lambda_smooth\expnd-1\expndtw-6  \expnd0\expndtw0 *\expnd-1\expndtw-6  \expnd0\expndtw0 torch.sum(grad_z\expnd-1\expndtw-6  \expnd0\expndtw0 **\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 dim=-1).mean() return l2_energy + smooth_energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 forward(self,\expnd-2\expndtw-9  \expnd0\expndtw0 z,\expnd-2\expndtw-9  \expnd0\expndtw0 z_next,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns,\expnd-2\expndtw-9  \expnd0\expndtw0 compute_grad=False): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Compute\expnd-1\expndtw-7  \expnd0\expndtw0 total\expnd-1\expndtw-6  \expnd0\expndtw0 unified\expnd-1\expndtw-6  \expnd0\expndtw-2 energy.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z:\expnd-1\expndtw-5  \expnd0\expndtw0 Current\expnd-1\expndtw-4  \expnd0\expndtw-2 state\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next:\expnd-2\expndtw-8  \expnd0\expndtw0 Next\expnd-2\expndtw-8  \expnd0\expndtw0 state\expnd-2\expndtw-8  \expnd0\expndtw0 f(z)\expnd-2\expndtw-8  \expnd0\expndtw0 from\expnd-2\expndtw-8  \expnd0\expndtw0 dynamics memory_patterns: Memory bank\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 compute_grad:\expnd-2\expndtw-8  \expnd0\expndtw0 Whether\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-2\expndtw-8  \expnd0\expndtw0 compute\expnd-1\expndtw-7  \expnd0\expndtw0 gradient\expnd-1\expndtw-7  \expnd0\expndtw-2 energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Total\expnd-3\expndtw-15  \expnd0\expndtw0 energy,\expnd-3\expndtw-14  \expnd0\expndtw0 dict\expnd-3\expndtw-15  \expnd0\expndtw0 of\expnd-3\expndtw-14  \expnd0\expndtw-2 components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-4  \expnd0\expndtw-2 component\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_hop\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 self.hopfield_energy(z,\expnd-2\expndtw-9  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw0 consistency\expnd-1\expndtw-5  \expnd0\expndtw-2 component\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_cons\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.alpha\expnd-2\expndtw-9  \expnd0\expndtw0 *\expnd-2\expndtw-9  \expnd0\expndtw0 self.consistency_energy(z,\expnd-2\expndtw-8  \expnd0\expndtw-2 z_next)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri7378\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Regularization grad_z = None\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-13  \expnd0\expndtw0 compute_grad\expnd-3\expndtw-13  \expnd0\expndtw0 and\expnd-3\expndtw-13  \expnd0\expndtw0 z.requires_grad: grad_z = torch.autograd.grad(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_hop, z, \expnd0\expndtw-2 create_graph=True, retain_graph=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-4\charscalex100 )[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_reg\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw0 self.regularization_energy(z,\expnd-2\expndtw-11  \expnd0\expndtw-2 grad_z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-15  \expnd0\expndtw0 Total\expnd-3\expndtw-15  \expnd0\expndtw-2 energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_total\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 E_hop\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-3  \expnd0\expndtw0 E_cons\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-3  \expnd0\expndtw-2 E_reg\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 components\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5925\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'hopfield': E_hop.item(), 'consistency':\expnd-3\expndtw-15  \expnd0\expndtw0 E_cons.item(), 'regularization':\expnd-3\expndtw-16  \expnd0\expndtw0 E_reg.item(), 'total': E_total.item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-7  \expnd0\expndtw0 E_total,\expnd-1\expndtw-7  \expnd0\expndtw-2 components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb182\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\fi-245\ri4483\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 def\expnd-3\expndtw-14  \expnd0\expndtw0 energy_gradient(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl-268\f2\fs22\b0\expnd0\expndtw0\charscalex100 Compute\expnd-1\expndtw-5  \f3\expnd0\expndtw0 \uc1\u8711 ?\f2 E\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 gradient-based\expnd-1\expndtw-5  \expnd0\expndtw-2 minimization.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\ri5009\sl276\slmult1\sb23\f2\fs22\b0\expnd0\expndtw0\charscalex100 Used\expnd-1\expndtw-7  \expnd0\expndtw0 in\expnd-1\expndtw-7  \expnd0\expndtw0 solver\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 find\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw0 minimum. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_with_grad\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw-2 z.detach().requires_grad_(True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\ri1831\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 energy,\expnd-2\expndtw-12  \expnd0\expndtw0 _\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw0 self.forward(z_with_grad,\expnd-2\expndtw-12  \expnd0\expndtw0 z_with_grad,\expnd-2\expndtw-12  \expnd0\expndtw0 memory_patterns) grad = torch.autograd.grad(energy, z_with_grad)[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-2\expndtw-8  \expnd-1\expndtw-4 grad\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb18\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-20\f2\fs2
{\field\fldlock
{\*\fldinst SHAPE  \\* MERGEFORMAT}
{\fldrslt 
{\shpgrp{\*\shpinst\shplid232
\shpleft0\shptop0\shpright367\shpbottom20\shpfhdr0
\shpbxcolumn\shpbxignore\shpbypara\shpbyignore\shpwr3\shpwrk0\shpfblwtxt1\shpz2
\shplockanchor
\shpwr3\shpwrk0\shpfblwtxt1{\sp{\sn groupLeft}{\sv 0}}
{\sp{\sn groupTop}{\sv 0}}
{\sp{\sn groupRight}{\sv 367}}
{\sp{\sn groupBottom}{\sv 20}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn lidRegroup}{\sv 0}}
{\sp{\sn posrelh}{\sv 3}}
{\sp{\sn posrelv}{\sv 3}}

{\shp{\*\shpinst\shplid233
{\sp{\sn relLeft}{\sv 0}}
{\sp{\sn relTop}{\sv 9}}
{\sp{\sn relRight}{\sv 367}}
{\sp{\sn relBottom}{\sv 10}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 1}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
{\pict
{\*\picprop\defshp\shplid232
{\sp{\sn shapeType}{\sv 75}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn fLayoutInCell}{\sv 1}}
{\sp{\sn fLockPosition}{\sv 1}}
{\sp{\sn fLockRotation}{\sv 1}}
}
\piccropl0\piccropr0\piccropt-20\piccropb20\picwgoal367\pichgoal20
\wmetafile8\bliptag-1003278350\blipupi72
}
}}
\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb159\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-8  \expnd0\expndtw0 **Step\expnd-1\expndtw-6  \expnd0\expndtw0 2.2:\expnd-1\expndtw-6  \expnd0\expndtw0 Unified\expnd-1\expndtw-6  \expnd0\expndtw0 Dynamics\expnd-1\expndtw-5  \expnd0\expndtw-2 (src/core/dynamics.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Define\expnd-2\expndtw-8  \expnd0\expndtw0 the\expnd-1\expndtw-6  \expnd0\expndtw0 dynamics\expnd-1\expndtw-6  \expnd0\expndtw0 function\expnd-1\expndtw-5  \expnd0\expndtw0 that\expnd-1\expndtw-6  \expnd0\expndtw0 drives\expnd-1\expndtw-6  \expnd0\expndtw0 both\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 state\expnd-1\expndtw-6  \expnd0\expndtw0 evolution\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-5  \expnd0\expndtw-2 updates:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Theoretical\expnd-3\expndtw-13  \expnd0\expndtw-2 design**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_\'7Bt+1\'7D\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 f(z_t,\expnd-1\expndtw-6  \expnd0\expndtw0 x,\expnd-1\expndtw-6  \expnd0\expndtw0 M)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba_update(z_t,\expnd-1\expndtw-6  \expnd0\expndtw0 x)\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield_update(z_t,\expnd-1\expndtw-5  M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 where:\par\pard\plain\s2\ls2\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba_update:\expnd-2\expndtw-9  \expnd0\expndtw0 State\expnd-1\expndtw-6  \expnd0\expndtw0 space\expnd-1\expndtw-6  \expnd0\expndtw0 evolution\expnd-1\expndtw-7  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-6  \expnd0\expndtw0 input\expnd-1\expndtw-6  \expnd0\expndtw-2 sequence\par\pard\plain\s2\ls2\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hopfield_update:\expnd-2\expndtw-11  \expnd0\expndtw0 Memory-driven\expnd-2\expndtw-10  \expnd0\expndtw0 correction\expnd-2\expndtw-10  \expnd0\expndtw0 toward\expnd-2\expndtw-10  \expnd0\expndtw0 stored\expnd-2\expndtw-10  \expnd0\expndtw-2 patterns\par\pard\plain\s2\ls2\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-2\expndtw-9  \expnd0\expndtw0 combination\expnd-1\expndtw-7  \expnd0\expndtw0 naturally\expnd-1\expndtw-7  \expnd0\expndtw0 minimizes\expnd-1\expndtw-7  \expnd0\expndtw0 the\expnd-1\expndtw-7  \expnd0\expndtw0 unified\expnd-1\expndtw-7  \expnd0\expndtw-2 energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Implementation**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6009\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 UnifiedDynamics(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Dynamics\expnd-1\expndtw-7  \expnd0\expndtw0 function\expnd-1\expndtw-7  \expnd0\expndtw0 f(z)\expnd-1\expndtw-7  \expnd0\expndtw0 that\expnd-1\expndtw-7  \expnd0\expndtw0 implements\expnd-1\expndtw-6  \expnd0\expndtw-2 both:\par\sect\sectd\sbkpage\pard\plain\s2\ls3\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb80\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 state\expnd-1\expndtw-6  \expnd0\expndtw0 space\expnd-1\expndtw-6  \expnd0\expndtw0 updates\expnd-1\expndtw-6  \expnd0\expndtw0 (temporal\expnd-1\expndtw-6  \expnd0\expndtw-2 processing)\par\pard\plain\s2\ls3\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hopfield\expnd-2\expndtw-10  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 updates\expnd-1\expndtw-7  \expnd0\expndtw0 (pattern\expnd-1\expndtw-7  \expnd0\expndtw-2 retrieval)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri2377\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Fixed\expnd-1\expndtw-5  \expnd0\expndtw0 points\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 this\expnd-1\expndtw-5  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 are\expnd-1\expndtw-5  \expnd0\expndtw0 equilibria\expnd-1\expndtw-5  \expnd0\expndtw0 that\expnd-1\expndtw-5  \expnd0\expndtw0 satisfy\expnd-1\expndtw-5  \expnd0\expndtw0 both\expnd-1\expndtw-5  \expnd0\expndtw0 objectives. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri6953\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 d_model, d_state, d_conv, num_heads=8, beta=1.0,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 gate_type='sigmoid'\expnd10\expndtw50  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 How\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 blend\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw-2 Hopfield\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 super().\f0\expnd13\expndtw64\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw64\charscalex100{\ul   \f2\expnd-1\expndtw-5}\f2\expnd-1\expndtw-5 ()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Mamba component for temporal processing self.mamba\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 MambaLayer(d_model,\expnd-2\expndtw-11  \expnd0\expndtw0 d_state,\expnd-2\expndtw-11  \expnd0\expndtw0 d_conv)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4406\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Projection for memory queries self.query_proj\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 nn.Linear(d_model,\expnd-3\expndtw-14  \expnd0\expndtw0 d_model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Gating\expnd-1\expndtw-6  \expnd0\expndtw0 mechanism\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 blend\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 updates self.gate = nn.Sequential(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 nn.Linear(d_model\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw-2 d_model),\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 nn.Sigmoid()\expnd-2\expndtw-9  \expnd0\expndtw0 if\expnd-1\expndtw-6  \expnd0\expndtw0 gate_type\expnd-1\expndtw-6  \expnd0\expndtw0 ==\expnd-1\expndtw-7  \expnd0\expndtw0 'sigmoid'\expnd-1\expndtw-6  \expnd0\expndtw0 else\expnd-1\expndtw-6  \expnd0\expndtw-2 nn.Tanh()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Output\expnd-1\expndtw-3  \expnd0\expndtw-2 projection\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.out_proj\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 nn.Linear(d_model,\expnd-2\expndtw-10  \expnd0\expndtw-2 d_model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.beta = beta self.d_model\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 d_model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 mamba_update(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 x_context): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba-based\expnd-2\expndtw-8  \expnd0\expndtw0 state\expnd-2\expndtw-8  \expnd0\expndtw-2 evolution.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z:\expnd-1\expndtw-5  \expnd0\expndtw0 Current\expnd-1\expndtw-4  \expnd0\expndtw0 state\expnd-1\expndtw-4  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 x_context:\expnd-2\expndtw-8  \expnd0\expndtw0 Input\expnd-1\expndtw-5  \expnd0\expndtw0 context\expnd-1\expndtw-6  \expnd0\expndtw0 from\expnd-1\expndtw-5  \expnd0\expndtw0 earlier\expnd-1\expndtw-6  \expnd0\expndtw0 layers\expnd-1\expndtw-5  \expnd0\expndtw0 (B,\expnd-1\expndtw-6  \expnd0\expndtw0 L,\expnd-1\expndtw-5  D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Updated\expnd-1\expndtw-5  \expnd0\expndtw0 state\expnd-1\expndtw-5  \expnd0\expndtw0 from\expnd-1\expndtw-5  \expnd0\expndtw0 SSM\expnd-1\expndtw-4  \expnd0\expndtw-2 dynamics\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Treat\expnd-1\expndtw-4  \expnd0\expndtw0 z\expnd-1\expndtw-4  \expnd0\expndtw0 as\expnd-1\expndtw-3  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 query\expnd-1\expndtw-4  \expnd0\expndtw0 into\expnd-1\expndtw-4  \expnd0\expndtw0 the\expnd-1\expndtw-3  \expnd0\expndtw-2 context\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Use\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba's\expnd-1\expndtw-7  \expnd0\expndtw0 selective\expnd-1\expndtw-7  \expnd0\expndtw0 mechanism\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 process return self.mamba(x_context, state=z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4507\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 hopfield_update(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hopfield-based\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 retrieval\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 state\expnd-1\expndtw-7  \expnd0\expndtw-2 update.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl273\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-2\expndtw-10  \expnd0\expndtw0 modern\expnd-2\expndtw-10  \expnd0\expndtw0 Hopfield\expnd-2\expndtw-10  \expnd0\expndtw0 update\expnd-2\expndtw-10  \expnd0\expndtw0 rule: z_new = \uc1\u931 ?\uc1\u7522 ? softmax(\uc1\u946 ?\f1 \uc1\u10216 ?\f2 z, m\uc1\u7522 ?\f1 \uc1\u10217 ?\f2 ) * m\uc1\u7522 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z:\expnd-1\expndtw-5  \expnd0\expndtw0 Current\expnd-1\expndtw-4  \expnd0\expndtw0 state\expnd-1\expndtw-4  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 memory_patterns:\expnd-2\expndtw-8  \expnd0\expndtw0 Stored\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-2\expndtw-8  \expnd0\expndtw0 (M,\expnd-1\expndtw-7  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Memory-retrieved\expnd3\expndtw16  \expnd0\expndtw-2 state\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb37\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Project\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-4  \expnd0\expndtw0 query\expnd-1\expndtw-3  \expnd0\expndtw-2 space\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 query\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 self.query_proj(z)\expnd10\expndtw52  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Compute\expnd-1\expndtw-6  \expnd0\expndtw0 attention\expnd-1\expndtw-6  \expnd0\expndtw0 over\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-6  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 (Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 retrieval) similarities = self.beta * torch.matmul(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 query,\expnd-2\expndtw-10  \expnd0\expndtw-2 memory_patterns.T\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 )\expnd12\expndtw59  \expnd0\expndtw0 #\expnd0\expndtw-2  \expnd0\expndtw0 (B,\expnd0\expndtw-1  \expnd-1\expndtw-5 M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3133\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention_weights\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 F.softmax(similarities,\expnd-2\expndtw-10  \expnd0\expndtw0 dim=-1)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-2\expndtw-10  \expnd0\expndtw0 (B,\expnd-2\expndtw-10  \expnd0\expndtw0 M) # Retrieve weighted combination of patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1939\sl552\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 retrieved\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 torch.matmul(attention_weights,\expnd-1\expndtw-7  \expnd0\expndtw0 memory_patterns)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (B,\expnd-1\expndtw-7  \expnd0\expndtw0 D) return retrieved\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri1594\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 forward(self,\expnd-2\expndtw-9  \expnd0\expndtw0 z,\expnd-2\expndtw-9  \expnd0\expndtw0 x_context,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns,\expnd-2\expndtw-9  \expnd0\expndtw0 return_components=False): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Unified\expnd-1\expndtw-6  \expnd0\expndtw0 dynamics:\expnd-1\expndtw-5  \expnd0\expndtw0 z_\'7Bt+1\'7D\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 f(z_t,\expnd-1\expndtw-5  \expnd0\expndtw0 x,\expnd-1\expndtw-5  M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1985\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 Combines\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 temporal\expnd-1\expndtw-7  \expnd0\expndtw0 processing\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 retrieval. \expnd0\expndtw-2 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 z:\expnd-1\expndtw-5  \expnd0\expndtw0 Current\expnd-1\expndtw-4  \expnd0\expndtw0 state\expnd-1\expndtw-4  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 x_context:\expnd-1\expndtw-7  \expnd0\expndtw0 Input\expnd-1\expndtw-7  \expnd0\expndtw0 sequence\expnd-1\expndtw-7  \expnd0\expndtw0 context\expnd-1\expndtw-7  \expnd0\expndtw0 (B,\expnd-1\expndtw-7  \expnd0\expndtw0 L,\expnd-1\expndtw-7  \expnd0\expndtw0 D) memory_patterns: Memory bank (M, D)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 return_components:\expnd-2\expndtw-11  \expnd0\expndtw0 Whether\expnd-2\expndtw-9  \expnd0\expndtw0 to\expnd-2\expndtw-9  \expnd0\expndtw0 return\expnd-2\expndtw-9  \expnd0\expndtw0 intermediate\expnd-2\expndtw-9  \expnd0\expndtw-2 values\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next:\expnd-1\expndtw-7  \expnd0\expndtw0 Updated\expnd-1\expndtw-7  \expnd0\expndtw-2 state\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 (optional)\expnd-1\expndtw-7  \expnd0\expndtw0 components:\expnd-1\expndtw-6  \expnd0\expndtw0 Dict\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw-2 contributions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw-2 updates\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2217\sl276\slmult1\sb38\tx5983\f2\fs22\b0\expnd0\expndtw0\charscalex100 mamba_update = self.mamba_update(z, x_context)\tab # (B, D) hopfield_update\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.hopfield_update(z,\expnd-1\expndtw-7  \expnd0\expndtw0 memory_patterns)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (B,\expnd-1\expndtw-7  \expnd0\expndtw0 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2558\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Adaptive gating: learn to blend based on current state gate_input\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.cat([mamba_update,\expnd-2\expndtw-11  \expnd0\expndtw0 hopfield_update],\expnd-2\expndtw-11  \expnd0\expndtw0 dim=-1) gate_values = self.gate(gate_input)\expnd8\expndtw40  \expnd0\expndtw0 # (B, D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Blend:\expnd-1\expndtw-3  \expnd0\expndtw0 z_next\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 gate\expnd-1\expndtw-3  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 mamba\expnd-1\expndtw-3  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 (1-gate)\expnd-1\expndtw-3  \expnd0\expndtw0 *\expnd-1\expndtw-3  \expnd0\expndtw-2 hopfield\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 gate_values\expnd-1\expndtw-5  \expnd0\expndtw0 *\expnd-1\expndtw-5  \expnd0\expndtw0 mamba_update\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-5  \expnd0\expndtw0 (1\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-5  \expnd0\expndtw0 gate_values)\expnd-1\expndtw-5  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw-2 hopfield_update\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Final\expnd-2\expndtw-9  \expnd0\expndtw0 projection\expnd-2\expndtw-9  \expnd0\expndtw0 (with\expnd-2\expndtw-9  \expnd0\expndtw0 residual\expnd-2\expndtw-9  \expnd0\expndtw0 connection) z_next = z + self.out_proj(z_next)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6841\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-16  \expnd0\expndtw0 return_components: components = \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri5875\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'mamba': mamba_update, 'hopfield':\expnd-3\expndtw-16  \expnd0\expndtw0 hopfield_update, 'gate': gate_values, 'blended': z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri5925\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-16  \expnd0\expndtw0 z_next,\expnd-3\expndtw-15  \expnd0\expndtw0 components return z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 is_contraction(self,\expnd-2\expndtw-9  \expnd0\expndtw0 z,\expnd-2\expndtw-9  \expnd0\expndtw0 x_context,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns,\expnd-2\expndtw-9  \expnd0\expndtw0 epsilon=1e-2): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Check\expnd-1\expndtw-6  \expnd0\expndtw0 if\expnd-1\expndtw-6  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw0 contractive\expnd-1\expndtw-6  \expnd0\expndtw0 (necessary\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw-2 convergence).\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Computes\expnd-1\expndtw-4  \expnd0\expndtw0 ||f(z\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 \uc1\u948 ?)\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 f(z)||\expnd-1\expndtw-4  \expnd0\expndtw0 /\expnd-1\expndtw-4  \expnd0\expndtw0 ||\uc1\u948 ?||\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw0 checks\expnd-1\expndtw-4  \expnd0\expndtw0 if\expnd-1\expndtw-4  \expnd0\expndtw0 <\expnd-1\expndtw-4  \expnd0\expndtw0 1. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6854\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd0\expndtw-1  \expnd0\expndtw0 torch.no_grad(): #\expnd-3\expndtw-13  \expnd0\expndtw0 Perturb\expnd-3\expndtw-13  \expnd0\expndtw0 z\expnd-3\expndtw-13  \expnd0\expndtw0 slightly\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 delta\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 epsilon\expnd-2\expndtw-10  \expnd0\expndtw0 *\expnd-2\expndtw-10  \expnd0\expndtw0 torch.randn_like(z) z_perturbed = z + delta\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 at\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw-2 points\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 f_z\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.forward(z,\expnd-1\expndtw-7  \expnd0\expndtw0 x_context,\expnd-1\expndtw-7  \expnd0\expndtw-2 memory_patterns)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 f_z_pert\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.forward(z_perturbed,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-6  \expnd0\expndtw0 constant\expnd-1\expndtw-6  \expnd0\expndtw-2 estimate\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4103\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 numerator\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.norm(f_z_pert\expnd-2\expndtw-9  \expnd0\expndtw0 -\expnd-2\expndtw-9  \expnd0\expndtw0 f_z,\expnd-2\expndtw-9  \expnd0\expndtw0 dim=-1) denominator = torch.norm(delta, dim=-1) lipschitz = (numerator / denominator).mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-7  \expnd0\expndtw0 lipschitz.item()\expnd-1\expndtw-7  \expnd0\expndtw0 <\expnd-1\expndtw-7  \expnd0\expndtw0 1.0,\expnd-1\expndtw-6  \expnd0\expndtw-2 lipschitz.item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par
{\shp{\*\shpinst
\shpleft1440\shptop478\shpright1807\shpbottom479
\shpfhdr0\shpwr3\shpwrk0\shplid363\shpz3
\shpbxpage\shpbypara\shpwr1{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn dxWrapDistLeft}{\sv 0}}{\sp{\sn dxWrapDistRight}{\sv 0}}{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
}}
\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb225\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-6  \expnd0\expndtw0 **Phase\expnd-1\expndtw-6  \expnd0\expndtw0 3:\expnd-1\expndtw-6  \expnd0\expndtw0 Unified\expnd-1\expndtw-6  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-6  \expnd0\expndtw-2 Solver**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-1\expndtw-6  \expnd0\expndtw0 **Step\expnd-1\expndtw-5  \expnd0\expndtw0 3.1:\expnd-1\expndtw-5  \expnd0\expndtw0 Hybrid\expnd-1\expndtw-5  \expnd0\expndtw0 Solver\expnd-1\expndtw-5  \expnd0\expndtw-2 (src/solvers/hybrid_solver.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Implement\expnd-1\expndtw-4  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 solver\expnd-1\expndtw-4  \expnd0\expndtw0 that\expnd-1\expndtw-4  \expnd0\expndtw0 finds\expnd-1\expndtw-4  \expnd0\expndtw0 equilibria\expnd-1\expndtw-4  \expnd0\expndtw0 satisfying\expnd-1\expndtw-4  \expnd0\expndtw0 BOTH\expnd-1\expndtw-4  \expnd0\expndtw0 the\expnd-1\expndtw-4  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-4  \expnd0\expndtw0 condition\expnd-1\expndtw-4  \expnd0\expndtw0 AND\expnd-1\expndtw-4  \expnd0\expndtw0 energy \expnd0\expndtw-2 minimization:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Convergence\expnd-3\expndtw-13  \expnd0\expndtw-2 criteria**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Stop\expnd-1\expndtw-4  \expnd0\expndtw-2 when:\par\pard\plain\s2\ls4\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri4995\sl276\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 ||z_t\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw0 f(z_t)||\expnd-1\expndtw-6  \expnd0\expndtw0 <\expnd-1\expndtw-6  \expnd0\expndtw0 \uc1\u949 ?_fixedpoint\expnd8\expndtw40  \expnd0\expndtw0 (DEQ\expnd-1\expndtw-6  \expnd0\expndtw0 criterion) \expnd-1\expndtw-4 AND\par\pard\plain\s2\ls4\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl-268\tx342\tx3198\f2\fs22\b0\expnd0\expndtw0\charscalex100 ||\f3 \uc1\u8711 ?\f2 E(z_t)||\expnd-1\expndtw-3  \expnd0\expndtw0 <\expnd-1\expndtw-3  \expnd0\expndtw-2 \uc1\u949 ?_energy\expnd0\expndtw0 \tab (Hopfield\expnd-2\expndtw-9  \expnd0\expndtw-2 criterion)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb23\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 AND\par\pard\plain\s2\ls4\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\tx3056\f2\fs22\b0\expnd0\expndtw0\charscalex100 E(z_t)\expnd-1\expndtw-5  \expnd0\expndtw0 has\expnd-1\expndtw-4  \expnd0\expndtw-2 stabilized\expnd0\expndtw0 \tab (Energy\expnd-1\expndtw-7  \expnd0\expndtw-2 plateau)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Implementation**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6436\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 UnifiedEquilibriumSolver: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Solver\expnd-1\expndtw-6  \expnd0\expndtw0 that\expnd-1\expndtw-6  \expnd0\expndtw0 finds\expnd-1\expndtw-6  \expnd0\expndtw0 joint\expnd-1\expndtw-6  \expnd0\expndtw0 equilibria\expnd-1\expndtw-6  \expnd0\expndtw-2 where:\par\pard\plain\s2\ls4\ilvl1\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 z*\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 f(z*,\expnd-1\expndtw-3  \expnd0\expndtw0 x,\expnd-1\expndtw-4  \expnd0\expndtw0 M)\expnd11\expndtw55  \expnd0\expndtw0 [fixed-point\expnd-1\expndtw-3  \expnd0\expndtw-2 condition]\par\pard\plain\s2\ls4\ilvl1\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb20\tx586\tx2163\f3\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u8711 ?\f2 E(z*)\expnd0\expndtw-1  \expnd0\expndtw0 = \expnd-2\expndtw-10 0\expnd0\expndtw0 \tab [energy\expnd-1\expndtw-7  \expnd0\expndtw0 minimum\expnd-1\expndtw-7  \expnd0\expndtw-2 condition]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb61\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-2\expndtw-8  \expnd0\expndtw0 hybrid\expnd-1\expndtw-7  \expnd0\expndtw0 optimization\expnd-1\expndtw-7  \expnd0\expndtw-2 combining:\par\pard\plain\s2\ls4\ilvl2\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Fixed-point\expnd-2\expndtw-10  \expnd0\expndtw0 iteration\expnd-2\expndtw-10  \expnd0\expndtw0 (Anderson\expnd-2\expndtw-9  \expnd0\expndtw-2 acceleration)\par\pard\plain\s2\ls4\ilvl2\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Gradient\expnd-1\expndtw-6  \expnd0\expndtw0 descent\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-5  \expnd0\expndtw-2 energy\par\pard\plain\s2\ls4\ilvl2\nooverflow\nocwrap\lnbrkrule\li344\ri6794\sl276\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Alternating\expnd-3\expndtw-16  \expnd0\expndtw0 optimization \expnd-1\expndtw-4 """\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri6494\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 dynamics_fn, energy_fn, max_iter=50, tol_fixedpoint=1e-3, tol_energy=1e-3,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri256\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 solver_type='alternating',\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-2\expndtw-9  \expnd0\expndtw0 'alternating',\expnd-2\expndtw-9  \expnd0\expndtw0 'simultaneous',\expnd-2\expndtw-9  \expnd0\expndtw0 'cascade' \expnd0\expndtw-2 anderson_memory=5,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 learning_rate=0.01\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5925\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.dynamics = dynamics_fn self.energy = energy_fn self.max_iter = max_iter self.tol_fp = tol_fixedpoint self.tol_energy = tol_energy self.solver_type\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 solver_type\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.m\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 anderson_memory\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 Anderson\expnd-1\expndtw-7  \expnd0\expndtw0 acceleration\expnd-1\expndtw-7  \expnd0\expndtw0 memory self.lr = learning_rate\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri1985\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 fixed_point_step(self,\expnd-2\expndtw-9  \expnd0\expndtw0 z,\expnd-2\expndtw-9  \expnd0\expndtw0 x_context,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns,\expnd-2\expndtw-9  \expnd0\expndtw0 history=None): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 One\expnd-2\expndtw-8  \expnd0\expndtw0 step\expnd-2\expndtw-8  \expnd0\expndtw0 of\expnd-2\expndtw-8  \expnd0\expndtw0 Anderson-accelerated\expnd-2\expndtw-8  \expnd0\expndtw0 fixed-point\expnd-2\expndtw-8  \expnd0\expndtw-2 iteration.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Standard\expnd-1\expndtw-7  \expnd0\expndtw0 fixed-point:\expnd-1\expndtw-6  \expnd0\expndtw0 z_new\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd-1\expndtw-4 f(z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Anderson:\expnd-1\expndtw-6  \expnd0\expndtw0 z_new\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 f(z)\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 correction\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-6  \expnd0\expndtw0 history \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  f(z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 f_z\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.dynamics(z,\expnd-2\expndtw-8  \expnd0\expndtw0 x_context,\expnd-1\expndtw-7  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5506\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-6  \expnd0\expndtw0 history\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-6  \expnd0\expndtw0 None\expnd-1\expndtw-6  \expnd0\expndtw0 or\expnd-1\expndtw-6  \expnd0\expndtw0 len(history)\expnd-1\expndtw-6  \expnd0\expndtw0 <\expnd-1\expndtw-6  \expnd0\expndtw0 2: # No acceleration yet\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-1\expndtw-5 f_z\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Anderson\expnd-1\expndtw-4  \expnd0\expndtw-2 acceleration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4836\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Collect residuals: r_i = f(z_i) - z_i residuals\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 [f_zi\expnd-1\expndtw-3  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 z_i\expnd-1\expndtw-3  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 z_i,\expnd-1\expndtw-3  \expnd0\expndtw0 f_zi\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw-2 history]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Build\expnd-1\expndtw-6  \expnd0\expndtw0 matrices\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 least-squares\expnd-1\expndtw-6  \expnd0\expndtw-2 problem\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 (simplified\expnd-1\expndtw-6  \expnd0\expndtw0 Anderson,\expnd-1\expndtw-6  \expnd0\expndtw0 full\expnd-1\expndtw-6  \expnd0\expndtw0 version\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-6  \expnd0\expndtw0 more\expnd-1\expndtw-6  \expnd0\expndtw0 complex) recent_residuals = residuals[-self.m:]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 R\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.stack(recent_residuals,\expnd-1\expndtw-6  \expnd0\expndtw0 dim=0)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 (m,\expnd-1\expndtw-6  \expnd0\expndtw0 B,\expnd-1\expndtw-6  \expnd0\expndtw0 D) # Solve least-squares for mixing coefficients\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 # This is the core of Anderson acceleration alpha\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self._solve_anderson_coefficients(R)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-13  \expnd0\expndtw0 Mix\expnd-3\expndtw-13  \expnd0\expndtw0 previous\expnd-3\expndtw-13  \expnd0\expndtw0 iterates z_accelerated = sum(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 a\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 f_z\expnd-1\expndtw-4  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 a,\expnd-1\expndtw-5  \expnd0\expndtw0 (_,\expnd-1\expndtw-4  \expnd0\expndtw0 f_z)\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw0 zip(alpha,\expnd-1\expndtw-4  \expnd0\expndtw0 history[-\expnd0\expndtw-2 self.m:])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 z_accelerated\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 energy_descent_step(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 One\expnd-1\expndtw-5  \expnd0\expndtw0 step\expnd-1\expndtw-4  \expnd0\expndtw0 of\expnd-1\expndtw-4  \expnd0\expndtw0 gradient\expnd-1\expndtw-5  \expnd0\expndtw0 descent\expnd-1\expndtw-4  \expnd0\expndtw0 on\expnd-1\expndtw-4  \expnd0\expndtw-2 energy.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb58\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6953\sl259\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_new\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 z\expnd-2\expndtw-9  \expnd0\expndtw0 -\expnd-2\expndtw-9  \expnd0\expndtw0 \uc1\u951 ?\f3 \uc1\u8711 ?\f2 E(z) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\sb17\f2\fs22\b0\expnd0\expndtw0\charscalex100 grad_E\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.energy.energy_gradient(z,\expnd-3\expndtw-15  \expnd0\expndtw0 memory_patterns) z_new = z - self.lr * grad_E\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 z_new\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2968\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 alternating_solve(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z_init,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Alternating\expnd-2\expndtw-11  \expnd0\expndtw-2 optimization:\par\pard\plain\s2\ls5\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Even\expnd-2\expndtw-9  \expnd0\expndtw0 iterations:\expnd-2\expndtw-9  \expnd0\expndtw0 Fixed-point\expnd-2\expndtw-8  \expnd-1\expndtw-4 step\par\pard\plain\s2\ls5\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Odd\expnd-1\expndtw-7  \expnd0\expndtw0 iterations:\expnd-1\expndtw-7  \expnd0\expndtw0 Energy\expnd-1\expndtw-7  \expnd0\expndtw0 descent\expnd-1\expndtw-6  \expnd-1\expndtw-4 step\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1408\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Provably\expnd-1\expndtw-5  \expnd0\expndtw0 converges\expnd-1\expndtw-5  \expnd0\expndtw0 if\expnd-1\expndtw-5  \expnd0\expndtw0 both\expnd-1\expndtw-5  \expnd0\expndtw0 objectives\expnd-1\expndtw-5  \expnd0\expndtw0 have\expnd-1\expndtw-5  \expnd0\expndtw0 unique\expnd-1\expndtw-5  \expnd0\expndtw0 minima\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd0\expndtw0 overlap\expnd-1\expndtw-5  \expnd0\expndtw0 region. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri7862\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z = z_init history\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 energy_history\expnd-2\expndtw-8  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd-1\expndtw-5 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5433\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 iter_num\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(self.max_iter): # Alternate between objectives\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-3  \expnd0\expndtw0 iter_num\expnd-1\expndtw-3  \expnd0\expndtw0 %\expnd-1\expndtw-3  \expnd0\expndtw0 2\expnd-1\expndtw-3  \expnd0\expndtw0 ==\expnd0\expndtw-2  \expnd-1\expndtw-5 0:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Fixed-point\expnd-1\expndtw-6  \expnd0\expndtw-2 iteration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi244\ri1594\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.fixed_point_step(z,\expnd-2\expndtw-9  \expnd0\expndtw0 x_context,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns,\expnd-2\expndtw-9  \expnd0\expndtw0 history) \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Energy\expnd-1\expndtw-3  \expnd0\expndtw-2 minimization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.energy_descent_step(z,\expnd-2\expndtw-11  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Compute\expnd-1\expndtw-6  \expnd0\expndtw0 convergence\expnd-1\expndtw-6  \expnd0\expndtw-2 metrics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fp_residual\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 torch.norm(z_next\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 self.dynamics(z,\expnd-1\expndtw-7  \expnd0\expndtw0 x_context,\expnd-1\expndtw-7  \expnd0\expndtw0 memory_patterns)) E_current, E_components = self.energy(z, z_next, memory_patterns)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 energy_grad\expnd2\expndtw12  \expnd0\expndtw-2 =\expnd2\expndtw12  \expnd0\expndtw-2 torch.norm(self.energy.energy_gradient(z,\expnd3\expndtw13  \expnd0\expndtw-2 memory_patterns))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Store\expnd-1\expndtw-3  \expnd0\expndtw-2 history\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri1159\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 history.append((z.detach(), z_next.detach())) energy_history.append(E_current.item())\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Check\expnd-1\expndtw-3  \expnd0\expndtw-2 convergence\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 converged_fp = fp_residual < self.tol_fp converged_energy\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 energy_grad\expnd-2\expndtw-11  \expnd0\expndtw0 <\expnd-2\expndtw-11  \expnd0\expndtw0 self.tol_energy energy_stable = (\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri5224\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 len(energy_history) > 5 and np.std(energy_history[-5:])\expnd-3\expndtw-16  \expnd0\expndtw0 <\expnd-3\expndtw-15  \expnd0\expndtw0 1e-4\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri2558\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-2\expndtw-9  \expnd0\expndtw0 converged_fp\expnd-2\expndtw-9  \expnd0\expndtw0 and\expnd-2\expndtw-9  \expnd0\expndtw0 converged_energy\expnd-2\expndtw-9  \expnd0\expndtw0 and\expnd-2\expndtw-9  \expnd0\expndtw0 energy_stable: return z_next, \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri5506\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'converged': True, 'iterations':\expnd-3\expndtw-14  \expnd0\expndtw0 iter_num\expnd-3\expndtw-14  \expnd0\expndtw0 +\expnd-3\expndtw-14  \expnd0\expndtw0 1,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri4347\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'final_fp_residual': fp_residual.item(), 'final_energy_grad':\expnd-3\expndtw-16  \expnd0\expndtw0 energy_grad.item(), 'final_energy': E_current.item(), 'energy_components': E_components, 'energy_history': energy_history\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd0\expndtw-1  \expnd0\expndtw0 =\expnd0\expndtw-1  \expnd0\expndtw-2 z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-13  \expnd0\expndtw0 Max\expnd-3\expndtw-13  \expnd0\expndtw0 iterations\expnd-3\expndtw-13  \expnd0\expndtw0 reached return z, \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'converged': False, \expnd0\expndtw-2 'iterations': self.max_iter,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4836\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'final_fp_residual': fp_residual.item(), 'final_energy_grad':\expnd-3\expndtw-16  \expnd0\expndtw0 energy_grad.item(), 'final_energy': E_current.item(), 'energy_components': E_components, 'energy_history': energy_history\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2750\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 simultaneous_solve(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z_init,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl535\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Simultaneous\expnd-2\expndtw-10  \expnd0\expndtw0 optimization\expnd-2\expndtw-10  \expnd0\expndtw0 of\expnd-2\expndtw-10  \expnd0\expndtw0 both\expnd-2\expndtw-10  \expnd0\expndtw0 objectives. Minimizes: \uc1\u955 ?\f3 \uc1\u8321 ?\f2 ||z - f(z)||\'B2 + \uc1\u955 ?\f3 \uc1\u8322 ?\f2 E(z)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4103\sl259\slmult1\sb62\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-2\expndtw-9  \expnd0\expndtw0 combined\expnd-2\expndtw-9  \expnd0\expndtw0 gradient:\expnd-2\expndtw-9  \f3\expnd0\expndtw0 \uc1\u8711 ?\f2 [combined\expnd-2\expndtw-9  \expnd0\expndtw0 objective] \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\sb17\f2\fs22\b0\expnd0\expndtw0\charscalex100 z = z_init.clone().requires_grad_(True) optimizer\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 torch.optim.Adam([z],\expnd-3\expndtw-14  \expnd0\expndtw0 lr=self.lr)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 history\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd-1\expndtw-5 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 iter_num\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(self.max_iter): \expnd0\expndtw-2 optimizer.zero_grad()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw-2 objectives\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.dynamics(z,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_patterns) fp_loss = torch.sum((z - z_next) ** 2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri1939\sl-582\sb32\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_current,\expnd-2\expndtw-9  \expnd0\expndtw0 E_components\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.energy(z,\expnd-2\expndtw-9  \expnd0\expndtw0 z_next,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns) # Combined loss\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl-221\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_loss\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 fp_loss\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw-2 E_current\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5433\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 total_loss.backward() optimizer.step()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Check\expnd-3\expndtw-15  \expnd0\expndtw0 convergence with torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 fp_residual\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.norm(z\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw-2 z_next)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 energy_grad\expnd2\expndtw12  \expnd0\expndtw-2 =\expnd2\expndtw12  \expnd0\expndtw-2 torch.norm(self.energy.energy_gradient(z,\expnd3\expndtw13  \expnd0\expndtw-2 memory_patterns))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri2377\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-6  \expnd0\expndtw0 fp_residual\expnd-1\expndtw-6  \expnd0\expndtw0 <\expnd-1\expndtw-6  \expnd0\expndtw0 self.tol_fp\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 energy_grad\expnd-1\expndtw-6  \expnd0\expndtw0 <\expnd-1\expndtw-6  \expnd0\expndtw0 self.tol_energy: return z.detach(), \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'converged': True, 'iterations':\expnd-3\expndtw-13  \expnd0\expndtw0 iter_num\expnd-3\expndtw-13  \expnd0\expndtw0 +\expnd-3\expndtw-13  \expnd0\expndtw0 1,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'final_fp_residual': fp_residual.item(), 'final_energy_grad':\expnd-3\expndtw-16  \expnd0\expndtw0 energy_grad.item(), 'final_energy': E_current.item(), 'energy_components': E_components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri5433\sl580\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 history.append(E_current.item()) \expnd0\expndtw0 return z.detach(), \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5925\sl276\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 'converged': False, \expnd0\expndtw-2 'iterations': self.max_iter, \expnd0\expndtw0 'energy_history': history\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3174\sl276\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 cascade_solve(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z_init,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Cascade\expnd-1\expndtw-7  \expnd0\expndtw-2 approach:\par\pard\plain\s2\ls6\ilvl0\nooverflow\nocwrap\lnbrkrule\li830\fi-242\sl240\slmult1\sb38\tx830\f2\fs22\b0\expnd0\expndtw0\charscalex100 First\expnd-2\expndtw-8  \expnd0\expndtw0 converge\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 fixed\expnd-1\expndtw-6  \expnd0\expndtw0 point\expnd-1\expndtw-5  \expnd0\expndtw0 (fast,\expnd-1\expndtw-6  \expnd0\expndtw0 ignoring\expnd-1\expndtw-5  \expnd0\expndtw-2 energy)\par\pard\plain\s2\ls6\ilvl0\nooverflow\nocwrap\lnbrkrule\li830\fi-242\sl240\slmult1\sb38\tx830\f2\fs22\b0\expnd0\expndtw0\charscalex100 Then\expnd-2\expndtw-10  \expnd0\expndtw0 refine\expnd-2\expndtw-8  \expnd0\expndtw0 via\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw0 minimization\expnd-1\expndtw-7  \expnd0\expndtw0 (slow,\expnd-2\expndtw-8  \expnd0\expndtw0 high\expnd-1\expndtw-7  \expnd0\expndtw-2 quality)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3649\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Good\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 when\expnd-1\expndtw-6  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-6  \expnd0\expndtw0 close\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 minimum. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5029\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Phase\expnd-2\expndtw-9  \expnd0\expndtw0 1:\expnd-2\expndtw-9  \expnd0\expndtw0 Fast\expnd-2\expndtw-9  \expnd0\expndtw0 fixed-point\expnd-2\expndtw-9  \expnd0\expndtw0 convergence z = z_init\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-2\expndtw-8  \expnd0\expndtw0 _\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-6  \expnd0\expndtw0 range(self.max_iter\expnd-1\expndtw-5  \expnd0\expndtw0 //\expnd-1\expndtw-5  2):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.dynamics(z,\expnd-1\expndtw-7  \expnd0\expndtw0 x_context,\expnd-1\expndtw-7  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri1159\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-7  \expnd0\expndtw0 torch.norm(z\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 self.dynamics(z,\expnd-1\expndtw-7  \expnd0\expndtw0 x_context,\expnd-1\expndtw-7  \expnd0\expndtw0 memory_patterns))\expnd-1\expndtw-7  \expnd0\expndtw0 <\expnd-1\expndtw-7  \expnd0\expndtw0 self.tol_fp: \expnd0\expndtw-2 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6058\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Phase\expnd-2\expndtw-10  \expnd0\expndtw0 2:\expnd-2\expndtw-10  \expnd0\expndtw0 Energy\expnd-2\expndtw-10  \expnd0\expndtw0 refinement z = z.requires_grad_(True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 optimizer\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 torch.optim.LBFGS([z],\expnd-2\expndtw-10  \expnd0\expndtw0 lr=0.1,\expnd-2\expndtw-9  \expnd0\expndtw-2 max_iter=20)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def closure(): \expnd0\expndtw-2 optimizer.zero_grad()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.dynamics(z,\expnd-2\expndtw-11  \expnd0\expndtw0 x_context,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_patterns) E, _ = self.energy(z, z_next, memory_patterns) \expnd0\expndtw-2 E.backward()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-2\expndtw-10 E\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6749\sl580\sb2\f2\fs22\b0\expnd0\expndtw-2\charscalex100 optimizer.step(closure) \expnd0\expndtw0 # Final evaluation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-8  \expnd0\expndtw0 self.dynamics(z,\expnd-2\expndtw-8  \expnd0\expndtw0 x_context,\expnd-2\expndtw-8  \expnd0\expndtw-2 memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri1939\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_final,\expnd-2\expndtw-9  \expnd0\expndtw0 E_components\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.energy(z,\expnd-2\expndtw-9  \expnd0\expndtw0 z_next,\expnd-2\expndtw-9  \expnd0\expndtw0 memory_patterns) fp_residual = torch.norm(z - z_next)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 energy_grad\expnd2\expndtw12  \expnd0\expndtw-2 =\expnd2\expndtw12  \expnd0\expndtw-2 torch.norm(self.energy.energy_gradient(z,\expnd3\expndtw13  \expnd0\expndtw-2 memory_patterns))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6547\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return z.detach(), \'7B \expnd0\expndtw-2 'converged':\expnd-3\expndtw-13  \expnd0\expndtw-2 True,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4836\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'final_fp_residual': fp_residual.item(), 'final_energy_grad':\expnd-3\expndtw-16  \expnd0\expndtw0 energy_grad.item(), 'final_energy': E_final.item(), 'energy_components': E_components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4103\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-10  \expnd0\expndtw0 solve(self,\expnd-2\expndtw-10  \expnd0\expndtw0 z_init,\expnd-2\expndtw-10  \expnd0\expndtw0 x_context,\expnd-2\expndtw-10  \expnd0\expndtw0 memory_patterns): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3920\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Main\expnd-2\expndtw-9  \expnd0\expndtw0 entry\expnd-2\expndtw-9  \expnd0\expndtw0 point.\expnd-2\expndtw-9  \expnd0\expndtw0 Dispatches\expnd-2\expndtw-9  \expnd0\expndtw0 to\expnd-2\expndtw-9  \expnd0\expndtw0 appropriate\expnd-2\expndtw-9  \expnd0\expndtw0 solver. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-7  \expnd0\expndtw0 self.solver_type\expnd-1\expndtw-7  \expnd0\expndtw0 ==\expnd-1\expndtw-6  \expnd0\expndtw-2 'alternating':\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri2377\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-14  \expnd0\expndtw0 self.alternating_solve(z_init,\expnd-3\expndtw-14  \expnd0\expndtw0 x_context,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns) elif self.solver_type == 'simultaneous':\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri2014\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-14  \expnd0\expndtw0 self.simultaneous_solve(z_init,\expnd-3\expndtw-14  \expnd0\expndtw0 x_context,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns) elif self.solver_type == 'cascade':\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri2627\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-14  \expnd0\expndtw0 self.cascade_solve(z_init,\expnd-3\expndtw-14  \expnd0\expndtw0 x_context,\expnd-3\expndtw-14  \expnd0\expndtw0 memory_patterns) \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 raise\expnd-3\expndtw-13  \expnd0\expndtw0 ValueError(f"Unknown\expnd-3\expndtw-13  \expnd0\expndtw0 solver\expnd-3\expndtw-13  \expnd0\expndtw0 type:\expnd-3\expndtw-13  \expnd0\expndtw-2 \'7Bself.solver_type\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 _solve_anderson_coefficients(self,\expnd-3\expndtw-15  \expnd0\expndtw0 R): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Solve\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 Anderson\expnd-1\expndtw-6  \expnd0\expndtw0 mixing\expnd-1\expndtw-5  \expnd0\expndtw-2 coefficients.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3920\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 Simplified\expnd-1\expndtw-6  \expnd0\expndtw0 version\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw0 full\expnd-1\expndtw-6  \expnd0\expndtw0 Anderson\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-6  \expnd0\expndtw0 more\expnd-1\expndtw-6  \expnd0\expndtw0 involved. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6620\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 R:\expnd-2\expndtw-8  \expnd0\expndtw0 (m,\expnd-2\expndtw-8  \expnd0\expndtw0 B,\expnd-2\expndtw-8  \expnd0\expndtw0 D)\expnd-2\expndtw-8  \expnd0\expndtw0 residuals m = R.shape[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Gram matrix: G_ij = <r_i, r_j> R_flat\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 R.view(m,\expnd-1\expndtw-6  \expnd0\expndtw0 -1)\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 (m,\expnd-1\expndtw-6  \expnd0\expndtw0 B*D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 G\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 torch.matmul(R_flat,\expnd-1\expndtw-5  \expnd0\expndtw0 R_flat.T)\expnd10\expndtw52  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 (m,\expnd-1\expndtw-5  m)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Solve\expnd-1\expndtw-3  \expnd0\expndtw0 G\expnd-1\expndtw-3  \expnd0\expndtw0 \uc1\u945 ?\expnd0\expndtw-2  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 1\expnd-1\expndtw-3  \expnd0\expndtw0 with\expnd0\expndtw-2  \expnd0\expndtw0 constraint\expnd-1\expndtw-3  \expnd0\expndtw0 \uc1\u931 ?\uc1\u945 ?\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  \expnd-2\expndtw-10 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 (Simplified\expnd-2\expndtw-8  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 should\expnd-2\expndtw-8  \expnd0\expndtw0 use\expnd-1\expndtw-7  \expnd0\expndtw0 constrained\expnd-2\expndtw-8  \expnd0\expndtw0 optimization) ones = torch.ones(m, device=R.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1578\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 alpha\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.linalg.solve(G\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 1e-6\expnd-1\expndtw-6  \expnd0\expndtw0 *\expnd-1\expndtw-6  \expnd0\expndtw0 torch.eye(m,\expnd-1\expndtw-6  \expnd0\expndtw0 device=G.device),\expnd-1\expndtw-6  \expnd0\expndtw0 ones) alpha = alpha / alpha.sum()\expnd8\expndtw40  \expnd0\expndtw0 # Normalize\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 alpha\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par
{\shp{\*\shpinst
\shpleft1440\shptop478\shpright1807\shpbottom479
\shpfhdr0\shpwr3\shpwrk0\shplid559\shpz4
\shpbxpage\shpbypara\shpwr1{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn dxWrapDistLeft}{\sv 0}}{\sp{\sn dxWrapDistRight}{\sv 0}}{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
}}
\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb224\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-7  \expnd0\expndtw0 **Phase\expnd-1\expndtw-5  \expnd0\expndtw0 4:\expnd-1\expndtw-4  \expnd0\expndtw0 Full\expnd-1\expndtw-5  \expnd0\expndtw0 Unified\expnd-1\expndtw-4  \expnd0\expndtw-2 Model**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-9  \expnd0\expndtw0 **Step\expnd-1\expndtw-7  \expnd0\expndtw0 4.1:\expnd-1\expndtw-7  \expnd0\expndtw0 Complete\expnd-1\expndtw-7  \expnd0\expndtw0 Architecture\expnd-1\expndtw-6  \expnd0\expndtw-2 (src/models/unified.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4957\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 UnifiedMambaHopfieldDEQ(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Fully\expnd-2\expndtw-8  \expnd0\expndtw0 unified\expnd-2\expndtw-8  \expnd0\expndtw0 architecture\expnd-2\expndtw-8  \expnd0\expndtw-2 where:\par\sect\sectd\sbkpage\pard\plain\s2\ls7\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb80\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba\expnd-2\expndtw-8  \expnd0\expndtw0 handles\expnd-1\expndtw-7  \expnd0\expndtw0 sequential\expnd-1\expndtw-7  \expnd0\expndtw-2 processing\par\pard\plain\s2\ls7\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 provides\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-6  \expnd0\expndtw0 via\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw-2 minimization\par\pard\plain\s2\ls7\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 DEQ\expnd-1\expndtw-6  \expnd0\expndtw0 finds\expnd-1\expndtw-5  \expnd0\expndtw0 equilibria\expnd-1\expndtw-6  \expnd0\expndtw0 that\expnd-1\expndtw-5  \expnd0\expndtw0 satisfy\expnd-1\expndtw-6  \expnd0\expndtw0 both\expnd-1\expndtw-5  \expnd0\expndtw-2 constraints\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-6  \expnd0\expndtw0 model\expnd-1\expndtw-5  \expnd0\expndtw0 operates\expnd-1\expndtw-5  by:\par\pard\plain\s2\ls8\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Processing\expnd-1\expndtw-7  \expnd0\expndtw0 input\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 layers\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 get\expnd-1\expndtw-5  \expnd0\expndtw-2 context\par\pard\plain\s2\ls8\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb21\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Initializing\expnd-2\expndtw-12  \expnd0\expndtw0 equilibrium\expnd-2\expndtw-9  \expnd0\expndtw0 state\expnd-2\expndtw-9  \expnd-1\expndtw-5 z\f3 \uc1\u8320 ?\par\pard\plain\s2\ls8\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb22\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Iterating\expnd-2\expndtw-10  \expnd0\expndtw0 unified\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics\expnd-1\expndtw-7  \expnd0\expndtw0 until\expnd-1\expndtw-7  \expnd0\expndtw-2 convergence:\par\pard\plain\s2\ls8\ilvl1\nooverflow\nocwrap\lnbrkrule\li660\fi-133\sl240\slmult1\sb38\tx660\f2\fs22\b0\expnd0\expndtw0\charscalex100 z*\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 f(z*,\expnd-1\expndtw-3  \expnd0\expndtw0 x,\expnd-1\expndtw-3  \expnd0\expndtw0 M)\expnd-1\expndtw-3  \expnd0\expndtw0 [fixed\expnd-1\expndtw-3  \expnd0\expndtw-2 point]\par\pard\plain\s2\ls8\ilvl1\nooverflow\nocwrap\lnbrkrule\li660\fi-133\sl240\slmult1\sb20\tx660\tx2175\f3\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u8711 ?\f2 E(z*)\expnd0\expndtw-1  \expnd0\expndtw0 = \expnd-2\expndtw-10 0\expnd0\expndtw0 \tab [energy\expnd-1\expndtw-7  \expnd0\expndtw-2 minimum]\par\pard\plain\s2\ls8\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri6867\sl276\slmult1\sb23\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Decoding\expnd-3\expndtw-13  \expnd0\expndtw0 z*\expnd-3\expndtw-13  \expnd0\expndtw0 to\expnd-3\expndtw-13  \expnd0\expndtw0 output \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri6311\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 vocab_size, d_model=512, d_state=64, d_conv=4, n_layers=6, memory_size=10000, beta=2.0,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri5995\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 solver_type='alternating', max_iterations=30, tol=1e-3\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 super().\f0\expnd13\expndtw64\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw64\charscalex100{\ul   \f2\expnd-1\expndtw-5}\f2\expnd-1\expndtw-5 ()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.d_model = d_model self.memory_size\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 memory_size\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Input\expnd-1\expndtw-3  \expnd0\expndtw-2 embedding\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.embedding\expnd-3\expndtw-13  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 nn.Embedding(vocab_size,\expnd-3\expndtw-13  \expnd0\expndtw-2 d_model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-2  \expnd0\expndtw0 Mamba\expnd0\expndtw-2  \expnd0\expndtw0 layers\expnd0\expndtw-2  \expnd0\expndtw0 for\expnd0\expndtw-2  \expnd0\expndtw0 initial\expnd0\expndtw-2  \expnd0\expndtw0 processing self.mamba_layers\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw-2 nn.ModuleList([\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4572\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 MambaLayer(d_model,\expnd-3\expndtw-16  \expnd0\expndtw0 d_state,\expnd-3\expndtw-15  \expnd0\expndtw0 d_conv) for _ in range(n_layers)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Unified\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics\expnd-1\expndtw-7  \expnd0\expndtw0 (combines\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield) self.dynamics = UnifiedDynamics(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 d_model=d_model, d_state=d_state, d_conv=d_conv,\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 beta=beta\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Energy\expnd-1\expndtw-3  \expnd0\expndtw-2 function\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.energy_fn\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedEnergyFunction( \expnd0\expndtw-2 d_model=d_model,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 beta=beta\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb37\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-6  \expnd0\expndtw-2 solver\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.solver\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedEquilibriumSolver( \expnd0\expndtw-2 dynamics_fn=self.dynamics, energy_fn=self.energy_fn, max_iter=max_iterations, tol_fixedpoint=tol,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 tol_energy=tol, solver_type=solver_type\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Memory\expnd-2\expndtw-10  \expnd0\expndtw0 bank\expnd-2\expndtw-10  \expnd0\expndtw0 (learnable\expnd-2\expndtw-10  \expnd0\expndtw0 initialization) \expnd0\expndtw-2 self.register_buffer(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'memory_patterns',\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 torch.randn(memory_size,\expnd-2\expndtw-11  \expnd0\expndtw0 d_model)\expnd-2\expndtw-11  \expnd0\expndtw0 /\expnd-2\expndtw-11  \expnd0\expndtw-2 np.sqrt(d_model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.memory_write_gate\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 nn.Linear(d_model,\expnd-3\expndtw-13  \expnd-1\expndtw-5 1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5634\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Output projection self.output_proj\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 nn.Sequential(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5593\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 nn.LayerNorm(d_model), \expnd0\expndtw0 nn.Linear(d_model,\expnd-3\expndtw-16  \expnd0\expndtw0 vocab_size)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 For\expnd-2\expndtw-9  \expnd0\expndtw0 tracking\expnd-2\expndtw-9  \expnd0\expndtw0 convergence\expnd-2\expndtw-9  \expnd0\expndtw0 during\expnd-2\expndtw-9  \expnd0\expndtw0 training self.convergence_stats = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5634\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 process_context(self,\expnd-3\expndtw-15  \expnd0\expndtw0 input_ids): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Pass\expnd-1\expndtw-7  \expnd0\expndtw0 input\expnd-1\expndtw-5  \expnd0\expndtw0 through\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 layers\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 get\expnd-1\expndtw-5  \expnd0\expndtw0 context\expnd-1\expndtw-4  \expnd0\expndtw-2 representation.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids:\expnd-1\expndtw-5  \expnd0\expndtw0 (B,\expnd-1\expndtw-5  \expnd0\expndtw0 L)\expnd-1\expndtw-5  \expnd0\expndtw0 token\expnd-1\expndtw-5  \expnd0\expndtw-2 indices\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context:\expnd-1\expndtw-5  \expnd0\expndtw0 (B,\expnd-1\expndtw-5  \expnd0\expndtw0 L,\expnd-1\expndtw-5  \expnd0\expndtw0 D)\expnd-1\expndtw-5  \expnd0\expndtw0 processed\expnd-1\expndtw-4  \expnd0\expndtw-2 context\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 final_state:\expnd-1\expndtw-6  \expnd0\expndtw0 (B,\expnd-1\expndtw-6  \expnd0\expndtw0 D)\expnd-1\expndtw-6  \expnd0\expndtw0 state\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-6  \expnd0\expndtw-2 initialization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Embed\expnd-1\expndtw-3  \expnd0\expndtw-2 tokens\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 x\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 self.embedding(input_ids)\expnd10\expndtw52  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 (B,\expnd-1\expndtw-5  \expnd0\expndtw0 L,\expnd-1\expndtw-4  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5634\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Process\expnd-2\expndtw-10  \expnd0\expndtw0 through\expnd-2\expndtw-10  \expnd0\expndtw0 Mamba\expnd-2\expndtw-10  \expnd0\expndtw0 layers for layer in self.mamba_layers:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 x\expnd0\expndtw-1  \expnd0\expndtw0 =\expnd0\expndtw-1  \expnd0\expndtw-2 layer(x)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Extract final state (use last token or pooling) final_state\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 x[:,\expnd-1\expndtw-4  \expnd0\expndtw0 -1,\expnd-1\expndtw-4  \expnd0\expndtw0 :]\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-4  \expnd0\expndtw0 (B,\expnd-1\expndtw-4  \expnd0\expndtw0 D)\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 using\expnd-1\expndtw-4  \expnd0\expndtw0 last\expnd-1\expndtw-4  \expnd0\expndtw0 position\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-4  \expnd0\expndtw0 x,\expnd-1\expndtw-4  \expnd0\expndtw-2 final_state\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3174\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 update_memory(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z_equilibrium,\expnd-3\expndtw-14  \expnd0\expndtw0 should_store=None): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Dynamically\expnd-2\expndtw-9  \expnd0\expndtw0 update\expnd-1\expndtw-7  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-7  \expnd0\expndtw0 on\expnd-1\expndtw-7  \expnd0\expndtw0 converged\expnd-1\expndtw-6  \expnd0\expndtw-2 states.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_equilibrium:\expnd-2\expndtw-8  \expnd0\expndtw0 (B,\expnd-1\expndtw-7  \expnd0\expndtw0 D)\expnd-2\expndtw-8  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-7  \expnd0\expndtw-2 states\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 should_store:\expnd-2\expndtw-8  \expnd0\expndtw0 (B,)\expnd-1\expndtw-6  \expnd0\expndtw0 boolean\expnd-1\expndtw-5  \expnd0\expndtw0 mask\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 which\expnd-1\expndtw-5  \expnd0\expndtw0 samples\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw-2 store\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2892\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-1\expndtw-6  \expnd0\expndtw0 a\expnd-1\expndtw-6  \expnd0\expndtw0 queue-based\expnd-1\expndtw-6  \expnd0\expndtw0 approach:\expnd-1\expndtw-6  \expnd0\expndtw0 oldest\expnd-1\expndtw-6  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw0 replaced. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-6  \expnd0\expndtw0 should_store\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw-2 None:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3133\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Decide\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-6  \expnd0\expndtw0 novelty\expnd-1\expndtw-6  \expnd0\expndtw0 (distance\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 existing\expnd-1\expndtw-6  \expnd0\expndtw0 patterns) with torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri4505\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 similarities = torch.matmul( z_equilibrium,\expnd-3\expndtw-16  \expnd0\expndtw0 self.memory_patterns.T\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 )\expnd12\expndtw59  \expnd0\expndtw0 #\expnd0\expndtw-2  \expnd0\expndtw0 (B,\expnd0\expndtw-1  \expnd-1\expndtw-5 M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_similarity\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 similarities.max(dim=-1)[0]\expnd9\expndtw44  \expnd0\expndtw0 #\expnd-2\expndtw-8  \expnd-1\expndtw-4 (B,)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3818\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Store\expnd-2\expndtw-8  \expnd0\expndtw0 if\expnd-2\expndtw-8  \expnd0\expndtw0 sufficiently\expnd-2\expndtw-8  \expnd0\expndtw0 novel\expnd-2\expndtw-8  \expnd0\expndtw0 (low\expnd-2\expndtw-8  \expnd0\expndtw0 similarity) should_store = max_similarity < 0.7\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw360\colsr128\colno2\colw9072\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb245\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 #\expnd-1\expndtw-5  \expnd0\expndtw0 Store\expnd-1\expndtw-5  \expnd0\expndtw0 selected\expnd-1\expndtw-4  \expnd0\expndtw-2 patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4810\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 num_to_store\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 should_store.sum().item() if num_to_store > 0:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 patterns_to_store\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd-1\expndtw-5 z_\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 equilibrium[should_store]\expnd9\expndtw46  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (N,\expnd-1\expndtw-7  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Queue-based\expnd-1\expndtw-7  \expnd0\expndtw0 storage:\expnd-1\expndtw-6  \expnd0\expndtw0 replace\expnd-1\expndtw-7  \expnd0\expndtw0 oldest\expnd-1\expndtw-6  \expnd0\expndtw-2 entries\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4280\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Shift\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 add\expnd-1\expndtw-5  \expnd0\expndtw0 new\expnd-1\expndtw-5  \expnd0\expndtw0 patterns\expnd-1\expndtw-5  \expnd0\expndtw0 at\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 end num_existing = self.memory_patterns.shape[0] if num_to_store < num_existing:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.memory_patterns = torch.cat([ \expnd0\expndtw-2 self.memory_patterns[num_to_store:], patterns_to_store\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri7862\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ],\expnd-3\expndtw-16  \expnd0\expndtw0 dim=0) \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Replace all memory if too many new patterns self.memory_patterns\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 patterns_to_store[:num_existing]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri1939\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-13  \expnd0\expndtw0 forward(self,\expnd-3\expndtw-13  \expnd0\expndtw0 input_ids,\expnd-3\expndtw-13  \expnd0\expndtw0 update_memory=True,\expnd-3\expndtw-13  \expnd0\expndtw0 return_diagnostics=False): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Full\expnd-1\expndtw-6  \expnd0\expndtw0 forward\expnd-1\expndtw-6  \expnd0\expndtw0 pass\expnd-1\expndtw-6  \expnd0\expndtw0 through\expnd-1\expndtw-6  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw-2 architecture.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Process:\par\pard\plain\s2\ls9\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb37\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Embed\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 process\expnd-1\expndtw-5  \expnd0\expndtw0 input\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw-2 Mamba\par\pard\plain\s2\ls9\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb21\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Initialize\expnd-2\expndtw-9  \expnd0\expndtw0 equilibrium\expnd-2\expndtw-9  \expnd0\expndtw0 state\expnd-2\expndtw-8  \expnd-1\expndtw-5 z\f3 \uc1\u8320 ?\par\pard\plain\s2\ls9\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb5\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Solve\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 equilibrium:\expnd-1\expndtw-3  \expnd0\expndtw0 find\expnd-1\expndtw-4  \expnd0\expndtw0 z*\expnd-1\expndtw-3  \expnd0\expndtw0 where\expnd-1\expndtw-4  \expnd0\expndtw0 z*\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 f(z*)\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-3  \f3\expnd0\expndtw0 \uc1\u8711 ?\f2 E(z*)\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-2\expndtw-10 0\par\pard\plain\s2\ls9\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb22\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Optionally\expnd-1\expndtw-7  \expnd0\expndtw0 update\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-6  \expnd-1\expndtw-5 z*\par\pard\plain\s2\ls9\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Decode\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 output\expnd-1\expndtw-4  \expnd0\expndtw-2 logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids: (B, L) input token sequences update_memory:\expnd-1\expndtw-7  \expnd0\expndtw0 Whether\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 add\expnd-1\expndtw-7  \expnd0\expndtw0 z*\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 memory return_diagnostics: Return convergence info\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Returns:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits: (B, L, vocab_size) output predictions diagnostics:\expnd-2\expndtw-9  \expnd0\expndtw0 (optional)\expnd-2\expndtw-9  \expnd0\expndtw0 convergence\expnd-2\expndtw-9  \expnd0\expndtw0 and\expnd-2\expndtw-9  \expnd0\expndtw0 energy\expnd-2\expndtw-9  \expnd0\expndtw0 info\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 batch_size,\expnd-1\expndtw-7  \expnd0\expndtw0 seq_len\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw-2 input_ids.shape\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Phase\expnd-1\expndtw-4  \expnd0\expndtw0 1:\expnd-1\expndtw-4  \expnd0\expndtw0 Context\expnd-1\expndtw-3  \expnd0\expndtw-2 processing\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context,\expnd-2\expndtw-8  \expnd0\expndtw0 z_init\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 self.process_context(input_ids)\expnd10\expndtw50  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 (B,\expnd-1\expndtw-6  \expnd0\expndtw0 L,\expnd-1\expndtw-6  \expnd0\expndtw0 D),\expnd-1\expndtw-6  \expnd0\expndtw0 (B,\expnd-1\expndtw-5  D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Phase\expnd-1\expndtw-5  \expnd0\expndtw0 2:\expnd-1\expndtw-5  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-4  \expnd0\expndtw-2 finding\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4507\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_equilibrium,\expnd-3\expndtw-16  \expnd0\expndtw0 solver_info\expnd-3\expndtw-15  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.solver.solve( \expnd0\expndtw-2 z_init=z_init,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 x_context=context, memory_patterns=self.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Track\expnd-2\expndtw-8  \expnd0\expndtw0 convergence\expnd-2\expndtw-8  \expnd0\expndtw-2 statistics\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4973\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 if self.training: \expnd0\expndtw-2 self.convergence_stats.append(\'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4789\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'converged': solver_info['converged'], 'iterations': solver_info['iterations'], 'final_energy':\expnd-3\expndtw-16  \expnd0\expndtw0 solver_info['final_energy'],\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'energy_components':\expnd4\expndtw18  \expnd0\expndtw-2 solver_info['energy_components']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3240\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Phase\expnd-1\expndtw-5  \expnd0\expndtw0 3:\expnd-1\expndtw-5  \expnd0\expndtw0 Memory\expnd-1\expndtw-5  \expnd0\expndtw0 update\expnd-1\expndtw-5  \expnd0\expndtw0 (if\expnd-1\expndtw-5  \expnd0\expndtw0 training\expnd-1\expndtw-5  \expnd0\expndtw0 or\expnd-1\expndtw-5  \expnd0\expndtw0 explicitly\expnd-1\expndtw-5  \expnd0\expndtw0 requested) if update_memory and (self.training or return_diagnostics):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.update_memory(z_equilibrium)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Phase\expnd-1\expndtw-3  \expnd0\expndtw0 4:\expnd-1\expndtw-3  \expnd0\expndtw0 Decode\expnd-1\expndtw-3  \expnd0\expndtw0 to\expnd-1\expndtw-3  \expnd0\expndtw-2 output\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Expand\expnd-1\expndtw-5  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-6  \expnd0\expndtw0 state\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 sequence\expnd-1\expndtw-5  \expnd0\expndtw-2 length\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_expanded\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 z_equilibrium.unsqueeze(1).expand(-1,\expnd-1\expndtw-7  \expnd0\expndtw0 seq_len,\expnd-2\expndtw-8  \expnd0\expndtw0 -1)\expnd9\expndtw47  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 (B,\expnd-1\expndtw-7  \expnd0\expndtw0 L,\expnd-1\expndtw-7  \expnd-1\expndtw-5 D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Combine\expnd-2\expndtw-9  \expnd0\expndtw0 with\expnd-2\expndtw-9  \expnd0\expndtw0 context\expnd-2\expndtw-9  \expnd0\expndtw0 (residual\expnd-2\expndtw-9  \expnd0\expndtw0 connection) combined = context + z_expanded\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Project\expnd-1\expndtw-3  \expnd0\expndtw0 to\expnd-1\expndtw-3  \expnd0\expndtw-2 vocabulary\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-2\expndtw-8  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 self.output_proj(combined)\expnd10\expndtw51  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 (B,\expnd-1\expndtw-6  \expnd0\expndtw0 L,\expnd-1\expndtw-5  \expnd0\expndtw-2 vocab_size)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri7183\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-16  \expnd0\expndtw0 return_diagnostics: diagnostics = \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5864\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'solver_info': solver_info, 'z_equilibrium':\expnd-3\expndtw-16  \expnd0\expndtw0 z_equilibrium, 'z_init': z_init,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2550\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'energy_trajectory': solver_info.get('energy_history', []), 'memory_usage':\expnd-3\expndtw-16  \expnd0\expndtw0 self._compute_memory_usage(z_equilibrium)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi244\ri6547\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-16  \expnd0\expndtw0 logits,\expnd-3\expndtw-15  \expnd0\expndtw0 diagnostics return logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 _compute_memory_usage(self,\expnd-3\expndtw-15  \expnd0\expndtw0 z_equilibrium): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Analyze\expnd-1\expndtw-6  \expnd0\expndtw0 how\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-5  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 are\expnd-1\expndtw-5  \expnd0\expndtw0 being\expnd-1\expndtw-5  \expnd0\expndtw-2 used.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4180\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Returns\expnd-2\expndtw-9  \expnd0\expndtw0 statistics\expnd-2\expndtw-9  \expnd0\expndtw0 about\expnd-2\expndtw-9  \expnd0\expndtw0 memory\expnd-2\expndtw-9  \expnd0\expndtw0 retrieval\expnd-2\expndtw-9  \expnd0\expndtw0 patterns. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Compute\expnd-2\expndtw-10  \expnd0\expndtw0 attention\expnd-2\expndtw-10  \expnd0\expndtw0 over\expnd-2\expndtw-10  \expnd0\expndtw0 memory similarities = torch.matmul(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_equilibrium,\expnd-3\expndtw-14  \expnd0\expndtw-2 self.memory_patterns.T\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 )\expnd12\expndtw59  \expnd0\expndtw0 #\expnd0\expndtw-2  \expnd0\expndtw0 (B,\expnd0\expndtw-1  \expnd-1\expndtw-5 M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 F.softmax(similarities,\expnd-2\expndtw-10  \expnd0\expndtw0 dim=-1)\expnd8\expndtw42  \expnd0\expndtw0 #\expnd-2\expndtw-10  \expnd0\expndtw0 (B,\expnd-2\expndtw-9  \expnd-1\expndtw-7 M)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3174\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Compute\expnd-1\expndtw-6  \expnd0\expndtw0 entropy\expnd-1\expndtw-6  \expnd0\expndtw0 (high\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 distributed,\expnd-1\expndtw-6  \expnd0\expndtw0 low\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 focused) entropy = -torch.sum(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention\expnd-2\expndtw-11  \expnd0\expndtw0 *\expnd-2\expndtw-8  \expnd0\expndtw0 torch.log(attention\expnd-2\expndtw-9  \expnd0\expndtw0 +\expnd-2\expndtw-8  \expnd0\expndtw0 1e-10),\expnd-2\expndtw-8  \expnd0\expndtw0 dim=-\expnd-2\expndtw-10 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ).mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Top-k\expnd-3\expndtw-15  \expnd0\expndtw0 usage\expnd-3\expndtw-15  \expnd0\expndtw0 (concentration) top_k = 10\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 top_k_mass\expnd3\expndtw17  \expnd0\expndtw-2 =\expnd3\expndtw17  \expnd0\expndtw-2 attention.topk(top_k,\expnd4\expndtw18  \expnd0\expndtw-2 dim=-1)[0].sum(dim=-1).mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4152\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'attention_entropy': entropy.item(), 'top_10_mass': top_k_mass.item(), 'num_patterns':\expnd-3\expndtw-16  \expnd0\expndtw0 self.memory_patterns.shape[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4347\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 get_implicit_gradients(self,\expnd-3\expndtw-14  \expnd0\expndtw0 z_equilibrium,\expnd-3\expndtw-14  \expnd0\expndtw0 loss): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Compute\expnd-2\expndtw-8  \expnd0\expndtw0 gradients\expnd-1\expndtw-7  \expnd0\expndtw0 using\expnd-1\expndtw-7  \expnd0\expndtw0 implicit\expnd-1\expndtw-7  \expnd0\expndtw-2 differentiation.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 For\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-6  \expnd0\expndtw0 models,\expnd-1\expndtw-6  \expnd0\expndtw0 we\expnd-1\expndtw-6  \expnd0\expndtw0 don't\expnd-1\expndtw-6  \expnd0\expndtw0 backprop\expnd-1\expndtw-6  \expnd0\expndtw0 through\expnd-1\expndtw-6  \expnd0\expndtw0 iterations. Instead, we use the implicit function theorem:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 dL/d\uc1\u952 ?\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 (I\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 \uc1\u8706 ?f/\uc1\u8706 ?z*)^(-1)\expnd-1\expndtw-4  \expnd0\expndtw-2 \uc1\u8706 ?f/\uc1\u8706 ?\uc1\u952 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 where\expnd-2\expndtw-10  \expnd0\expndtw0 z*\expnd-2\expndtw-10  \expnd0\expndtw0 is\expnd-2\expndtw-10  \expnd0\expndtw0 the\expnd-2\expndtw-10  \expnd0\expndtw0 equilibrium. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 This\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw0 handled\expnd-1\expndtw-5  \expnd0\expndtw0 automatically\expnd-1\expndtw-5  \expnd0\expndtw0 by\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 solver's\expnd-1\expndtw-5  \expnd0\expndtw0 backward\expnd-1\expndtw-5  \expnd0\expndtw0 pass # But we can provide explicit implementation for clarity\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.enable_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  z_equilibrium.detach().requires_grad_(True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5486\qj\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-14  \expnd0\expndtw0 Compute\expnd-3\expndtw-14  \expnd0\expndtw0 Jacobian-vector\expnd-3\expndtw-14  \expnd0\expndtw0 product def jvp(v):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6220\qj\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 """Compute\expnd-1\expndtw-3  \expnd0\expndtw0 (\uc1\u8706 ?f/\uc1\u8706 ?z)\expnd-1\expndtw-3  \expnd0\expndtw0 @\expnd-1\expndtw-3  \expnd0\expndtw0 v""" #\expnd-2\expndtw-8  \expnd0\expndtw0 Forward\expnd-2\expndtw-8  \expnd0\expndtw0 pass\expnd-2\expndtw-8  \expnd0\expndtw0 to\expnd-2\expndtw-8  \expnd0\expndtw0 get\expnd-2\expndtw-8  \expnd0\expndtw0 f(z) z_next = self.dynamics(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 z_eq,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 None,\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 Would\expnd-1\expndtw-7  \expnd0\expndtw0 need\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 cache\expnd-1\expndtw-7  \expnd0\expndtw0 context \expnd0\expndtw-2 self.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  \expnd-1\expndtw-5 vjp\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri6094\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-16  \expnd0\expndtw0 torch.autograd.grad( z_next, z_eq, v,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 retain_graph=True,\expnd2\expndtw10  \expnd0\expndtw-2 create_graph=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-4\charscalex100 )[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Solve\expnd-1\expndtw-4  \expnd0\expndtw0 (I\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 J)\expnd-1\expndtw-4  \expnd0\expndtw0 @\expnd-1\expndtw-4  \expnd0\expndtw0 g\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 \uc1\u8706 ?L/\uc1\u8706 ?z\expnd-1\expndtw-4  \expnd0\expndtw0 using\expnd-1\expndtw-4  \expnd0\expndtw0 conjugate\expnd-1\expndtw-4  \expnd0\expndtw0 gradient g_loss = torch.autograd.grad(loss, z_eq)[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Use iterative solver for (I - J)^(-1) @ g_loss implicit_grad\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 self._solve_implicit_gradient(jvp,\expnd-3\expndtw-14  \expnd0\expndtw0 g_loss)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 implicit_grad\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri2968\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 _solve_implicit_gradient(self,\expnd-2\expndtw-9  \expnd0\expndtw0 jvp_fn,\expnd-2\expndtw-9  \expnd0\expndtw0 g,\expnd-2\expndtw-9  \expnd0\expndtw0 max_iter=10,\expnd-2\expndtw-9  \expnd0\expndtw0 tol=1e-3): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Solve\expnd-1\expndtw-3  \expnd0\expndtw0 (I\expnd-1\expndtw-3  \expnd0\expndtw0 -\expnd-1\expndtw-3  \expnd0\expndtw0 J)\expnd-1\expndtw-3  \expnd0\expndtw0 @\expnd0\expndtw-2  \expnd0\expndtw0 x\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw0 g\expnd-1\expndtw-3  \expnd0\expndtw0 using\expnd-1\expndtw-3  \expnd0\expndtw0 conjugate\expnd0\expndtw-2  gradient.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri5300\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Avoids\expnd-2\expndtw-9  \expnd0\expndtw0 forming\expnd-2\expndtw-9  \expnd0\expndtw0 the\expnd-2\expndtw-9  \expnd0\expndtw0 full\expnd-2\expndtw-9  \expnd0\expndtw0 Jacobian\expnd-2\expndtw-9  \expnd0\expndtw0 matrix. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 x\expnd0\expndtw-1  \expnd0\expndtw0 =\expnd0\expndtw-1  \expnd0\expndtw-2 g.clone()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri7218\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 r\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 g\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 (x\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 jvp_fn(x)) p = r.clone()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6756\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for _ in range(max_iter): Ap = p - jvp_fn(p)\expnd8\expndtw40  \expnd0\expndtw0 r_dot\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 torch.sum(r\expnd-2\expndtw-10  \expnd0\expndtw0 *\expnd-2\expndtw-10  \expnd0\expndtw0 r)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri7378\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-13  \expnd0\expndtw0 r_dot\expnd-3\expndtw-13  \expnd0\expndtw0 <\expnd-3\expndtw-13  \expnd0\expndtw0 tol: \expnd0\expndtw-2 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5767\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 alpha\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 r_dot\expnd-1\expndtw-7  \expnd0\expndtw0 /\expnd-1\expndtw-7  \expnd0\expndtw0 torch.sum(p\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 Ap) x = x + alpha * p\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 r_new\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  \expnd0\expndtw0 r\expnd0\expndtw-2  \expnd0\expndtw0 -\expnd-1\expndtw-3  \expnd0\expndtw0 alpha\expnd0\expndtw-2  \expnd0\expndtw0 *\expnd0\expndtw-2  \expnd-1\expndtw-5 Ap\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5029\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 beta\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 torch.sum(r_new\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 r_new)\expnd-1\expndtw-7  \expnd0\expndtw0 /\expnd-1\expndtw-7  \expnd0\expndtw0 r_dot p = r_new + beta * p\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi244\ri7862\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 r\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 r_new return x\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 @torch.no_grad()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri1776\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 generate(self,\expnd-2\expndtw-9  \expnd0\expndtw0 prompt_ids,\expnd-2\expndtw-9  \expnd0\expndtw0 max_length=100,\expnd-2\expndtw-9  \expnd0\expndtw0 temperature=1.0,\expnd-2\expndtw-9  \expnd0\expndtw0 top_k=50): \expnd-1\expndtw-4 """\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 Autoregressive\expnd-2\expndtw-8  \expnd0\expndtw0 generation\expnd-2\expndtw-8  \expnd0\expndtw0 using\expnd-2\expndtw-8  \expnd0\expndtw0 the\expnd-2\expndtw-8  \expnd0\expndtw0 unified\expnd-1\expndtw-7  \expnd0\expndtw-2 model.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 At\expnd-1\expndtw-3  \expnd0\expndtw0 each\expnd-1\expndtw-3  \expnd0\expndtw-2 step:\par\pard\plain\s2\ls10\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Find\expnd-1\expndtw-7  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 current\expnd-1\expndtw-6  \expnd0\expndtw-2 context\par\pard\plain\s2\ls10\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb37\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Decode\expnd-1\expndtw-5  \expnd0\expndtw0 next\expnd-1\expndtw-5  \expnd0\expndtw-2 token\par\pard\plain\s2\ls10\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Append\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw-2 continue\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-2\expndtw-9  \expnd0\expndtw0 equilibrium\expnd-2\expndtw-9  \expnd0\expndtw0 naturally\expnd-2\expndtw-9  \expnd0\expndtw0 incorporates\expnd-2\expndtw-8  \expnd0\expndtw-2 both:\par\pard\plain\s2\ls10\ilvl1\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Sequential\expnd-1\expndtw-7  \expnd0\expndtw0 context\expnd-1\expndtw-7  \expnd0\expndtw0 (via\expnd-1\expndtw-7  \expnd0\expndtw-2 Mamba)\par\pard\plain\s2\ls10\ilvl1\nooverflow\nocwrap\lnbrkrule\li344\ri5756\sl276\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Retrieved\expnd-3\expndtw-13  \expnd0\expndtw0 memories\expnd-3\expndtw-13  \expnd0\expndtw0 (via\expnd-3\expndtw-13  \expnd0\expndtw0 Hopfield) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 generated\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 prompt_ids.clone()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd0\expndtw-2  \expnd0\expndtw0 _\expnd0\expndtw-2  \expnd0\expndtw0 in\expnd0\expndtw-2  range(max_length):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Get\expnd-1\expndtw-7  \expnd0\expndtw0 logits\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 current\expnd-1\expndtw-7  \expnd0\expndtw0 sequence logits,\expnd-1\expndtw-7  \expnd0\expndtw0 diagnostics\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw-2 self.forward(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 generated, update_memory=False, return_diagnostics=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-11  \expnd0\expndtw0 Take\expnd-2\expndtw-10  \expnd0\expndtw0 last\expnd-2\expndtw-10  \expnd0\expndtw0 position\expnd-2\expndtw-10  \expnd0\expndtw-2 logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 next_token_logits\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 logits[:,\expnd-1\expndtw-6  \expnd0\expndtw0 -1,\expnd-1\expndtw-5  \expnd0\expndtw0 :]\expnd-1\expndtw-6  \expnd0\expndtw0 /\expnd-1\expndtw-5  \expnd0\expndtw-2 temperature\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri7422\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 #\expnd-3\expndtw-14  \expnd0\expndtw-2 Top-k\expnd-3\expndtw-13  \expnd0\expndtw-2 filtering \expnd0\expndtw0 if top_k > 0:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 indices_to_remove\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 next_token_logits\expnd-2\expndtw-10  \expnd0\expndtw0 <\expnd-2\expndtw-10  \expnd0\expndtw0 torch.topk( next_token_logits, top_k\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 )[0][...,\expnd-1\expndtw-6  \expnd0\expndtw0 -1,\expnd-1\expndtw-6  \expnd0\expndtw-2 None]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 next_token_logits[indices_to_remove]\expnd4\expndtw20  \expnd0\expndtw-2 =\expnd5\expndtw23  \expnd0\expndtw-2 float('-inf')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Sample\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3492\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 probs = F.softmax(next_token_logits, dim=-1) next_token\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 torch.multinomial(probs,\expnd-3\expndtw-14  \expnd0\expndtw0 num_samples=1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Append\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 generated\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw0 torch.cat([generated,\expnd-2\expndtw-12  \expnd0\expndtw0 next_token],\expnd-2\expndtw-12  \expnd0\expndtw0 dim=-\expnd-1\expndtw-5 1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3357\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Optional:\expnd-1\expndtw-6  \expnd0\expndtw0 Store\expnd-1\expndtw-6  \expnd0\expndtw0 interesting\expnd-1\expndtw-6  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-6  \expnd0\expndtw0 states\expnd-1\expndtw-6  \expnd0\expndtw0 in\expnd-1\expndtw-6  \expnd0\expndtw0 memory if diagnostics['solver_info']['converged']:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  diagnostics['z_equilibrium']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi488\ri1159\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.update_memory(z_eq,\expnd-3\expndtw-16  \expnd0\expndtw0 should_store=torch.ones(1,\expnd-3\expndtw-15  \expnd0\expndtw0 dtype=torch.bool)) return generated\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 --\expnd-2\expndtw-12 -\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-10  \expnd0\expndtw0 **Phase\expnd-1\expndtw-7  \expnd0\expndtw0 5:\expnd-1\expndtw-7  \expnd0\expndtw0 Advanced\expnd-1\expndtw-7  \expnd0\expndtw0 Training\expnd-1\expndtw-7  \expnd0\expndtw-2 Infrastructure**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-11  \expnd0\expndtw0 **Step\expnd-2\expndtw-9  \expnd0\expndtw0 5.1:\expnd-2\expndtw-8  \expnd0\expndtw0 Energy-Based\expnd-2\expndtw-9  \expnd0\expndtw0 Training\expnd-2\expndtw-9  \expnd0\expndtw0 Objectives\expnd-2\expndtw-8  \expnd0\expndtw-2 (src/training/objectives.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6436\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 class UnifiedTrainingObjective: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Multi-component\expnd-2\expndtw-9  \expnd0\expndtw0 loss\expnd-1\expndtw-7  \expnd0\expndtw0 function\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 training\expnd-1\expndtw-7  \expnd0\expndtw0 the\expnd-1\expndtw-7  \expnd0\expndtw0 unified\expnd-1\expndtw-6  \expnd0\expndtw-2 model.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Combines:\par\pard\plain\s2\ls11\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Task\expnd-2\expndtw-12  \expnd0\expndtw0 loss\expnd-2\expndtw-11  \expnd0\expndtw0 (e.g.,\expnd-2\expndtw-12  \expnd0\expndtw0 language\expnd-2\expndtw-11  \expnd0\expndtw-2 modeling)\par\pard\plain\s2\ls11\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-2\expndtw-8  \expnd0\expndtw0 regularization\expnd-2\expndtw-8  \expnd0\expndtw0 (encourage\expnd-2\expndtw-8  \expnd0\expndtw0 low\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw-2 states)\par\pard\plain\s2\ls11\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Convergence\expnd-2\expndtw-12  \expnd0\expndtw0 regularization\expnd-2\expndtw-10  \expnd0\expndtw0 (encourage\expnd-2\expndtw-10  \expnd0\expndtw0 fast\expnd-2\expndtw-9  \expnd0\expndtw-2 convergence)\par\pard\plain\s2\ls11\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri3458\sl276\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Stability\expnd-2\expndtw-10  \expnd0\expndtw0 regularization\expnd-2\expndtw-10  \expnd0\expndtw0 (encourage\expnd-2\expndtw-10  \expnd0\expndtw0 contractive\expnd-2\expndtw-10  \expnd0\expndtw0 dynamics) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 task_weight=1.0, energy_weight=0.1, convergence_weight=0.05, stability_weight=0.01, contraction_target=0.9\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.w_task = task_weight self.w_energy = energy_weight self.w_conv\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 convergence_weight self.w_stab = stability_weight\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.contraction_target\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw-2 contraction_target\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4180\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 compute_loss(self,\expnd-2\expndtw-11  \expnd0\expndtw0 model,\expnd-2\expndtw-11  \expnd0\expndtw0 batch,\expnd-2\expndtw-11  \expnd0\expndtw0 diagnostics): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Compute\expnd-1\expndtw-7  \expnd0\expndtw0 full\expnd-1\expndtw-6  \expnd0\expndtw0 training\expnd-1\expndtw-6  \expnd0\expndtw-2 loss.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5300\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 model:\expnd-3\expndtw-16  \expnd0\expndtw0 UnifiedMambaHopfieldDEQ batch: (input_ids, target_ids)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri2377\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 diagnostics:\expnd-2\expndtw-10  \expnd0\expndtw0 From\expnd-2\expndtw-10  \expnd0\expndtw0 forward\expnd-2\expndtw-10  \expnd0\expndtw0 pass\expnd-2\expndtw-10  \expnd0\expndtw0 with\expnd-2\expndtw-10  \expnd0\expndtw0 return_diagnostics=True \expnd0\expndtw-2 Returns:\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_loss,\expnd-3\expndtw-13  \expnd0\expndtw0 loss_components\expnd-3\expndtw-13  \expnd-1\expndtw-4 dict\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids,\expnd-1\expndtw-7  \expnd0\expndtw0 target_ids\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw-2 batch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 diagnostics['logits']\expnd-1\expndtw-7  \expnd0\expndtw0 if\expnd-1\expndtw-7  \expnd0\expndtw0 'logits'\expnd-1\expndtw-7  \expnd0\expndtw0 in\expnd-1\expndtw-7  \expnd0\expndtw0 diagnostics\expnd-1\expndtw-7  \expnd0\expndtw0 else\expnd-1\expndtw-6  \expnd0\expndtw-2 model(input_ids)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 1.\expnd-2\expndtw-10  \expnd0\expndtw0 Task\expnd-2\expndtw-10  \expnd0\expndtw0 loss\expnd-2\expndtw-10  \expnd0\expndtw0 (cross-entropy\expnd-2\expndtw-10  \expnd0\expndtw0 for\expnd-2\expndtw-10  \expnd0\expndtw0 language\expnd-2\expndtw-10  \expnd0\expndtw0 modeling) loss_task = F.cross_entropy(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5878\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits.view(-1,\expnd-3\expndtw-16  \expnd0\expndtw0 logits.size(-1)), \expnd0\expndtw-2 target_ids.view(-1), ignore_index=-100\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 2.\expnd-1\expndtw-7  \expnd0\expndtw0 Energy\expnd-1\expndtw-7  \expnd0\expndtw0 regularization\expnd-1\expndtw-7  \expnd0\expndtw0 (prefer\expnd-1\expndtw-7  \expnd0\expndtw0 low-energy\expnd-1\expndtw-7  \expnd0\expndtw0 equilibria) solver_info = diagnostics['solver_info']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 final_energy = solver_info['final_energy'] energy_components\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 solver_info['energy_components']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss_energy\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 self.w_energy\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-6  \expnd0\expndtw-2 final_energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 3.\expnd-1\expndtw-7  \expnd0\expndtw0 Convergence\expnd-1\expndtw-7  \expnd0\expndtw0 regularization\expnd-1\expndtw-7  \expnd0\expndtw0 (prefer\expnd-1\expndtw-7  \expnd0\expndtw0 fast\expnd-1\expndtw-7  \expnd0\expndtw0 convergence) num_iterations = solver_info['iterations']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Penalize\expnd-1\expndtw-5  \expnd0\expndtw0 high\expnd-1\expndtw-6  \expnd0\expndtw0 iteration\expnd-1\expndtw-5  \expnd0\expndtw-2 counts\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss_convergence\expnd-2\expndtw-8  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 self.w_conv\expnd-2\expndtw-8  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 (num_iterations\expnd-2\expndtw-8  \expnd0\expndtw0 /\expnd-1\expndtw-7  \expnd0\expndtw-2 model.solver.max_iter)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2968\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 4.\expnd-1\expndtw-7  \expnd0\expndtw0 Stability\expnd-1\expndtw-7  \expnd0\expndtw0 regularization\expnd-1\expndtw-7  \expnd0\expndtw0 (encourage\expnd-1\expndtw-7  \expnd0\expndtw0 contractive\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics) # Check if Jacobian has eigenvalues < 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  diagnostics['z_equilibrium']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 lipschitz_const\expnd-3\expndtw-15  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 self._estimate_lipschitz(model,\expnd-3\expndtw-13  \expnd0\expndtw0 z_eq,\expnd-3\expndtw-13  \expnd0\expndtw-2 diagnostics)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Penalize\expnd-1\expndtw-5  \expnd0\expndtw0 if\expnd-1\expndtw-5  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-5  \expnd0\expndtw0 constant\expnd-1\expndtw-5  \expnd0\expndtw0 >\expnd-1\expndtw-4  \expnd0\expndtw-2 target\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss_stability\expnd-3\expndtw-13  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw0 self.w_stab\expnd-2\expndtw-12  \expnd0\expndtw0 *\expnd-3\expndtw-13  \expnd0\expndtw0 F.relu(lipschitz_const\expnd-2\expndtw-12  \expnd0\expndtw0 -\expnd-2\expndtw-12  \expnd0\expndtw-2 self.contraction_target)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-17  \expnd0\expndtw0 Total\expnd-3\expndtw-15  \expnd-1\expndtw-4 loss\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_loss\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 loss_task\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 loss_energy\expnd-1\expndtw-7  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 loss_convergence\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw-2 loss_stability\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6488\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss_components = \'7B 'total':\expnd-3\expndtw-16  \expnd0\expndtw0 total_loss.item(), 'task':\expnd-1\expndtw-7  \expnd0\expndtw-2 loss_task.item(),\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'energy':\expnd-3\expndtw-14  \expnd0\expndtw0 loss_energy.item()\expnd-3\expndtw-14  \expnd0\expndtw0 if\expnd-3\expndtw-14  \expnd0\expndtw0 isinstance(loss_energy,\expnd-3\expndtw-14  \expnd0\expndtw0 torch.Tensor)\expnd-3\expndtw-14  \expnd0\expndtw0 else\expnd-3\expndtw-14  \expnd0\expndtw0 loss_energy, \expnd0\expndtw-2 'convergence':\expnd3\expndtw14  \expnd0\expndtw-2 loss_convergence.item()\expnd3\expndtw17  \expnd0\expndtw-2 if\expnd3\expndtw17  \expnd0\expndtw-2 isinstance(loss_convergence,\expnd3\expndtw17  \expnd0\expndtw-2 torch.Tensor)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 else\expnd-1\expndtw-4  \expnd0\expndtw-2 loss_convergence,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri194\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 'stability':\expnd-3\expndtw-16  \expnd0\expndtw0 loss_stability.item()\expnd-3\expndtw-15  \expnd0\expndtw0 if\expnd-3\expndtw-15  \expnd0\expndtw0 isinstance(loss_stability,\expnd-3\expndtw-16  \expnd0\expndtw0 torch.Tensor)\expnd-3\expndtw-15  \expnd0\expndtw0 else\expnd-3\expndtw-15  \expnd0\expndtw0 loss_stability, 'num_iterations': num_iterations,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'lipschitz_constant':\expnd4\expndtw21  \expnd0\expndtw-2 lipschitz_const,\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'energy_components':\expnd4\expndtw20  \expnd0\expndtw-2 energy_components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-2\expndtw-9  \expnd0\expndtw0 total_loss,\expnd-2\expndtw-8  \expnd0\expndtw-2 loss_components\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri1217\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-9  \expnd0\expndtw0 _estimate_lipschitz(self,\expnd-2\expndtw-9  \expnd0\expndtw0 model,\expnd-2\expndtw-9  \expnd0\expndtw0 z_equilibrium,\expnd-2\expndtw-9  \expnd0\expndtw0 diagnostics,\expnd-2\expndtw-9  \expnd0\expndtw0 num_samples=5): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Estimate\expnd-2\expndtw-9  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-6  \expnd0\expndtw0 constant\expnd-1\expndtw-6  \expnd0\expndtw0 of\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics\expnd-1\expndtw-6  \expnd0\expndtw0 via\expnd-1\expndtw-6  \expnd0\expndtw-2 sampling.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6009\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 L\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 max\expnd-1\expndtw-5  \expnd0\expndtw0 ||f(z\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u948 ?)\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-5  \expnd0\expndtw0 f(z)||\expnd-1\expndtw-5  \expnd0\expndtw0 /\expnd-1\expndtw-5  \expnd0\expndtw0 ||\uc1\u948 ?|| \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with torch.no_grad(): lipschitz_estimates\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5820\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 _\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_samples): # Random perturbation epsilon = 0.01\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 delta\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 epsilon\expnd-2\expndtw-11  \expnd0\expndtw0 *\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randn_like(z_equilibrium) z_perturbed = z_equilibrium + delta\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Evaluate\expnd-1\expndtw-5  \expnd0\expndtw0 dynamics\expnd-1\expndtw-4  \expnd0\expndtw0 at\expnd-1\expndtw-5  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw-2 points\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4322\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 (Need\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 cache\expnd-1\expndtw-7  \expnd0\expndtw0 context\expnd-1\expndtw-7  \expnd0\expndtw0 from\expnd-1\expndtw-7  \expnd0\expndtw0 diagnostics) context = diagnostics.get('context', None)\expnd8\expndtw40  \expnd0\expndtw0 if context is None:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Skip\expnd-2\expndtw-8  \expnd0\expndtw0 if\expnd-2\expndtw-8  \expnd0\expndtw0 context\expnd-2\expndtw-8  \expnd0\expndtw0 not\expnd-2\expndtw-8  \expnd0\expndtw0 available return 0.0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 f_z = model.dynamics(z_equilibrium, context, model.memory_patterns) f_z_pert\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 model.dynamics(z_perturbed,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-5  \expnd0\expndtw-2 estimate\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri2377\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 numerator\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.norm(f_z_pert\expnd-2\expndtw-9  \expnd0\expndtw0 -\expnd-2\expndtw-9  \expnd0\expndtw0 f_z,\expnd-2\expndtw-9  \expnd0\expndtw0 dim=-1).mean() denominator = torch.norm(delta, dim=-1).mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 lipschitz_estimates.append((numerator\expnd3\expndtw17  \expnd0\expndtw-2 /\expnd4\expndtw19  \expnd0\expndtw-2 denominator).item())\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 np.mean(lipschitz_estimates)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-10  \expnd0\expndtw0 **Step\expnd-2\expndtw-8  \expnd0\expndtw0 5.2:\expnd-2\expndtw-8  \expnd0\expndtw0 Curriculum\expnd-2\expndtw-8  \expnd0\expndtw0 Training\expnd-2\expndtw-8  \expnd0\expndtw-2 (src/training/trainer.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6841\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 class UnifiedModelTrainer: \expnd-1\expndtw-4 """\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 Training\expnd-2\expndtw-9  \expnd0\expndtw0 loop\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-7  \expnd0\expndtw0 curriculum\expnd-1\expndtw-6  \expnd0\expndtw0 learning\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 stable\expnd-1\expndtw-7  \expnd0\expndtw0 DEQ\expnd-1\expndtw-6  \expnd0\expndtw-2 training.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Curriculum\expnd-2\expndtw-10  \expnd0\expndtw-2 stages:\par\pard\plain\s2\ls12\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Warm-up:\expnd-2\expndtw-9  \expnd0\expndtw0 Train\expnd-2\expndtw-8  \expnd0\expndtw0 with\expnd-2\expndtw-9  \expnd0\expndtw0 few\expnd-2\expndtw-8  \expnd0\expndtw0 iterations,\expnd-2\expndtw-9  \expnd0\expndtw0 high\expnd-2\expndtw-8  \expnd0\expndtw-2 tolerance\par\pard\plain\s2\ls12\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb37\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Gradual\expnd-2\expndtw-11  \expnd0\expndtw0 tightening:\expnd-2\expndtw-9  \expnd0\expndtw0 Increase\expnd-2\expndtw-9  \expnd0\expndtw0 iterations,\expnd-2\expndtw-9  \expnd0\expndtw0 decrease\expnd-2\expndtw-9  \expnd0\expndtw-2 tolerance\par\pard\plain\s2\ls12\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Full\expnd-2\expndtw-8  \expnd0\expndtw0 training:\expnd-2\expndtw-8  \expnd0\expndtw0 Train\expnd-2\expndtw-8  \expnd0\expndtw0 with\expnd-2\expndtw-8  \expnd0\expndtw0 target\expnd-2\expndtw-8  \expnd0\expndtw0 convergence\expnd-1\expndtw-7  \expnd0\expndtw-2 criteria\par\pard\plain\s2\ls12\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri3604\sl276\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Memory\expnd-2\expndtw-8  \expnd0\expndtw0 integration:\expnd-2\expndtw-8  \expnd0\expndtw0 Gradually\expnd-2\expndtw-8  \expnd0\expndtw0 enable\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-2\expndtw-8  \expnd0\expndtw0 updates \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd0\expndtw-2  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw66\charscalex100{\ul   \f2\expnd0\expndtw-2}\f2\expnd0\expndtw-2 (self,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1138\ri6783\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 model,\expnd8\expndtw40  \expnd0\expndtw-2 optimizer, train_loader, val_loader, objective, device='cuda', log_wandb=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5925\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.model = model.to(device) self.optimizer = optimizer self.train_loader\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 train_loader self.val_loader = val_loader self.objective = objective self.device = device self.log_wandb = log_wandb\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.step\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.epoch\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Curriculum\expnd-3\expndtw-15  \expnd0\expndtw0 schedule self.curriculum = \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'warmup_steps':\expnd-3\expndtw-15  \expnd0\expndtw-2 1000,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2377\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'max_iter_schedule': [5, 10, 20, 30],\expnd8\expndtw40  \expnd0\expndtw0 # Increase gradually 'tolerance_schedule': [1e-2, 5e-3, 1e-3, 5e-4], 'memory_enable_step':\expnd-1\expndtw-6  \expnd0\expndtw0 2000\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 When\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 start\expnd-1\expndtw-6  \expnd0\expndtw0 updating\expnd-1\expndtw-6  \expnd0\expndtw0 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5997\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 get_curriculum_params(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3174\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Get\expnd-1\expndtw-6  \expnd0\expndtw0 current\expnd-1\expndtw-6  \expnd0\expndtw0 curriculum\expnd-1\expndtw-6  \expnd0\expndtw0 parameters\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-6  \expnd0\expndtw0 training\expnd-1\expndtw-6  \expnd0\expndtw0 step. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4572\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-14  \expnd0\expndtw0 self.step\expnd-3\expndtw-14  \expnd0\expndtw0 <\expnd-3\expndtw-14  \expnd0\expndtw0 self.curriculum['warmup_steps']: # Warmup: very relaxed\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_iter\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw-2 self.curriculum['max_iter_schedule'][0]\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri3492\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 tolerance\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.curriculum['tolerance_schedule'][0] \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Determine\expnd-2\expndtw-8  \expnd0\expndtw0 stage\expnd-2\expndtw-8  \expnd0\expndtw0 based\expnd-2\expndtw-8  \expnd0\expndtw0 on\expnd-2\expndtw-8  \expnd0\expndtw0 step stage = min(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 len(self.curriculum['max_iter_schedule']) - 1, (self.step\expnd-2\expndtw-11  \expnd0\expndtw0 -\expnd-2\expndtw-11  \expnd0\expndtw0 self.curriculum['warmup_steps'])\expnd-2\expndtw-11  \expnd0\expndtw0 //\expnd-2\expndtw-11  \expnd0\expndtw0 2000\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_iter = self.curriculum['max_iter_schedule'][stage] tolerance\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.curriculum['tolerance_schedule'][stage]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1939\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 memory_enabled\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.step\expnd-2\expndtw-11  \expnd0\expndtw0 >=\expnd-2\expndtw-11  \expnd0\expndtw0 self.curriculum['memory_enable_step'] return max_iter, tolerance, memory_enabled\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 train_step(self,\expnd-3\expndtw-15  \expnd0\expndtw0 batch): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4180\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Single\expnd-2\expndtw-9  \expnd0\expndtw0 training\expnd-2\expndtw-9  \expnd0\expndtw0 step\expnd-2\expndtw-9  \expnd0\expndtw0 with\expnd-2\expndtw-9  \expnd0\expndtw0 curriculum\expnd-2\expndtw-9  \expnd0\expndtw0 adjustments. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.train()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Get\expnd-1\expndtw-5  \expnd0\expndtw0 curriculum\expnd-1\expndtw-4  \expnd0\expndtw-2 parameters\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_iter,\expnd-3\expndtw-14  \expnd0\expndtw0 tolerance,\expnd-2\expndtw-11  \expnd0\expndtw0 memory_enabled\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw-2 self.get_curriculum_params()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5088\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Update model solver parameters self.model.solver.max_iter = max_iter self.model.solver.tol_fp = tolerance self.model.solver.tol_energy\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 tolerance\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Move batch to device input_ids,\expnd-3\expndtw-14  \expnd0\expndtw0 target_ids\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 batch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids = input_ids.to(self.device) target_ids\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 target_ids.to(self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Forward\expnd-2\expndtw-10  \expnd0\expndtw0 pass\expnd-2\expndtw-10  \expnd0\expndtw0 with\expnd-2\expndtw-10  \expnd0\expndtw0 diagnostics logits, diagnostics = self.model(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 input_ids, update_memory=memory_enabled, return_diagnostics=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 diagnostics['logits']\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw-2 logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Compute\expnd-1\expndtw-4  loss\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss,\expnd-3\expndtw-14  \expnd0\expndtw0 loss_components\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 self.objective.compute_loss( \expnd0\expndtw-2 self.model,\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 (input_ids,\expnd-3\expndtw-16  \expnd0\expndtw0 target_ids), \expnd0\expndtw-2 diagnostics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Backward pass \expnd0\expndtw-2 self.optimizer.zero_grad() loss.backward()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1955\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Gradient clipping (essential for DEQ stability) torch.nn.utils.clip_grad_norm_(self.model.parameters(),\expnd-3\expndtw-16  \expnd0\expndtw0 max_norm=1.0)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri7048\sl-582\sb31\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.optimizer.step() \expnd0\expndtw0 # Logging\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl-221\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-7  \expnd0\expndtw0 self.log_wandb\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 self.step\expnd-1\expndtw-4  \expnd0\expndtw0 %\expnd-1\expndtw-5  \expnd0\expndtw0 10\expnd-1\expndtw-5  \expnd0\expndtw0 ==\expnd-1\expndtw-4  \expnd-1\expndtw-5 0:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 wandb.log(\'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri5325\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **loss_components, \expnd0\expndtw0 'curriculum/max_iter': max_iter, 'curriculum/tolerance':\expnd-3\expndtw-16  \expnd0\expndtw0 tolerance,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3357\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'curriculum/memory_enabled':\expnd-3\expndtw-16  \expnd0\expndtw0 int(memory_enabled), 'step': self.step\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.step\expnd-1\expndtw-6  \expnd0\expndtw0 +=\expnd-1\expndtw-5  \expnd-2\expndtw-10 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi244\ri6620\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-3\expndtw-16  \expnd0\expndtw0 loss_components def validate(self):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb40\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Validation\expnd-3\expndtw-15  \expnd0\expndtw0 loop\expnd-3\expndtw-15  \expnd0\expndtw0 with\expnd-3\expndtw-15  \expnd0\expndtw0 detailed\expnd-3\expndtw-15  \expnd0\expndtw0 diagnostics. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.eval()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_loss\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_converged = 0 total_iterations = [] energy_trajectories\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for batch in self.val_loader: input_ids,\expnd-3\expndtw-14  \expnd0\expndtw0 target_ids\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 batch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids = input_ids.to(self.device) target_ids\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 target_ids.to(self.device)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5224\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits,\expnd-3\expndtw-13  \expnd0\expndtw0 diagnostics\expnd-3\expndtw-13  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 self.model( \expnd0\expndtw-2 input_ids, update_memory=False, return_diagnostics=True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 diagnostics['logits']\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw-2 logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri3221\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 loss,\expnd-3\expndtw-14  \expnd0\expndtw0 loss_components\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 self.objective.compute_loss( \expnd0\expndtw-2 self.model,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri6058\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 (input_ids,\expnd-3\expndtw-16  \expnd0\expndtw0 target_ids), \expnd0\expndtw-2 diagnostics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 total_loss\expnd-1\expndtw-6  \expnd0\expndtw0 +=\expnd-1\expndtw-6  \expnd0\expndtw-2 loss.item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 solver_info = diagnostics['solver_info'] total_converged\expnd-3\expndtw-16  \expnd0\expndtw0 +=\expnd-3\expndtw-15  \expnd0\expndtw0 int(solver_info['converged']) \expnd0\expndtw-2 total_iterations.append(solver_info['iterations'])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if 'energy_history' in solver_info: \expnd0\expndtw-2 energy_trajectories.append(solver_info['energy_history'])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5541\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Aggregate statistics num_batches\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 len(self.val_loader) val_stats = \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'val/loss': total_loss / num_batches, 'val/convergence_rate':\expnd-3\expndtw-14  \expnd0\expndtw0 total_converged\expnd-3\expndtw-14  \expnd0\expndtw0 /\expnd-3\expndtw-14  \expnd0\expndtw0 num_batches, 'val/avg_iterations': np.mean(total_iterations), 'val/median_iterations': np.median(total_iterations), 'val/max_iterations': np.max(total_iterations)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if self.log_wandb: \expnd0\expndtw-2 wandb.log(val_stats)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 val_stats\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6436\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 train(self,\expnd-3\expndtw-15  \expnd0\expndtw0 num_epochs): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3920\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Full\expnd-1\expndtw-7  \expnd0\expndtw0 training\expnd-1\expndtw-7  \expnd0\expndtw0 loop\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-7  \expnd0\expndtw0 validation\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 checkpointing. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 epoch\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_epochs): self.epoch = epoch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\'5CnEpoch\expnd-2\expndtw-8  \expnd0\expndtw0 \'7Bepoch\expnd-1\expndtw-7  \expnd0\expndtw0 +\expnd-1\expndtw-7  \expnd0\expndtw-2 1\'7D/\'7Bnum_epochs\'7D")\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Training epoch_losses\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri1939\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-2\expndtw-11  \expnd0\expndtw0 batch_idx,\expnd-2\expndtw-11  \expnd0\expndtw0 batch\expnd-2\expndtw-11  \expnd0\expndtw0 in\expnd-2\expndtw-11  \expnd0\expndtw0 enumerate(tqdm(self.train_loader)): loss_components = self.train_step(batch) \expnd0\expndtw-2 epoch_losses.append(loss_components['total'])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Periodic\expnd-1\expndtw-4  \expnd0\expndtw-2 validation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 if self.step % 500 == 0: val_stats\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.validate()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1688\fi-367\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Step \'7Bself.step\'7D: Val Loss = \'7Bval_stats['val/loss']:.4f\'7D, " f"Convergence\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bval_stats['val/convergence_rate']:.2%\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5433\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 End-of-epoch\expnd-3\expndtw-15  \expnd0\expndtw0 validation val_stats = self.validate()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Checkpointing\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri1939\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 if (epoch + 1) % 5 == 0: self.save_checkpoint(f'checkpoint_epoch_\'7Bepoch\expnd-3\expndtw-16  \expnd0\expndtw0 +\expnd-3\expndtw-15  \expnd0\expndtw0 1\'7D.pt')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi244\ri6109\sl-582\sb32\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Training complete!") def\expnd-3\expndtw-16  \expnd0\expndtw0 save_checkpoint(self,\expnd-3\expndtw-15  \expnd0\expndtw0 path):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl-221\f2\fs22\b0\expnd0\expndtw0\charscalex100 """Save\expnd-1\expndtw-7  \expnd0\expndtw0 model\expnd-1\expndtw-7  \expnd0\expndtw0 checkpoint\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-1\expndtw-7  \expnd0\expndtw0 training\expnd-1\expndtw-6  \expnd0\expndtw-2 state."""\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 torch.save(\'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'model_state_dict': self.model.state_dict(), \expnd0\expndtw-2 'optimizer_state_dict': self.optimizer.state_dict(), \expnd0\expndtw0 'step': self.step,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'epoch':\expnd-2\expndtw-8  \expnd0\expndtw-2 self.epoch,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'memory_patterns':\expnd3\expndtw16  \expnd0\expndtw-2 self.model.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \'7D,\expnd0\expndtw-2  path)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb143\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\fi-245\ri6127\qj\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 def\expnd-1\expndtw-4  \expnd0\expndtw0 load_checkpoint(self,\expnd-1\expndtw-4  \expnd0\expndtw0 path): """Load model checkpoint.""" checkpoint\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 torch.load(path)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\ri2106\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.load_state_dict(checkpoint['model_state_dict']) self.optimizer.load_state_dict(checkpoint['optimizer_state_dict']) \expnd0\expndtw0 self.step = checkpoint['step']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.epoch\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 checkpoint['epoch']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.model.memory_patterns\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw-2 checkpoint['memory_patterns']\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb18\sa1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-20\f2\fs2
{\field\fldlock
{\*\fldinst SHAPE  \\* MERGEFORMAT}
{\fldrslt 
{\shpgrp{\*\shpinst\shplid1098
\shpleft0\shptop0\shpright367\shpbottom20\shpfhdr0
\shpbxcolumn\shpbxignore\shpbypara\shpbyignore\shpwr3\shpwrk0\shpfblwtxt1\shpz5
\shplockanchor
\shpwr3\shpwrk0\shpfblwtxt1{\sp{\sn groupLeft}{\sv 0}}
{\sp{\sn groupTop}{\sv 0}}
{\sp{\sn groupRight}{\sv 367}}
{\sp{\sn groupBottom}{\sv 20}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn lidRegroup}{\sv 0}}
{\sp{\sn posrelh}{\sv 3}}
{\sp{\sn posrelv}{\sv 3}}

{\shp{\*\shpinst\shplid1099
{\sp{\sn relLeft}{\sv 0}}
{\sp{\sn relTop}{\sv 9}}
{\sp{\sn relRight}{\sv 367}}
{\sp{\sn relBottom}{\sv 10}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 1}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
{\pict
{\*\picprop\defshp\shplid1098
{\sp{\sn shapeType}{\sv 75}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn fLayoutInCell}{\sv 1}}
{\sp{\sn fLockPosition}{\sv 1}}
{\sp{\sn fLockRotation}{\sv 1}}
}
\piccropl0\piccropr0\piccropt-20\piccropb20\picwgoal367\pichgoal20
\wmetafile8\bliptag-1003278350\blipupi72
}
}}
\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb159\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-10  \expnd0\expndtw0 **Phase\expnd-2\expndtw-10  \expnd0\expndtw0 6:\expnd-2\expndtw-10  \expnd0\expndtw0 Theoretical\expnd-2\expndtw-10  \expnd0\expndtw0 Validation\expnd-2\expndtw-9  \expnd0\expndtw-2 Experiments**\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-1\expndtw-7  \expnd0\expndtw0 **Step\expnd-1\expndtw-7  \expnd0\expndtw0 6.1:\expnd-1\expndtw-6  \expnd0\expndtw0 Convergence\expnd-1\expndtw-7  \expnd0\expndtw0 Analysis\expnd-1\expndtw-6  \expnd0\expndtw-2 (experiments/theory/convergence_proofs.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6547\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 class\expnd-1\expndtw-3  \expnd0\expndtw-2 ConvergenceValidator: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Empirically\expnd-2\expndtw-11  \expnd0\expndtw0 validate\expnd-2\expndtw-10  \expnd0\expndtw0 theoretical\expnd-2\expndtw-10  \expnd0\expndtw0 convergence\expnd-2\expndtw-10  \expnd0\expndtw-2 properties.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Tests:\par\pard\plain\s2\ls13\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Contraction\expnd-1\expndtw-7  \expnd0\expndtw0 mapping:\expnd-1\expndtw-4  \expnd0\expndtw0 ||f(z1)\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 f(z2)||\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u8804 ?\expnd-1\expndtw-4  \expnd0\expndtw0 L||z1\expnd-1\expndtw-4  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 z2||\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw0 L\expnd-1\expndtw-4  \expnd0\expndtw0 <\expnd-1\expndtw-4  \expnd-2\expndtw-10 1\par\pard\plain\s2\ls13\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-2\expndtw-9  \expnd0\expndtw0 decrease:\expnd-1\expndtw-6  \expnd0\expndtw0 E(z_\'7Bt+1\'7D)\expnd-1\expndtw-6  \expnd0\expndtw0 \uc1\u8804 ?\expnd-1\expndtw-6  \expnd0\expndtw0 E(z_t)\expnd-1\expndtw-6  \expnd0\expndtw0 along\expnd-1\expndtw-6  \expnd0\expndtw-2 trajectories\par\pard\plain\s2\ls13\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Fixed-point\expnd-2\expndtw-11  \expnd0\expndtw0 stability:\expnd-2\expndtw-9  \expnd0\expndtw0 Small\expnd-2\expndtw-9  \expnd0\expndtw0 perturbations\expnd-2\expndtw-9  \expnd0\expndtw0 don't\expnd-2\expndtw-8  \expnd0\expndtw-2 destabilize\par\pard\plain\s2\ls13\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri3571\sl276\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Lyapunov\expnd-2\expndtw-10  \expnd0\expndtw0 stability:\expnd-2\expndtw-10  \expnd0\expndtw0 Energy\expnd-2\expndtw-10  \expnd0\expndtw0 serves\expnd-2\expndtw-10  \expnd0\expndtw0 as\expnd-2\expndtw-10  \expnd0\expndtw0 Lyapunov\expnd-2\expndtw-10  \expnd0\expndtw0 function \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-1\expndtw-5  \f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 (self,\expnd-1\expndtw-5  \expnd0\expndtw0 model,\expnd-1\expndtw-5  \expnd0\expndtw0 device='cuda'): self.model = model.to(device) self.device = device\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 test_contraction_property(self,\expnd-3\expndtw-15  \expnd0\expndtw0 num_samples=100): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Test\expnd-2\expndtw-9  \expnd0\expndtw0 if\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics\expnd-1\expndtw-7  \expnd0\expndtw0 are\expnd-1\expndtw-7  \expnd0\expndtw0 contractive:\expnd-1\expndtw-7  \expnd0\expndtw0 ||f(z1)\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 f(z2)||\expnd-1\expndtw-7  \expnd0\expndtw0 \uc1\u8804 ?\expnd-1\expndtw-7  \expnd0\expndtw0 L||z1\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd-1\expndtw-4 z2||\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Sample\expnd-1\expndtw-7  \expnd0\expndtw0 random\expnd-1\expndtw-7  \expnd0\expndtw0 states\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 estimate\expnd-1\expndtw-7  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-7  \expnd0\expndtw0 constant. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl552\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("Testing\expnd-1\expndtw-3  \expnd0\expndtw-2 contraction\expnd-1\expndtw-3  \expnd0\expndtw-2 property...") \expnd0\expndtw0 lipschitz_constants = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5214\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 _\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(num_samples)): # Sample two random states\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri2558\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z1\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-11  \expnd0\expndtw0 device=self.device) z2\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-9  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Dummy\expnd-1\expndtw-4  \expnd0\expndtw0 context\expnd-1\expndtw-4  \expnd0\expndtw0 (or\expnd-1\expndtw-4  \expnd0\expndtw0 use\expnd-1\expndtw-4  \expnd0\expndtw0 real\expnd-1\expndtw-3  \expnd0\expndtw-2 data)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Evaluate\expnd-1\expndtw-4  \expnd0\expndtw-2 dynamics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri1594\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 f_z1\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.dynamics(z1,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.memory_patterns) f_z2\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.dynamics(z2,\expnd-2\expndtw-9  \expnd0\expndtw0 context,\expnd-2\expndtw-9  \expnd0\expndtw-2 self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Compute Lipschitz constant numerator\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 torch.norm(f_z1\expnd-2\expndtw-10  \expnd0\expndtw0 -\expnd-2\expndtw-10  \expnd0\expndtw0 f_z2)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 denominator\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.norm(z1\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd-1\expndtw-5 z2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri3920\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-5  \expnd0\expndtw0 denominator\expnd-1\expndtw-5  \expnd0\expndtw0 >\expnd-1\expndtw-5  \expnd0\expndtw0 1e-6:\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 Avoid\expnd-1\expndtw-5  \expnd0\expndtw0 division\expnd-1\expndtw-5  \expnd0\expndtw0 by\expnd-1\expndtw-5  \expnd0\expndtw0 zero L = (numerator / denominator).item() \expnd0\expndtw-2 lipschitz_constants.append(L)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Statistics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 mean_L\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 np.mean(lipschitz_constants) max_L = np.max(lipschitz_constants)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 pct_contractive\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 np.mean([L\expnd-1\expndtw-5  \expnd0\expndtw0 <\expnd-1\expndtw-4  \expnd0\expndtw0 1.0\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 L\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw-2 lipschitz_constants])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Lipschitz\expnd-3\expndtw-14  \expnd0\expndtw0 constant:\expnd-3\expndtw-14  \expnd0\expndtw0 mean=\'7Bmean_L:.4f\'7D,\expnd-3\expndtw-14  \expnd0\expndtw0 max=\'7Bmax_L:.4f\'7D") print(f"Contractive: \'7Bpct_contractive:.1%\'7D of samples")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4693\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'mean_lipschitz': mean_L,\expnd8\expndtw40  \expnd0\expndtw0 'max_lipschitz': max_L, 'contractive_percentage':\expnd-3\expndtw-16  \expnd0\expndtw0 pct_contractive, 'is_contraction': max_L < 1.0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2558\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 test_energy_descent(self,\expnd-3\expndtw-14  \expnd0\expndtw0 num_trajectories=50,\expnd-3\expndtw-14  \expnd0\expndtw0 num_steps=30): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Verify\expnd-2\expndtw-9  \expnd0\expndtw0 that\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-2\expndtw-9  \expnd0\expndtw0 decreases\expnd-2\expndtw-8  \expnd0\expndtw0 along\expnd-2\expndtw-8  \expnd0\expndtw-2 trajectories.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1776\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Initialize\expnd-1\expndtw-6  \expnd0\expndtw0 random\expnd-1\expndtw-6  \expnd0\expndtw0 states\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 iterate\expnd-1\expndtw-6  \expnd0\expndtw0 dynamics,\expnd-1\expndtw-6  \expnd0\expndtw0 checking\expnd-1\expndtw-6  \expnd0\expndtw0 E(z_t)\expnd-1\expndtw-6  \expnd0\expndtw0 decreases. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("Testing\expnd0\expndtw1  \expnd0\expndtw-2 energy\expnd0\expndtw1  \expnd0\expndtw-2 descent\expnd0\expndtw1  \expnd0\expndtw-2 property...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 descent_violations = 0 energy_trajectories\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri4957\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 _\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(num_trajectories)): # Random initialization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri1159\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-9  \expnd0\expndtw0 device=self.device) energies = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5593\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 step\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_steps): # Compute current energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri1217\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.dynamics(z,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.memory_patterns) E, _ = self.model.energy_fn(z, z_next, self.model.memory_patterns)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 energies.append(E.item())\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri6749\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Update\expnd-3\expndtw-15  \expnd0\expndtw0 state z = z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 energy_trajectories.append(energies)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4347\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Check\expnd-2\expndtw-9  \expnd0\expndtw0 for\expnd-2\expndtw-9  \expnd0\expndtw0 violations\expnd-2\expndtw-9  \expnd0\expndtw0 (energy\expnd-2\expndtw-9  \expnd0\expndtw0 increases) for i in range(len(energies) - 1):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\fi-245\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-4  \expnd0\expndtw0 energies[i\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 1]\expnd-1\expndtw-4  \expnd0\expndtw0 >\expnd-1\expndtw-4  \expnd0\expndtw0 energies[i]\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 1e-4:\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-4  \expnd0\expndtw0 Small\expnd-1\expndtw-4  \expnd0\expndtw0 tolerance descent_violations += 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3649\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 violation_rate = descent_violations / num_trajectories print(f"Energy\expnd-3\expndtw-14  \expnd0\expndtw0 descent\expnd-3\expndtw-14  \expnd0\expndtw0 violations:\expnd-3\expndtw-14  \expnd0\expndtw0 \'7Bviolation_rate:.1%\'7D") # Visualize some trajectories\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb42\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.figure(figsize=(10,\expnd5\expndtw23  \expnd-1\expndtw-5 6))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 traj\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 energy_trajectories[:10]: plt.plot(traj, alpha=0.5)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5767\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.xlabel('Iteration') plt.ylabel('Energy') \expnd0\expndtw0 plt.title('Energy Trajectories') \expnd0\expndtw-2 plt.savefig('energy_descent.png')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4714\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'violation_rate': violation_rate, 'energy_trajectories':\expnd-3\expndtw-16  \expnd0\expndtw0 energy_trajectories, 'monotonic_descent':\expnd-2\expndtw-12  \expnd0\expndtw0 violation_rate\expnd-2\expndtw-12  \expnd0\expndtw0 <\expnd-2\expndtw-11  \expnd-1\expndtw-5 0.1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri1217\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 test_fixed_point_stability(self,\expnd-3\expndtw-14  \expnd0\expndtw0 num_fixed_points=20,\expnd-3\expndtw-14  \expnd0\expndtw0 num_perturbations=10): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Test\expnd-2\expndtw-11  \expnd0\expndtw0 stability\expnd-2\expndtw-11  \expnd0\expndtw0 of\expnd-2\expndtw-10  \expnd0\expndtw0 converged\expnd-2\expndtw-11  \expnd0\expndtw0 fixed\expnd-2\expndtw-10  \expnd0\expndtw-2 points.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3174\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Find\expnd-2\expndtw-8  \expnd0\expndtw0 equilibria,\expnd-2\expndtw-8  \expnd0\expndtw0 perturb\expnd-2\expndtw-8  \expnd0\expndtw0 slightly,\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-2\expndtw-8  \expnd0\expndtw0 check\expnd-2\expndtw-8  \expnd0\expndtw0 if\expnd-2\expndtw-8  \expnd0\expndtw0 system\expnd-2\expndtw-8  \expnd0\expndtw0 returns. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl552\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("Testing fixed-point stability...") \expnd0\expndtw0 stable_count = 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd0\expndtw-2  \expnd0\expndtw0 _\expnd0\expndtw-2  \expnd0\expndtw0 in\expnd0\expndtw-2  tqdm(range(num_fixed_points)):\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Find\expnd-1\expndtw-3  \expnd0\expndtw0 a\expnd-1\expndtw-3  \expnd0\expndtw0 fixed\expnd0\expndtw-2  point\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri1776\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_init = torch.randn(1, self.model.d_model, device=self.device) context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-9  \expnd0\expndtw0 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq,\expnd-1\expndtw-4  \expnd0\expndtw0 info\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 self.model.solver.solve(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_init,\expnd-2\expndtw-8  \expnd0\expndtw0 context,\expnd-1\expndtw-7  \expnd0\expndtw-2 self.model.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb37\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-16  \expnd0\expndtw0 not\expnd-3\expndtw-15  \expnd0\expndtw0 info['converged']: \expnd0\expndtw-2 continue\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Test\expnd-3\expndtw-15  \expnd0\expndtw0 stability\expnd-3\expndtw-15  \expnd0\expndtw0 with\expnd-3\expndtw-16  \expnd0\expndtw0 perturbations is_stable = True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5088\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 _\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_perturbations): # Small perturbation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 epsilon\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  0.01\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 perturbation\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 epsilon\expnd-2\expndtw-10  \expnd0\expndtw0 *\expnd-2\expndtw-10  \expnd0\expndtw0 torch.randn_like(z_eq) z_perturbed = z_eq + perturbation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Re-\expnd0\expndtw-2 converge\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\fi-245\ri2968\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_reconverged, _ = self.model.solver.solve( z_perturbed,\expnd-3\expndtw-16  \expnd0\expndtw0 context,\expnd-3\expndtw-15  \expnd0\expndtw0 self.model.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Check if returns to same fixed point distance\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.norm(z_reconverged\expnd-2\expndtw-11  \expnd0\expndtw0 -\expnd-2\expndtw-11  \expnd0\expndtw0 z_eq)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\fi-245\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-5  \expnd0\expndtw0 distance\expnd-1\expndtw-5  \expnd0\expndtw0 >\expnd-1\expndtw-5  \expnd0\expndtw0 0.1:\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 Threshold\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 "different"\expnd-1\expndtw-5  \expnd0\expndtw0 fixed\expnd-1\expndtw-5  \expnd0\expndtw0 point is_stable = False\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri6436\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if is_stable: stable_count\expnd-3\expndtw-16  \expnd0\expndtw0 +=\expnd-3\expndtw-15  \expnd0\expndtw0 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4103\sl-582\sb31\f2\fs22\b0\expnd0\expndtw0\charscalex100 stability_rate\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 stable_count\expnd-2\expndtw-11  \expnd0\expndtw0 /\expnd-2\expndtw-11  \expnd0\expndtw0 num_fixed_points print(f"Stable fixed points: \'7Bstability_rate:.1%\'7D") return \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl-221\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'stability_rate':\expnd3\expndtw17  \expnd0\expndtw-2 stability_rate,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'is_stable':\expnd-2\expndtw-9  \expnd0\expndtw0 stability_rate\expnd-2\expndtw-9  \expnd0\expndtw0 >\expnd-2\expndtw-9  \expnd-1\expndtw-5 0.8\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4103\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 test_lyapunov_function(self,\expnd-3\expndtw-15  \expnd0\expndtw0 num_samples=50): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Verify\expnd-2\expndtw-11  \expnd0\expndtw0 energy\expnd-2\expndtw-9  \expnd0\expndtw0 function\expnd-2\expndtw-9  \expnd0\expndtw0 acts\expnd-2\expndtw-9  \expnd0\expndtw0 as\expnd-2\expndtw-9  \expnd0\expndtw0 Lyapunov\expnd-2\expndtw-9  \expnd0\expndtw-2 function.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Properties:\par\pard\plain\s2\ls14\ilvl0\nooverflow\nocwrap\lnbrkrule\li830\fi-242\sl240\slmult1\sb38\tx830\f2\fs22\b0\expnd0\expndtw0\charscalex100 E(z*)\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw0 minimized\expnd-1\expndtw-4  \expnd0\expndtw0 at\expnd-1\expndtw-5  \expnd0\expndtw0 fixed\expnd-1\expndtw-4  \expnd0\expndtw-2 points\par\pard\plain\s2\ls14\ilvl0\nooverflow\nocwrap\lnbrkrule\li588\ri4062\sl276\slmult1\sb37\tx830\f2\fs22\b0\expnd0\expndtw0\charscalex100 dE/dt\expnd-1\expndtw-6  \expnd0\expndtw0 <\expnd-1\expndtw-6  \expnd0\expndtw0 0\expnd-1\expndtw-6  \expnd0\expndtw0 along\expnd-1\expndtw-6  \expnd0\expndtw0 trajectories\expnd-1\expndtw-6  \expnd0\expndtw0 (except\expnd-1\expndtw-6  \expnd0\expndtw0 at\expnd-1\expndtw-6  \expnd0\expndtw0 equilibria) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("Testing\expnd-2\expndtw-10  \expnd0\expndtw-2 Lyapunov\expnd-2\expndtw-10  \expnd0\expndtw-2 property...") \expnd0\expndtw0 lyapunov_satisfied = 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5214\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 _\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(num_samples)): # Random trajectory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Iterate\expnd-2\expndtw-9  \expnd0\expndtw0 and\expnd-2\expndtw-9  \expnd0\expndtw0 track\expnd-2\expndtw-9  \expnd0\expndtw0 energy\expnd-2\expndtw-9  \expnd0\expndtw0 changes is_lyapunov = True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd0\expndtw-2  \expnd0\expndtw0 _\expnd0\expndtw-2  \expnd0\expndtw0 in\expnd0\expndtw-2  range(20):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.dynamics(z,\expnd-2\expndtw-9  \expnd0\expndtw0 context,\expnd-2\expndtw-9  \expnd0\expndtw-2 self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri256\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_current, _ = self.model.energy_fn(z, z_next, self.model.memory_patterns) E_next,\expnd-2\expndtw-9  \expnd0\expndtw0 _\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.energy_fn(z_next,\expnd-2\expndtw-9  \expnd0\expndtw0 z_next,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri5397\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Check\expnd-1\expndtw-4  \expnd0\expndtw0 if\expnd-1\expndtw-4  \expnd0\expndtw0 energy\expnd-1\expndtw-4  \expnd0\expndtw0 decreases if\expnd-1\expndtw-5  \expnd0\expndtw0 E_next\expnd-1\expndtw-4  \expnd0\expndtw0 >\expnd-1\expndtw-5  \expnd0\expndtw0 E_current\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 1e-\expnd-1\expndtw-5 4:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 is_lyapunov\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 False \expnd0\expndtw-2 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Stop\expnd-1\expndtw-5  \expnd0\expndtw0 if\expnd-1\expndtw-5  \expnd0\expndtw0 converged\expnd-1\expndtw-5  \expnd0\expndtw0 (dE\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u8776 ?\expnd-1\expndtw-5  \expnd0\expndtw0 0\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw0 OK\expnd-1\expndtw-5  \expnd0\expndtw0 at\expnd-1\expndtw-5  \expnd0\expndtw0 equilibrium) if torch.norm(z_next - z) < 1e-3:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi244\ri7087\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 z = z_next\expnd8\expndtw40  \expnd0\expndtw0 if\expnd-3\expndtw-16  \expnd0\expndtw0 is_lyapunov:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 lyapunov_satisfied\expnd-2\expndtw-10  \expnd0\expndtw0 +=\expnd-2\expndtw-10  1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 lyapunov_rate = lyapunov_satisfied / num_samples print(f"Lyapunov\expnd-3\expndtw-16  \expnd0\expndtw0 property\expnd-3\expndtw-15  \expnd0\expndtw0 satisfied:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Blyapunov_rate:.1%\'7D")\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'lyapunov_rate': lyapunov_rate, 'is_lyapunov':\expnd-3\expndtw-13  \expnd0\expndtw0 lyapunov_rate\expnd-3\expndtw-13  \expnd0\expndtw0 >\expnd-3\expndtw-13  \expnd0\expndtw0 0.9\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri7048\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 run_all_tests(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4572\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Run\expnd-2\expndtw-10  \expnd0\expndtw0 complete\expnd-2\expndtw-11  \expnd0\expndtw0 convergence\expnd-2\expndtw-10  \expnd0\expndtw0 validation\expnd-2\expndtw-11  \expnd0\expndtw0 suite. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("="*50)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("CONVERGENCE VALIDATION SUITE")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri7378\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("="*50) \expnd0\expndtw0 results = \'7B\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 results['contraction'] = self.test_contraction_property() results['energy_descent']\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.test_energy_descent() results['stability'] = self.test_fixed_point_stability() results['lyapunov'] = self.test_lyapunov_function()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Overall\expnd-3\expndtw-15  \expnd0\expndtw0 assessment all_pass = (\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3761\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 results['contraction']['is_contraction'] and results['energy_descent']['monotonic_descent']\expnd-3\expndtw-16  \expnd0\expndtw0 and results['stability']['is_stable'] and \expnd0\expndtw-2 results['lyapunov']['is_lyapunov']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw360\colsr128\colno2\colw9072\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb245\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6005\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 print("\'5Cn" + "="*50) \expnd0\expndtw-2 print("SUMMARY") print("="*50)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-268\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Contraction:\expnd-3\expndtw-13  \expnd0\expndtw0 \'7B'\f3 \uc1\u10003 ?\f2 '\expnd-3\expndtw-13  \expnd0\expndtw0 if\expnd-3\expndtw-13  \expnd0\expndtw0 results['contraction']['is_contraction']\expnd-3\expndtw-13  \expnd0\expndtw0 else\expnd-2\expndtw-12  \expnd-2\expndtw-10 '\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb20\f3\fs22\b0\expnd0\expndtw-2\charscalex100 \uc1\u10007 ?\f2 \'92\'7D\'94)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl244\slmult1\sb5\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f\'94Energy\expnd-1\expndtw-6  \expnd0\expndtw0 Descent:\expnd-1\expndtw-6  \expnd0\expndtw0 \'7B\'91\f3 \uc1\u10003 ?\f2 \'92\expnd-1\expndtw-6  \expnd0\expndtw0 if\expnd-1\expndtw-6  \expnd0\expndtw0 results[\'91energy_descent\'92][\'91monotonic_descent\'92]\expnd-1\expndtw-6  \expnd0\expndtw0 else\expnd-1\expndtw-6  \expnd0\expndtw0 \'91\f3 \uc1\u10007 ?\f2 \'92\'7D\'94) print(f\'94Stability: \'7B\'91\f3 \uc1\u10003 ?\f2 \'92 if results[\'91stability\'92][\'91is_stable\'92] else \'91\f3 \uc1\u10007 ?\f2 \'92\'7D\'94)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-284\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f\'94Lyapunov:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7B\'91\f3 \uc1\u10003 ?\f2 \'92\expnd-3\expndtw-13  \expnd0\expndtw0 if\expnd-2\expndtw-12  \expnd0\expndtw0 results[\'91lyapunov\'92][\'91is_lyapunov\'92]\expnd-3\expndtw-13  \expnd0\expndtw0 else\expnd-2\expndtw-12  \expnd0\expndtw-2 \'91\f3 \uc1\u10007 ?\f2 \'92\'7D\'94)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl259\slmult1\sb5\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f\'94\'5CnOverall:\expnd-1\expndtw-7  \expnd0\expndtw0 \'7B\'91\f3 \uc1\u10003 ?\expnd-2\expndtw-8  \f2\expnd0\expndtw0 ALL\expnd-1\expndtw-7  \expnd0\expndtw0 TESTS\expnd-1\expndtw-7  \expnd0\expndtw0 PASSED\'92\expnd-1\expndtw-7  \expnd0\expndtw0 if\expnd-1\expndtw-7  \expnd0\expndtw0 all_pass\expnd-1\expndtw-7  \expnd0\expndtw0 else\expnd-1\expndtw-7  \expnd0\expndtw0 \'91\f3 \uc1\u10007 ?\expnd-2\expndtw-8  \f2\expnd0\expndtw0 SOME\expnd-1\expndtw-7  \expnd0\expndtw0 TESTS\expnd-1\expndtw-7  \expnd0\expndtw0 FAILED\'92\'7D\'94) \expnd0\expndtw-2 print(\'94=\'94*50)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb8\f2\fs18\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb93\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb131 \column \f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 results\par\sect\sectd\sbkpage\margtsxn1660\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb71\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 --\expnd-2\expndtw-12 -\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-8  \expnd0\expndtw0 **Step\expnd-2\expndtw-8  \expnd0\expndtw0 6.2:\expnd-1\expndtw-7  \expnd0\expndtw0 Energy\expnd-2\expndtw-8  \expnd0\expndtw0 Landscape\expnd-2\expndtw-8  \expnd0\expndtw0 Visualization\expnd-1\expndtw-7  \expnd0\expndtw-2 (experiments/theory/energy_analysis.py)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6204\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 EnergyLandscapeAnalyzer: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Visualize\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 analyze\expnd-1\expndtw-6  \expnd0\expndtw0 the\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 landscape\expnd-1\expndtw-6  \expnd0\expndtw0 of\expnd-1\expndtw-6  \expnd0\expndtw0 the\expnd-1\expndtw-6  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw-2 model.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Creates\expnd-2\expndtw-10  \expnd0\expndtw0 interactive\expnd-2\expndtw-9  \expnd0\expndtw0 2D/3D\expnd-2\expndtw-9  \expnd0\expndtw0 visualizations\expnd-2\expndtw-9  \expnd-1\expndtw-5 of:\par\pard\plain\s2\ls15\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-1\expndtw-7  \expnd0\expndtw0 surface\expnd-1\expndtw-6  \expnd0\expndtw0 around\expnd-1\expndtw-6  \expnd0\expndtw-2 equilibria\par\pard\plain\s2\ls15\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Basin\expnd-1\expndtw-4  \expnd0\expndtw0 of\expnd-1\expndtw-3  \expnd0\expndtw-2 attraction\par\pard\plain\s2\ls15\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Convergence\expnd-2\expndtw-11  \expnd0\expndtw-2 trajectories\par\pard\plain\s2\ls15\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri6170\sl276\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Memory\expnd-3\expndtw-16  \expnd0\expndtw0 pattern\expnd-3\expndtw-15  \expnd0\expndtw0 organization \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-1\expndtw-5  \f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 (self,\expnd-1\expndtw-5  \expnd0\expndtw0 model,\expnd-1\expndtw-5  \expnd0\expndtw0 device='cuda'): self.model = model.to(device) self.device = device\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1688\fi-1344\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 visualize_2d_slice(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z_equilibrium,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 basis_vectors=None, resolution=50, radius=2.0):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Visualize\expnd-2\expndtw-8  \expnd0\expndtw0 2D\expnd-1\expndtw-6  \expnd0\expndtw0 slice\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 landscape\expnd-1\expndtw-5  \expnd0\expndtw0 around\expnd-1\expndtw-6  \expnd0\expndtw0 an\expnd-1\expndtw-5  \expnd0\expndtw-2 equilibrium.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Args:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_equilibrium:\expnd-2\expndtw-8  \expnd0\expndtw0 Equilibrium\expnd-2\expndtw-8  \expnd0\expndtw0 point\expnd-2\expndtw-8  \expnd0\expndtw0 to\expnd-2\expndtw-8  \expnd0\expndtw0 center\expnd-2\expndtw-8  \expnd0\expndtw0 on context: Input context\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 basis_vectors:\expnd-1\expndtw-5  \expnd0\expndtw0 (v1,\expnd-1\expndtw-5  \expnd0\expndtw0 v2)\expnd-1\expndtw-5  \expnd0\expndtw0 directions\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 span,\expnd-1\expndtw-5  \expnd0\expndtw0 or\expnd-1\expndtw-5  \expnd0\expndtw0 None\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 PCA resolution: Grid resolution\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 radius:\expnd-1\expndtw-5  \expnd0\expndtw0 How\expnd-1\expndtw-4  \expnd0\expndtw0 far\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 explore\expnd-1\expndtw-4  \expnd0\expndtw0 from\expnd-1\expndtw-4  \expnd0\expndtw-2 equilibrium\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Computing\expnd-2\expndtw-8  \expnd0\expndtw0 2D\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw-2 slice...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-6  \expnd0\expndtw0 basis_vectors\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw-2 None:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2377\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Use\expnd-1\expndtw-5  \expnd0\expndtw0 PCA\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-5  \expnd0\expndtw0 patterns\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 get\expnd-1\expndtw-5  \expnd0\expndtw0 meaningful\expnd-1\expndtw-5  \expnd0\expndtw0 directions patterns = self.model.memory_patterns.cpu().numpy()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 pca\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 PCA(n_components=2) \expnd0\expndtw-2 pca.fit(patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri861\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 v1\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.tensor(pca.components_[0],\expnd-2\expndtw-11  \expnd0\expndtw0 device=self.device,\expnd-2\expndtw-11  \expnd0\expndtw0 dtype=torch.float32) v2\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 torch.tensor(pca.components_[1],\expnd-3\expndtw-14  \expnd0\expndtw0 device=self.device,\expnd-3\expndtw-13  \expnd0\expndtw-2 dtype=torch.float32)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 else:\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 v1,\expnd0\expndtw-2  \expnd0\expndtw0 v2\expnd0\expndtw-2  \expnd0\expndtw0 =\expnd0\expndtw-2  basis_vectors\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Create\expnd-1\expndtw-3  \expnd-1\expndtw-4 grid\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4425\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 alpha\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 np.linspace(-radius,\expnd-2\expndtw-10  \expnd0\expndtw0 radius,\expnd-2\expndtw-10  \expnd0\expndtw0 resolution) beta = np.linspace(-radius, radius, resolution) A, B = np.meshgrid(alpha, beta)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5224\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Compute\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw0 at\expnd-1\expndtw-7  \expnd0\expndtw0 each\expnd-1\expndtw-7  \expnd0\expndtw0 grid\expnd-1\expndtw-7  \expnd0\expndtw0 point energies = np.zeros_like(A) fp_residuals = np.zeros_like(A)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5634\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 i\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(resolution)): for j in range(resolution):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Point\expnd-1\expndtw-3  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw0 state\expnd-1\expndtw-3  \expnd0\expndtw-2 space\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri4180\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 z_equilibrium\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 A[i,\expnd-1\expndtw-4  \expnd0\expndtw0 j]\expnd-1\expndtw-4  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 v1\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 B[i,\expnd-1\expndtw-4  \expnd0\expndtw0 j]\expnd-1\expndtw-4  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 v2 z = z.unsqueeze(0)\expnd8\expndtw40  \expnd0\expndtw0 # Add batch dim\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Compute\expnd-1\expndtw-5  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw-2 energy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri1217\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.dynamics(z,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.memory_patterns) E, _ = self.model.energy_fn(z, z_next, self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 energies[i,\expnd-1\expndtw-5  \expnd0\expndtw0 j]\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw-2 E.item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fp_residuals[i,\expnd-1\expndtw-7  \expnd0\expndtw0 j]\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 torch.norm(z\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw-2 z_next).item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6204\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Create\expnd-2\expndtw-10  \expnd0\expndtw0 interactive\expnd-2\expndtw-10  \expnd0\expndtw0 3D\expnd-2\expndtw-10  \expnd0\expndtw0 plot fig = go.Figure()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Energy surface \expnd0\expndtw-2 fig.add_trace(go.Surface(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 x=A,\expnd-3\expndtw-16  \expnd0\expndtw0 y=B,\expnd-3\expndtw-15  \expnd0\expndtw0 z=energies, \expnd0\expndtw-2 colorscale='Viridis', name='Energy', showscale=True, opacity=0.9\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Mark equilibrium \expnd0\expndtw-2 fig.add_trace(go.Scatter3d(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 x=[0],\expnd-3\expndtw-14  \expnd0\expndtw0 y=[0],\expnd-3\expndtw-14  \expnd0\expndtw0 z=[energies[resolution//2,\expnd-3\expndtw-14  \expnd0\expndtw0 resolution//2]], \expnd0\expndtw-2 mode='markers',\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5467\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 marker=dict(size=10,\expnd-3\expndtw-16  \expnd0\expndtw0 color='red'), \expnd0\expndtw-2 name='Equilibrium'\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ))\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw-2\charscalex100 fig.update_layout(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 title='Energy\expnd-3\expndtw-14  \expnd0\expndtw0 Landscape\expnd-3\expndtw-14  \expnd0\expndtw0 (2D\expnd-3\expndtw-14  \expnd0\expndtw0 Slice)', \expnd0\expndtw-2 scene=dict(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 xaxis_title='Direction\expnd4\expndtw22  \expnd-1\expndtw-5 1',\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri6187\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 yaxis_title='Direction\expnd-3\expndtw-16  \expnd0\expndtw0 2', \expnd0\expndtw-2 zaxis_title='Energy'\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ),\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri7378\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 width=900, height=700\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 fig.write_html('energy_landscape_2d.html') \expnd0\expndtw0 print("Saved\expnd-3\expndtw-16  \expnd0\expndtw0 to\expnd-3\expndtw-15  \expnd0\expndtw0 energy_landscape_2d.html")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Also\expnd-1\expndtw-5  \expnd0\expndtw0 plot\expnd-1\expndtw-5  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-5  \expnd0\expndtw-2 residuals\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fig2,\expnd-1\expndtw-7  \expnd0\expndtw0 (ax1,\expnd-1\expndtw-6  \expnd0\expndtw0 ax2)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 plt.subplots(1,\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 figsize=(14,\expnd-1\expndtw-6  \expnd-1\expndtw-5 6))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 im1\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 ax1.contourf(A,\expnd-1\expndtw-7  \expnd0\expndtw0 B,\expnd-1\expndtw-7  \expnd0\expndtw0 energies,\expnd-1\expndtw-7  \expnd0\expndtw0 levels=20,\expnd-1\expndtw-7  \expnd0\expndtw0 cmap='viridis') ax1.set_title('Energy Landscape')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax1.set_xlabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax1.set_ylabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 2')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.plot(0,\expnd-2\expndtw-11  \expnd0\expndtw0 0,\expnd-2\expndtw-11  \expnd0\expndtw0 'r*',\expnd-2\expndtw-11  \expnd0\expndtw0 markersize=15,\expnd-2\expndtw-11  \expnd0\expndtw0 label='Equilibrium') \expnd0\expndtw-2 ax1.legend()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.colorbar(im1,\expnd3\expndtw17  \expnd0\expndtw-2 ax=ax1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2647\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 im2\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 ax2.contourf(A,\expnd-1\expndtw-7  \expnd0\expndtw0 B,\expnd-1\expndtw-7  \expnd0\expndtw0 fp_residuals,\expnd-1\expndtw-7  \expnd0\expndtw0 levels=20,\expnd-1\expndtw-7  \expnd0\expndtw0 cmap='plasma') ax2.set_title('Fixed-Point Residual')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax2.set_xlabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax2.set_ylabel('Direction 2') ax2.plot(0,\expnd-3\expndtw-14  \expnd0\expndtw0 0,\expnd-3\expndtw-14  \expnd0\expndtw0 'r*',\expnd-3\expndtw-14  \expnd0\expndtw0 markersize=15) plt.colorbar(im2, ax=ax2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3643\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.tight_layout() \expnd0\expndtw0 plt.savefig('energy_landscape_contours.png',\expnd-3\expndtw-16  \expnd0\expndtw0 dpi=150) print("Saved to energy_landscape_contours.png")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-2\expndtw-8  \expnd0\expndtw0 energies,\expnd-1\expndtw-7  \expnd0\expndtw-2 fp_residuals\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri1159\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-15  \expnd0\expndtw0 visualize_convergence_trajectories(self,\expnd-3\expndtw-15  \expnd0\expndtw0 num_trajectories=10,\expnd-3\expndtw-15  \expnd0\expndtw0 num_steps=50): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Visualize\expnd-2\expndtw-8  \expnd0\expndtw0 multiple\expnd-2\expndtw-8  \expnd0\expndtw0 convergence\expnd-2\expndtw-8  \expnd0\expndtw0 trajectories\expnd-2\expndtw-8  \expnd0\expndtw0 in\expnd-2\expndtw-8  \expnd0\expndtw0 state\expnd-2\expndtw-8  \expnd0\expndtw0 space. Projects high-dimensional trajectories to 2D using PCA.\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Computing\expnd-3\expndtw-14  \expnd0\expndtw0 convergence\expnd-3\expndtw-13  \expnd0\expndtw-2 trajectories...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 trajectories = [] energies_list\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri4957\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 _\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(num_trajectories)): # Random initialization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 traj\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 [z.cpu().numpy().flatten()] energies = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-1\expndtw-3  \expnd0\expndtw0 step\expnd-1\expndtw-3  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw-2 range(num_steps):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri1217\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.dynamics(z,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.memory_patterns) E, _ = self.model.energy_fn(z, z_next, self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 traj.append(z_next.cpu().numpy().flatten()) energies.append(E.item())\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Stop\expnd0\expndtw-2  \expnd0\expndtw0 if\expnd0\expndtw-2  converged\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\fi-245\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-2\expndtw-8  \expnd0\expndtw0 torch.norm(z_next\expnd-2\expndtw-8  \expnd0\expndtw0 -\expnd-2\expndtw-8  \expnd0\expndtw0 z)\expnd-2\expndtw-8  \expnd0\expndtw0 <\expnd-2\expndtw-8  \expnd0\expndtw0 1e-4: \expnd0\expndtw-2 break\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd0\expndtw-1  \expnd0\expndtw0 =\expnd0\expndtw-1  \expnd0\expndtw-2 z_next\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 trajectories.append(np.array(traj)) energies_list.append(energies)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5506\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Project to 2D using PCA all_points\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 np.vstack(trajectories) pca = PCA(n_components=2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 all_points_2d\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw-2 pca.fit_transform(all_points)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Split\expnd-2\expndtw-10  \expnd0\expndtw0 back\expnd-2\expndtw-10  \expnd0\expndtw0 into\expnd-2\expndtw-10  \expnd0\expndtw0 trajectories trajectories_2d = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 idx\expnd0\expndtw-2  \expnd0\expndtw0 =\expnd0\expndtw-2  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6547\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 traj\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 trajectories: traj_len = len(traj)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3492\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 trajectories_2d.append(all_points_2d[idx:idx+traj_len]) \expnd0\expndtw0 idx += traj_len\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd-1\expndtw-4 Plot\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fig,\expnd-1\expndtw-7  \expnd0\expndtw0 (ax1,\expnd-1\expndtw-6  \expnd0\expndtw0 ax2)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 plt.subplots(1,\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 figsize=(16,\expnd-1\expndtw-6  \expnd-1\expndtw-5 7))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6009\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw0 Trajectories\expnd0\expndtw-1  \expnd0\expndtw0 in\expnd0\expndtw-1  \expnd0\expndtw0 state\expnd0\expndtw-1  \expnd0\expndtw0 space for\expnd-3\expndtw-14  \expnd0\expndtw0 traj_2d\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 trajectories_2d:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2543\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.plot(traj_2d[:,\expnd-1\expndtw-7  \expnd0\expndtw0 0],\expnd-1\expndtw-7  \expnd0\expndtw0 traj_2d[:,\expnd-1\expndtw-7  \expnd0\expndtw0 1],\expnd-1\expndtw-7  \expnd0\expndtw0 'o-',\expnd-1\expndtw-7  \expnd0\expndtw0 alpha=0.6,\expnd-1\expndtw-7  \expnd0\expndtw0 markersize=3) ax1.plot(traj_2d[0, 0], traj_2d[0, 1], 'go', markersize=8)\expnd8\expndtw40  \expnd0\expndtw0 # Start ax1.plot(traj_2d[-1, 0], traj_2d[-1, 1], 'r*', markersize=12)\expnd8\expndtw40  \expnd0\expndtw0 # End\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.set_title('Convergence\expnd-3\expndtw-16  \expnd0\expndtw0 Trajectories\expnd-3\expndtw-15  \expnd0\expndtw0 (PCA\expnd-3\expndtw-15  \expnd0\expndtw0 projection)') \expnd0\expndtw-2 ax1.set_xlabel('PC1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax1.set_ylabel('PC2')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.legend(['Trajectories',\expnd-3\expndtw-16  \expnd0\expndtw0 'Start',\expnd-3\expndtw-15  \expnd0\expndtw0 'Equilibrium'],\expnd-3\expndtw-15  \expnd0\expndtw0 loc='best') ax1.grid(True, alpha=0.3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Energy\expnd-1\expndtw-3  \expnd0\expndtw0 vs\expnd-1\expndtw-3  \expnd0\expndtw-2 iteration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5868\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for energies in energies_list: ax2.plot(energies,\expnd-3\expndtw-16  \expnd0\expndtw0 alpha=0.6)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax2.set_title('Energy\expnd-3\expndtw-16  \expnd0\expndtw0 During\expnd-3\expndtw-15  \expnd0\expndtw0 Convergence') \expnd0\expndtw-2 ax2.set_xlabel('Iteration') ax2.set_ylabel('Energy')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax2.grid(True,\expnd1\expndtw6  \expnd0\expndtw-2 alpha=0.3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3949\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.tight_layout() \expnd0\expndtw0 plt.savefig('convergence_trajectories.png',\expnd-3\expndtw-16  \expnd0\expndtw0 dpi=150) print("Saved to convergence_trajectories.png")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-2\expndtw-11  \expnd0\expndtw0 trajectories_2d,\expnd-2\expndtw-11  \expnd0\expndtw-2 energies_list\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 def\expnd3\expndtw15  \expnd0\expndtw-2 visualize_basin_of_attraction(self,\expnd3\expndtw17  \expnd0\expndtw-2 z_equilibrium,\expnd4\expndtw18  \expnd0\expndtw-2 context,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li2359\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 resolution=30,\expnd-3\expndtw-14  \expnd0\expndtw-2 radius=3.0):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Identify\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 visualize\expnd-1\expndtw-5  \expnd0\expndtw0 basin\expnd-1\expndtw-6  \expnd0\expndtw0 of\expnd-1\expndtw-6  \expnd0\expndtw0 attraction\expnd-1\expndtw-5  \expnd0\expndtw0 around\expnd-1\expndtw-6  \expnd0\expndtw0 an\expnd-1\expndtw-5  \expnd0\expndtw-2 equilibrium.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1578\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Sample\expnd-1\expndtw-4  \expnd0\expndtw0 points\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 region\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw0 color\expnd-1\expndtw-4  \expnd0\expndtw0 by\expnd-1\expndtw-4  \expnd0\expndtw0 which\expnd-1\expndtw-4  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-4  \expnd0\expndtw0 they\expnd-1\expndtw-4  \expnd0\expndtw0 converge\expnd-1\expndtw-4  \expnd0\expndtw0 to. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Analyzing\expnd-2\expndtw-8  \expnd0\expndtw0 basin\expnd-2\expndtw-8  \expnd0\expndtw0 of\expnd-1\expndtw-7  \expnd0\expndtw-2 attraction...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Get\expnd-1\expndtw-4  \expnd0\expndtw0 two\expnd-1\expndtw-4  \expnd0\expndtw0 principal\expnd-1\expndtw-4  \expnd0\expndtw-2 directions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3649\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 patterns\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.model.memory_patterns.cpu().numpy() pca = PCA(n_components=2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 pca.fit(patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 v1\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 torch.tensor(pca.components_[0],\expnd-3\expndtw-14  \expnd0\expndtw0 device=self.device,\expnd-3\expndtw-13  \expnd0\expndtw-2 dtype=torch.float32)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 v2\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-13  \expnd0\expndtw0 torch.tensor(pca.components_[1],\expnd-3\expndtw-14  \expnd0\expndtw0 device=self.device,\expnd-3\expndtw-13  \expnd0\expndtw-2 dtype=torch.float32)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Create\expnd-1\expndtw-3  \expnd-1\expndtw-4 grid\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4425\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 alpha\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 np.linspace(-radius,\expnd-2\expndtw-10  \expnd0\expndtw0 radius,\expnd-2\expndtw-10  \expnd0\expndtw0 resolution) beta = np.linspace(-radius, radius, resolution) A, B = np.meshgrid(alpha, beta)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3971\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Track\expnd-1\expndtw-7  \expnd0\expndtw0 which\expnd-1\expndtw-7  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-7  \expnd0\expndtw0 each\expnd-1\expndtw-7  \expnd0\expndtw0 point\expnd-1\expndtw-7  \expnd0\expndtw0 converges\expnd-1\expndtw-7  \expnd0\expndtw0 to convergence_map = np.zeros_like(A) final_energies = np.zeros_like(A)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5634\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 i\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(resolution)): for j in range(resolution):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Initial\expnd-1\expndtw-4  \expnd0\expndtw-2 point\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_init\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 z_equilibrium\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 A[i,\expnd-1\expndtw-4  \expnd0\expndtw0 j]\expnd-1\expndtw-4  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 v1\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 B[i,\expnd-1\expndtw-4  \expnd0\expndtw0 j]\expnd-1\expndtw-4  \expnd0\expndtw0 *\expnd-1\expndtw-4  \expnd0\expndtw0 v2 z_init = z_init.unsqueeze(0)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Converge\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_final,\expnd-1\expndtw-5  \expnd0\expndtw0 info\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw-2 self.model.solver.solve(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_init,\expnd-2\expndtw-8  \expnd0\expndtw0 context,\expnd-1\expndtw-7  \expnd0\expndtw-2 self.model.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Store\expnd-1\expndtw-3  \expnd0\expndtw-2 results\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 convergence_map[i,\expnd-1\expndtw-6  \expnd0\expndtw0 j]\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 1\expnd-1\expndtw-6  \expnd0\expndtw0 if\expnd-1\expndtw-6  \expnd0\expndtw0 info['converged']\expnd-1\expndtw-6  \expnd0\expndtw0 else\expnd-1\expndtw-6  \expnd0\expndtw0 0 final_energies[i, j] = info['final_energy']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Visualize\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fig,\expnd-1\expndtw-7  \expnd0\expndtw0 (ax1,\expnd-1\expndtw-6  \expnd0\expndtw0 ax2)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 plt.subplots(1,\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 figsize=(14,\expnd-1\expndtw-6  \expnd-1\expndtw-5 6))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Convergence\expnd-1\expndtw-6  \expnd0\expndtw0 success\expnd-1\expndtw-6  \expnd-1\expndtw-5 map\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1749\fi-1161\ri2627\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 im1\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 ax1.contourf(A,\expnd-1\expndtw-6  \expnd0\expndtw0 B,\expnd-1\expndtw-6  \expnd0\expndtw0 convergence_map,\expnd-1\expndtw-6  \expnd0\expndtw0 levels=[0,\expnd-1\expndtw-6  \expnd0\expndtw0 0.5,\expnd-1\expndtw-6  \expnd0\expndtw0 1], colors=['red', 'green'], alpha=0.6)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.set_title('Basin\expnd-1\expndtw-7  \expnd0\expndtw0 of\expnd-1\expndtw-7  \expnd0\expndtw0 Attraction\'5Cn(Green\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 Converged,\expnd-1\expndtw-7  \expnd0\expndtw0 Red\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 Failed)') ax1.set_xlabel('Direction 1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax1.set_ylabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 2')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.plot(0,\expnd-3\expndtw-14  \expnd0\expndtw0 0,\expnd-3\expndtw-14  \expnd0\expndtw0 'k*',\expnd-3\expndtw-14  \expnd0\expndtw0 markersize=15,\expnd-3\expndtw-14  \expnd0\expndtw0 label='Target\expnd-3\expndtw-14  \expnd0\expndtw0 Equilibrium') \expnd0\expndtw-2 ax1.legend()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Final\expnd-1\expndtw-4  \expnd0\expndtw0 energy\expnd-1\expndtw-4  \expnd-1\expndtw-5 map\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1159\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 im2\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 ax2.contourf(A,\expnd-1\expndtw-7  \expnd0\expndtw0 B,\expnd-1\expndtw-7  \expnd0\expndtw0 final_energies,\expnd-1\expndtw-7  \expnd0\expndtw0 levels=20,\expnd-1\expndtw-7  \expnd0\expndtw0 cmap='viridis') ax2.set_title('Final Energy Values')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax2.set_xlabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax2.set_ylabel('Direction\expnd5\expndtw25  \expnd-1\expndtw-5 2')\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax2.plot(0,\expnd-3\expndtw-14  \expnd0\expndtw0 0,\expnd-3\expndtw-14  \expnd0\expndtw0 'r*',\expnd-3\expndtw-14  \expnd0\expndtw0 markersize=15) plt.colorbar(im2, ax=ax2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4548\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.tight_layout() \expnd0\expndtw0 plt.savefig('basin_of_attraction.png',\expnd-3\expndtw-16  \expnd0\expndtw0 dpi=150) print("Saved to basin_of_attraction.png")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Statistics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 convergence_rate\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-8  \expnd0\expndtw-2 convergence_map.mean()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1939\sl552\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Convergence\expnd-2\expndtw-9  \expnd0\expndtw0 rate\expnd-2\expndtw-9  \expnd0\expndtw0 in\expnd-2\expndtw-9  \expnd0\expndtw0 explored\expnd-2\expndtw-9  \expnd0\expndtw0 region:\expnd-2\expndtw-9  \expnd0\expndtw0 \'7Bconvergence_rate:.1%\'7D") return convergence_map, final_energies\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5214\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 visualize_memory_organization(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Visualize\expnd-1\expndtw-7  \expnd0\expndtw0 how\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-6  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw0 organized\expnd-1\expndtw-6  \expnd0\expndtw0 in\expnd-1\expndtw-6  \expnd0\expndtw0 state\expnd-1\expndtw-6  \expnd0\expndtw-2 space.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4347\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-1\expndtw-5  \expnd0\expndtw0 t-SNE\expnd-1\expndtw-5  \expnd0\expndtw0 or\expnd-1\expndtw-5  \expnd0\expndtw0 UMAP\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 project\expnd-1\expndtw-5  \expnd0\expndtw0 patterns\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 2D. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Visualizing\expnd-3\expndtw-14  \expnd0\expndtw0 memory\expnd-3\expndtw-14  \expnd0\expndtw-2 organization...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3649\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 patterns\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.model.memory_patterns.cpu().numpy() # Dimensionality reduction\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb40\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-9  \expnd0\expndtw0 sklearn.manifold\expnd-2\expndtw-9  \expnd0\expndtw0 import\expnd-2\expndtw-8  \expnd-1\expndtw-4 TSNE\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 tsne\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 TSNE(n_components=2,\expnd-3\expndtw-14  \expnd0\expndtw0 random_state=42) patterns_2d = tsne.fit_transform(patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-14  \expnd0\expndtw0 Compute\expnd-3\expndtw-14  \expnd0\expndtw0 pairwise\expnd-3\expndtw-14  \expnd0\expndtw0 similarities with torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 similarities = torch.matmul( \expnd0\expndtw-2 self.model.memory_patterns, self.model.memory_patterns.T\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ).cpu().numpy()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd-1\expndtw-4 Plot\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 fig,\expnd-1\expndtw-7  \expnd0\expndtw0 (ax1,\expnd-1\expndtw-6  \expnd0\expndtw0 ax2)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 plt.subplots(1,\expnd-1\expndtw-6  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw0 figsize=(16,\expnd-1\expndtw-6  \expnd-1\expndtw-5 7))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Memory\expnd-1\expndtw-5  \expnd0\expndtw0 pattern\expnd-1\expndtw-4  \expnd0\expndtw-2 layout\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1810\fi-1222\ri1159\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 scatter = ax1.scatter(patterns_2d[:, 0], patterns_2d[:, 1], c=np.arange(len(patterns)),\expnd-3\expndtw-16  \expnd0\expndtw0 cmap='tab20',\expnd-3\expndtw-15  \expnd0\expndtw0 alpha=0.6)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3900\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax1.set_title('Memory\expnd-3\expndtw-14  \expnd0\expndtw0 Pattern\expnd-3\expndtw-14  \expnd0\expndtw0 Organization\expnd-3\expndtw-14  \expnd0\expndtw0 (t-SNE)') ax1.set_xlabel('t-SNE 1')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ax1.set_ylabel('t-SNE\expnd4\expndtw21  \expnd-1\expndtw-5 2')\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Similarity\expnd-1\expndtw-5  \expnd0\expndtw-2 matrix\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 im\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 ax2.imshow(similarities,\expnd-2\expndtw-11  \expnd0\expndtw0 cmap='viridis',\expnd-2\expndtw-11  \expnd0\expndtw0 aspect='auto') ax2.set_title('Memory Pattern Similarity Matrix') ax2.set_xlabel('Pattern Index')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6022\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ax2.set_ylabel('Pattern\expnd-3\expndtw-16  \expnd0\expndtw0 Index') plt.colorbar(im, ax=ax2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4291\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.tight_layout() \expnd0\expndtw0 plt.savefig('memory_organization.png',\expnd-3\expndtw-16  \expnd0\expndtw0 dpi=150) print("Saved to memory_organization.png")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Cluster\expnd-1\expndtw-4  \expnd0\expndtw-2 analysis\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from sklearn.cluster import KMeans n_clusters\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 min(10,\expnd-2\expndtw-9  \expnd0\expndtw0 len(patterns)\expnd-2\expndtw-9  \expnd0\expndtw0 //\expnd-2\expndtw-9  \expnd0\expndtw0 100) if n_clusters > 1:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri2377\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 kmeans\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 KMeans(n_clusters=n_clusters,\expnd-3\expndtw-14  \expnd0\expndtw0 random_state=42) clusters = kmeans.fit_predict(patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3643\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\'5CnMemory\expnd-3\expndtw-14  \expnd0\expndtw0 clustering\expnd-3\expndtw-14  \expnd0\expndtw0 (\'7Bn_clusters\'7D\expnd-3\expndtw-14  \expnd0\expndtw0 clusters):") for i in range(n_clusters):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 count\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 (clusters\expnd-1\expndtw-4  \expnd0\expndtw0 ==\expnd-1\expndtw-4  \expnd0\expndtw-2 i).sum()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi488\ri1985\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\expnd8\expndtw40  \expnd0\expndtw0 Cluster\expnd-1\expndtw-7  \expnd0\expndtw0 \'7Bi\'7D:\expnd-1\expndtw-7  \expnd0\expndtw0 \'7Bcount\'7D\expnd-1\expndtw-7  \expnd0\expndtw0 patterns\expnd-1\expndtw-7  \expnd0\expndtw0 (\'7Bcount/len(patterns):.1%\'7D)") return patterns_2d, similarities\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3949\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 analyze_critical_points(self,\expnd-3\expndtw-15  \expnd0\expndtw0 num_samples=100): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Find\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 classify\expnd-1\expndtw-5  \expnd0\expndtw0 critical\expnd-1\expndtw-5  \expnd0\expndtw0 points\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 energy\expnd-1\expndtw-5  \expnd0\expndtw-2 function.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb58\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Critical\expnd-1\expndtw-4  \expnd0\expndtw0 points\expnd-1\expndtw-3  \expnd0\expndtw0 where\expnd-1\expndtw-3  \f3\expnd0\expndtw0 \uc1\u8711 ?\f2 E\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-1\expndtw-5 0:\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\sb23\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Minima\expnd-1\expndtw-7  \expnd0\expndtw0 (stable\expnd-1\expndtw-6  \expnd0\expndtw-2 equilibria)\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Maxima\expnd-1\expndtw-6  \expnd0\expndtw-2 (unstable)\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li588\ri7502\sl276\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Saddle\expnd-3\expndtw-16  \expnd0\expndtw0 points \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Analyzing\expnd-3\expndtw-16  \expnd0\expndtw0 critical\expnd-3\expndtw-15  \expnd0\expndtw0 points...") critical_points = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5214\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-14  \expnd0\expndtw0 _\expnd-3\expndtw-14  \expnd0\expndtw0 in\expnd-3\expndtw-14  \expnd0\expndtw0 tqdm(range(num_samples)): # Random initialization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 context\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-9  \expnd0\expndtw0 10,\expnd-2\expndtw-9  \expnd0\expndtw0 self.model.d_model,\expnd-2\expndtw-8  \expnd0\expndtw-2 device=self.device)\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Converge\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-3  \expnd0\expndtw-2 equilibrium\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq,\expnd-1\expndtw-4  \expnd0\expndtw0 info\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 self.model.solver.solve(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 z,\expnd-1\expndtw-5  \expnd0\expndtw0 context,\expnd-1\expndtw-5  \expnd0\expndtw-2 self.model.memory_patterns\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-3\expndtw-16  \expnd0\expndtw0 not\expnd-3\expndtw-15  \expnd0\expndtw0 info['converged']: \expnd0\expndtw-2 continue\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Compute\expnd-2\expndtw-9  \expnd0\expndtw0 gradient\expnd-2\expndtw-9  \expnd0\expndtw0 norm\expnd-2\expndtw-9  \expnd0\expndtw0 at\expnd-2\expndtw-9  \expnd0\expndtw0 equilibrium grad_norm = torch.norm(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.energy_fn.energy_gradient(z_eq,\expnd8\expndtw40  \expnd0\expndtw-2 self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ).item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3643\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Compute\expnd-2\expndtw-9  \expnd0\expndtw0 Hessian\expnd-2\expndtw-9  \expnd0\expndtw0 eigenvalues\expnd-2\expndtw-9  \expnd0\expndtw0 for\expnd-2\expndtw-9  \expnd0\expndtw0 classification # (Expensive, so we approximate)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 eigenvalues\expnd3\expndtw15  \expnd0\expndtw-2 =\expnd3\expndtw17  \expnd0\expndtw-2 self._estimate_hessian_eigenvalues(z_eq,\expnd4\expndtw18  \expnd0\expndtw-2 context)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5305\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 critical_points.append(\'7B\expnd8\expndtw40  \expnd0\expndtw0 'position':\expnd-3\expndtw-16  \expnd0\expndtw0 z_eq.cpu().numpy(), 'energy': info['final_energy'], 'grad_norm': grad_norm, 'eigenvalues': eigenvalues,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'type':\expnd-1\expndtw-7  \expnd0\expndtw-2 self._classify_critical_point(eigenvalues)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Summarize\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 types = [cp['type'] for cp in critical_points] type_counts\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 \'7Bt:\expnd-1\expndtw-6  \expnd0\expndtw0 types.count(t)\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 t\expnd-1\expndtw-6  \expnd0\expndtw0 in\expnd-1\expndtw-6  \expnd0\expndtw0 set(types)\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("\'5CnCritical\expnd-2\expndtw-11  \expnd0\expndtw0 Point\expnd-2\expndtw-11  \expnd0\expndtw-2 Analysis:")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-1\expndtw-5  \expnd0\expndtw0 cp_type,\expnd-1\expndtw-4  \expnd0\expndtw0 count\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw-2 type_counts.items():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri2558\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\expnd8\expndtw40  \expnd0\expndtw0 \'7Bcp_type\'7D:\expnd-2\expndtw-11  \expnd0\expndtw0 \'7Bcount\'7D\expnd-2\expndtw-11  \expnd0\expndtw0 (\'7Bcount/len(critical_points):.1%\'7D)") return critical_points\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri2204\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 _estimate_hessian_eigenvalues(self,\expnd-2\expndtw-11  \expnd0\expndtw0 z,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 num_samples=5): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Estimate\expnd-2\expndtw-8  \expnd0\expndtw0 Hessian\expnd-1\expndtw-7  \expnd0\expndtw0 eigenvalues\expnd-2\expndtw-8  \expnd0\expndtw0 using\expnd-1\expndtw-7  \expnd0\expndtw0 finite\expnd-1\expndtw-7  \expnd0\expndtw-2 differences.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2627\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Full\expnd-1\expndtw-5  \expnd0\expndtw0 Hessian\expnd-1\expndtw-5  \expnd0\expndtw0 is\expnd-1\expndtw-5  \expnd0\expndtw0 too\expnd-1\expndtw-5  \expnd0\expndtw0 expensive,\expnd-1\expndtw-5  \expnd0\expndtw0 so\expnd-1\expndtw-5  \expnd0\expndtw0 we\expnd-1\expndtw-5  \expnd0\expndtw0 sample\expnd-1\expndtw-5  \expnd0\expndtw0 random\expnd-1\expndtw-5  \expnd0\expndtw0 directions. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 eigenvalues\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd-1\expndtw-5 []\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.enable_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5820\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 _\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_samples): v = torch.randn_like(z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 v\expnd0\expndtw-1  \expnd0\expndtw0 =\expnd0\expndtw-1  \expnd0\expndtw0 v\expnd0\expndtw-1  \expnd0\expndtw0 /\expnd0\expndtw-1  \expnd0\expndtw-2 torch.norm(v)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3818\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Compute Hessian-vector product: H @ v z_param\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 z.detach().requires_grad_(True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri861\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_next\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.dynamics(z_param,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-11  \expnd0\expndtw0 self.model.memory_patterns) E, _ = self.model.energy_fn(z_param, z_next, self.model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 grad_E\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.autograd.grad(E,\expnd-2\expndtw-9  \expnd0\expndtw0 z_param,\expnd-2\expndtw-9  \expnd0\expndtw-2 create_graph=True)[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hv\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.autograd.grad(grad_E,\expnd-2\expndtw-11  \expnd0\expndtw0 z_param,\expnd-2\expndtw-11  \expnd0\expndtw0 v,\expnd-2\expndtw-11  \expnd0\expndtw-2 retain_graph=False)[0]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-14  \expnd0\expndtw0 Rayleigh\expnd-3\expndtw-14  \expnd0\expndtw0 quotient\expnd-3\expndtw-14  \expnd0\expndtw0 approximation eigenval = (v * Hv).sum().item() \expnd0\expndtw-2 eigenvalues.append(eigenval)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 eigenvalues\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4789\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 _classify_critical_point(self,\expnd-3\expndtw-15  \expnd0\expndtw0 eigenvalues): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Classify\expnd-2\expndtw-8  \expnd0\expndtw0 critical\expnd-1\expndtw-6  \expnd0\expndtw0 point\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-6  \expnd0\expndtw0 Hessian\expnd-1\expndtw-5  \expnd0\expndtw-2 eigenvalues.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 All\expnd-1\expndtw-6  \expnd0\expndtw0 positive:\expnd-1\expndtw-6  \expnd0\expndtw0 Local\expnd-1\expndtw-6  \expnd0\expndtw0 minimum\expnd-1\expndtw-6  \expnd0\expndtw-2 (stable)\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li721\fi-133\sl240\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 All\expnd-1\expndtw-6  \expnd0\expndtw0 negative:\expnd-1\expndtw-6  \expnd0\expndtw0 Local\expnd-1\expndtw-6  \expnd0\expndtw0 maximum\expnd-1\expndtw-6  \expnd0\expndtw-2 (unstable)\par\pard\plain\s2\ls16\ilvl0\nooverflow\nocwrap\lnbrkrule\li588\ri6904\sl276\slmult1\sb38\tx721\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mixed:\expnd-3\expndtw-16  \expnd0\expndtw0 Saddle\expnd-3\expndtw-15  \expnd0\expndtw0 point \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 pos = sum(1 for e in eigenvalues if e > 0.01) neg\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 sum(1\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-5  \expnd0\expndtw0 e\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd0\expndtw0 eigenvalues\expnd-1\expndtw-5  \expnd0\expndtw0 if\expnd-1\expndtw-5  \expnd0\expndtw0 e\expnd-1\expndtw-5  \expnd0\expndtw0 <\expnd-1\expndtw-5  \expnd0\expndtw0 -0.01)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw360\colsr128\colno2\colw9072\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb68\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5837\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 if pos == len(eigenvalues): return\expnd-3\expndtw-16  \expnd0\expndtw0 'Minimum\expnd-3\expndtw-15  \expnd0\expndtw0 (Stable)'\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5837\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 elif neg == len(eigenvalues): return\expnd-3\expndtw-16  \expnd0\expndtw0 'Maximum\expnd-3\expndtw-15  \expnd0\expndtw0 (Unstable)'\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-7  \expnd0\expndtw0 'Saddle\expnd-1\expndtw-6  \expnd0\expndtw-2 Point'\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb18\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-20\f2\fs2
{\field\fldlock
{\*\fldinst SHAPE  \\* MERGEFORMAT}
{\fldrslt 
{\shpgrp{\*\shpinst\shplid1620
\shpleft0\shptop0\shpright367\shpbottom20\shpfhdr0
\shpbxcolumn\shpbxignore\shpbypara\shpbyignore\shpwr3\shpwrk0\shpfblwtxt1\shpz6
\shplockanchor
\shpwr3\shpwrk0\shpfblwtxt1{\sp{\sn groupLeft}{\sv 0}}
{\sp{\sn groupTop}{\sv 0}}
{\sp{\sn groupRight}{\sv 367}}
{\sp{\sn groupBottom}{\sv 20}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn lidRegroup}{\sv 0}}
{\sp{\sn posrelh}{\sv 3}}
{\sp{\sn posrelv}{\sv 3}}

{\shp{\*\shpinst\shplid1621
{\sp{\sn relLeft}{\sv 0}}
{\sp{\sn relTop}{\sv 9}}
{\sp{\sn relRight}{\sv 367}}
{\sp{\sn relBottom}{\sv 10}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 1}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
{\pict
{\*\picprop\defshp\shplid1620
{\sp{\sn shapeType}{\sv 75}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn fLayoutInCell}{\sv 1}}
{\sp{\sn fLockPosition}{\sv 1}}
{\sp{\sn fLockRotation}{\sv 1}}
}
\piccropl0\piccropr0\piccropt-20\piccropb20\picwgoal367\pichgoal20
\wmetafile8\bliptag-1003278350\blipupi72
}
}}
\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb159\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-10  \expnd0\expndtw0 **Phase\expnd-2\expndtw-10  \expnd0\expndtw0 7:\expnd-2\expndtw-10  \expnd0\expndtw0 Practical\expnd-2\expndtw-10  \expnd0\expndtw0 Task\expnd-2\expndtw-9  \expnd0\expndtw-2 Experiments**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-3\expndtw-14  \expnd0\expndtw0 **Step\expnd-2\expndtw-12  \expnd0\expndtw0 7.1:\expnd-2\expndtw-12  \expnd0\expndtw0 Memory-Intensive\expnd-2\expndtw-12  \expnd0\expndtw0 Tasks\expnd-2\expndtw-11  \expnd0\expndtw-2 (experiments/tasks/memory_tasks.py)**\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5996\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 AssociativeRecallExperiment: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Test\expnd-2\expndtw-8  \expnd0\expndtw0 the\expnd-2\expndtw-8  \expnd0\expndtw0 model's\expnd-2\expndtw-8  \expnd0\expndtw0 ability\expnd-2\expndtw-8  \expnd0\expndtw0 to\expnd-2\expndtw-8  \expnd0\expndtw0 store\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-2\expndtw-8  \expnd0\expndtw0 retrieve\expnd-2\expndtw-8  \expnd0\expndtw0 key-value\expnd-2\expndtw-8  \expnd0\expndtw-2 associations.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Task:\expnd-2\expndtw-8  \expnd0\expndtw0 Given\expnd-1\expndtw-7  \expnd0\expndtw0 N\expnd-1\expndtw-7  \expnd0\expndtw0 key-value\expnd-2\expndtw-8  \expnd0\expndtw0 pairs\expnd-1\expndtw-7  \expnd0\expndtw0 in\expnd-1\expndtw-7  \expnd0\expndtw0 context,\expnd-1\expndtw-7  \expnd0\expndtw0 retrieve\expnd-2\expndtw-8  \expnd0\expndtw0 value\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 query\expnd-1\expndtw-7  \expnd-1\expndtw-4 key.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri1776\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 Tests\expnd-2\expndtw-11  \expnd0\expndtw0 both\expnd-2\expndtw-11  \expnd0\expndtw0 Mamba's\expnd-2\expndtw-11  \expnd0\expndtw0 context\expnd-2\expndtw-11  \expnd0\expndtw0 processing\expnd-2\expndtw-11  \expnd0\expndtw0 and\expnd-2\expndtw-11  \expnd0\expndtw0 Hopfield's\expnd-2\expndtw-11  \expnd0\expndtw0 associative\expnd-2\expndtw-11  \expnd0\expndtw0 memory. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-1\expndtw-4  \f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 (self,\expnd-1\expndtw-4  \expnd0\expndtw0 model,\expnd-1\expndtw-4  \expnd0\expndtw0 vocab_size=1000,\expnd-1\expndtw-4  \expnd0\expndtw0 max_pairs=50): self.model = model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.vocab_size\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 vocab_size self.max_pairs = max_pairs\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 generate_task(self,\expnd-3\expndtw-14  \expnd0\expndtw0 num_pairs,\expnd-3\expndtw-14  \expnd0\expndtw0 query_position='random'): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Generate\expnd-1\expndtw-7  \expnd0\expndtw0 a\expnd-1\expndtw-6  \expnd0\expndtw0 single\expnd-1\expndtw-7  \expnd0\expndtw0 associative\expnd-1\expndtw-6  \expnd0\expndtw0 recall\expnd-1\expndtw-6  \expnd0\expndtw-2 instance.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Format:\expnd-2\expndtw-9  \expnd0\expndtw0 [key1]\expnd-1\expndtw-7  \expnd0\expndtw0 [value1]\expnd-1\expndtw-7  \expnd0\expndtw0 [key2]\expnd-1\expndtw-7  \expnd0\expndtw0 [value2]\expnd-1\expndtw-7  \expnd0\expndtw0 ...\expnd-1\expndtw-7  \expnd0\expndtw0 [query_key]\expnd-1\expndtw-7  \expnd-1\expndtw-5 [?]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4836\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Target:\expnd-3\expndtw-16  \expnd0\expndtw0 value\expnd-3\expndtw-15  \expnd0\expndtw0 corresponding\expnd-3\expndtw-15  \expnd0\expndtw0 to\expnd-3\expndtw-16  \expnd0\expndtw0 query_key \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Sample\expnd-1\expndtw-4  \expnd0\expndtw0 unique\expnd-1\expndtw-4  \expnd0\expndtw0 keys\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw-2 values\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 keys\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 torch.randint(0,\expnd-1\expndtw-6  \expnd0\expndtw0 self.vocab_size\expnd-1\expndtw-7  \expnd0\expndtw0 //\expnd-1\expndtw-7  \expnd0\expndtw0 2,\expnd-1\expndtw-6  \expnd0\expndtw-2 (num_pairs,))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 values\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randint(self.vocab_size\expnd-2\expndtw-9  \expnd0\expndtw0 //\expnd-2\expndtw-10  \expnd0\expndtw0 2,\expnd-2\expndtw-9  \expnd0\expndtw0 self.vocab_size,\expnd-2\expndtw-9  \expnd0\expndtw-2 (num_pairs,))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Build\expnd-3\expndtw-15  \expnd0\expndtw0 sequence sequence = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for k, v in zip(keys, values): \expnd0\expndtw-2 sequence.extend([k.item(), v.item()])\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-2  \expnd0\expndtw0 Add\expnd0\expndtw-2  query\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-6  \expnd0\expndtw0 query_position\expnd-1\expndtw-6  \expnd0\expndtw0 ==\expnd-1\expndtw-6  \expnd0\expndtw-2 'random':\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi244\ri3492\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 query_idx\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randint(0,\expnd-2\expndtw-11  \expnd0\expndtw0 num_pairs,\expnd-2\expndtw-11  \expnd0\expndtw0 (1,)).item() \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 query_idx\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 query_position\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 query_key = keys[query_idx].item() target_value\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 values[query_idx].item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 sequence.extend([query_key,\expnd-2\expndtw-12  \expnd0\expndtw0 -100])\expnd9\expndtw43  \expnd0\expndtw0 #\expnd-2\expndtw-10  \expnd0\expndtw0 -100\expnd-2\expndtw-9  \expnd0\expndtw0 as\expnd-2\expndtw-9  \expnd0\expndtw-2 placeholder\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3781\qj\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids\expnd-3\expndtw-15  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 torch.tensor(sequence[:-1]).unsqueeze(0) target_ids\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 torch.tensor(sequence[1:]).unsqueeze(0) target_ids[0, :-1] = -100\expnd8\expndtw40  \expnd0\expndtw0 # Only predict last token\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-2\expndtw-9  \expnd0\expndtw0 input_ids,\expnd-2\expndtw-9  \expnd0\expndtw0 target_ids,\expnd-2\expndtw-9  \expnd0\expndtw-2 target_value\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-2\expndtw-11  \expnd0\expndtw0 evaluate(self,\expnd-2\expndtw-11  \expnd0\expndtw0 num_trials=100,\expnd-2\expndtw-11  \expnd0\expndtw0 num_pairs_range=(5,\expnd-2\expndtw-11  \expnd0\expndtw0 50)): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4789\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Evaluate\expnd-2\expndtw-9  \expnd0\expndtw0 across\expnd-2\expndtw-9  \expnd0\expndtw0 different\expnd-2\expndtw-9  \expnd0\expndtw0 numbers\expnd-2\expndtw-9  \expnd0\expndtw0 of\expnd-2\expndtw-9  \expnd0\expndtw0 pairs. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 results\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 \'7Bn:\expnd-1\expndtw-4  \expnd0\expndtw0 \'7B'correct':\expnd-1\expndtw-4  \expnd0\expndtw0 0,\expnd-1\expndtw-5  \expnd0\expndtw0 'total':\expnd-1\expndtw-4  \expnd0\expndtw0 0\'7D\expnd-1\expndtw-4  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 n\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw0 range(5,\expnd-1\expndtw-4  \expnd0\expndtw0 51,\expnd-1\expndtw-4  \expnd-1\expndtw-5 5)\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6953\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.eval()\expnd8\expndtw40  \expnd0\expndtw0 with\expnd-3\expndtw-16  \expnd0\expndtw0 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd0\expndtw-2  \expnd0\expndtw0 _\expnd0\expndtw-2  \expnd0\expndtw0 in\expnd0\expndtw-2  tqdm(range(num_trials)):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 num_pairs\expnd-3\expndtw-13  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randint(num_pairs_range[0],\expnd-2\expndtw-10  \expnd0\expndtw0 num_pairs_range[1]\expnd-2\expndtw-11  \expnd0\expndtw0 +\expnd-2\expndtw-11  \expnd0\expndtw0 1,\expnd-2\expndtw-10  \expnd0\expndtw-2 (1,)).item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids,\expnd-2\expndtw-11  \expnd0\expndtw0 target_ids,\expnd-2\expndtw-11  \expnd0\expndtw0 target_value\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 self.generate_task(num_pairs) input_ids = input_ids.to(self.model.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 self.model(input_ids)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 prediction\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 logits[0,\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd0\expndtw-2 1].argmax().item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Round\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 nearest\expnd-1\expndtw-7  \expnd0\expndtw0 bracket\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 counting bracket = (num_pairs // 5) * 5\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri5462\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if bracket in results: results[bracket]['total'] += 1\expnd8\expndtw40  \expnd0\expndtw0 if\expnd-3\expndtw-14  \expnd0\expndtw0 prediction\expnd-3\expndtw-14  \expnd0\expndtw0 ==\expnd-3\expndtw-14  \expnd0\expndtw0 target_value:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1565\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 results[bracket]['correct']\expnd-3\expndtw-15  \expnd0\expndtw0 +=\expnd-3\expndtw-14  \expnd-2\expndtw-10 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 Compute\expnd-3\expndtw-15  \expnd0\expndtw0 accuracies accuracies = \'7B\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6204\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-2\expndtw-10  \expnd0\expndtw0 n,\expnd-2\expndtw-10  \expnd0\expndtw0 stats\expnd-2\expndtw-10  \expnd0\expndtw0 in\expnd-2\expndtw-10  \expnd0\expndtw0 results.items(): if stats['total'] > 0:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi244\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 accuracies[n]\expnd-2\expndtw-10  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 stats['correct']\expnd-2\expndtw-10  \expnd0\expndtw0 /\expnd-2\expndtw-10  \expnd0\expndtw0 stats['total'] \expnd0\expndtw-2 else:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 accuracies[n]\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd-1\expndtw-5 0.0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6589\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Plot plt.figure(figsize=(10,\expnd-3\expndtw-16  \expnd0\expndtw0 6))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 pairs = sorted(accuracies.keys()) accs\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 [accuracies[p]\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 p\expnd-1\expndtw-7  \expnd0\expndtw0 in\expnd-1\expndtw-7  \expnd0\expndtw0 pairs]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.plot(pairs,\expnd-2\expndtw-11  \expnd0\expndtw0 accs,\expnd-2\expndtw-11  \expnd0\expndtw0 'o-',\expnd-2\expndtw-11  \expnd0\expndtw0 linewidth=2,\expnd-2\expndtw-11  \expnd0\expndtw0 markersize=8) plt.xlabel('Number of Key-Value Pairs') \expnd0\expndtw-2 plt.ylabel('Accuracy')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.title('Associative\expnd-3\expndtw-16  \expnd0\expndtw0 Recall\expnd-3\expndtw-15  \expnd0\expndtw0 Performance') plt.grid(True, alpha=0.3)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3900\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.ylim([0, 1.05]) plt.savefig('associative_recall_results.png',\expnd-3\expndtw-16  \expnd0\expndtw0 dpi=150)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 accuracies\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb113\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5935\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 ContinualLearningExperiment: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Test\expnd-2\expndtw-11  \expnd0\expndtw0 continual\expnd-2\expndtw-9  \expnd0\expndtw0 learning:\expnd-2\expndtw-9  \expnd0\expndtw0 learn\expnd-2\expndtw-9  \expnd0\expndtw0 new\expnd-2\expndtw-8  \expnd0\expndtw0 tasks\expnd-2\expndtw-9  \expnd0\expndtw0 without\expnd-2\expndtw-9  \expnd0\expndtw0 forgetting\expnd-2\expndtw-9  \expnd0\expndtw0 old\expnd-2\expndtw-8  \expnd0\expndtw-2 ones.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri1939\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-5  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw0 model\expnd-1\expndtw-5  \expnd0\expndtw0 should\expnd-1\expndtw-5  \expnd0\expndtw0 leverage\expnd-1\expndtw-5  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 store\expnd-1\expndtw-5  \expnd0\expndtw0 task-specific patterns without catastrophic forgetting.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-1\expndtw-5  \f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd8\expndtw40\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 (self,\expnd-1\expndtw-5  \expnd0\expndtw0 model,\expnd-1\expndtw-5  \expnd0\expndtw0 num_tasks=5): self.model = model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.num_tasks = num_tasks self.tasks\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self._generate_tasks()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6669\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 _generate_tasks(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2968\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Create\expnd-1\expndtw-7  \expnd0\expndtw0 distinct\expnd-1\expndtw-7  \expnd0\expndtw0 sequential\expnd-1\expndtw-7  \expnd0\expndtw0 tasks\expnd-1\expndtw-7  \expnd0\expndtw0 (e.g.,\expnd-1\expndtw-7  \expnd0\expndtw0 different\expnd-1\expndtw-7  \expnd0\expndtw0 copy\expnd-1\expndtw-7  \expnd0\expndtw0 patterns). \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 tasks\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-1\expndtw-5 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-1\expndtw-4  \expnd0\expndtw0 task_id\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw-2 range(self.num_tasks):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Each\expnd-1\expndtw-6  \expnd0\expndtw0 task:\expnd-1\expndtw-5  \expnd0\expndtw0 copy\expnd-1\expndtw-6  \expnd0\expndtw0 a\expnd-1\expndtw-5  \expnd0\expndtw0 specific\expnd-1\expndtw-6  \expnd0\expndtw0 subset\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-6  \expnd0\expndtw0 tokens start_token = task_id * 100\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 end_token\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 (task_id\expnd-1\expndtw-7  \expnd0\expndtw0 +\expnd-1\expndtw-7  \expnd0\expndtw0 1)\expnd-1\expndtw-7  \expnd0\expndtw0 *\expnd-1\expndtw-7  \expnd0\expndtw0 100 \expnd0\expndtw-2 tasks.append(\'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'id':\expnd-1\expndtw-5  \expnd0\expndtw-2 task_id,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'name':\expnd-3\expndtw-14  \expnd0\expndtw0 f'Copy\expnd-3\expndtw-14  \expnd0\expndtw0 tokens\expnd-3\expndtw-14  \expnd0\expndtw0 [\'7Bstart_token\'7D-\'7Bend_token\'7D)', 'token_range': (start_token, end_token)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 tasks\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4789\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-14  \expnd0\expndtw0 train_task(self,\expnd-3\expndtw-14  \expnd0\expndtw0 task_id,\expnd-3\expndtw-14  \expnd0\expndtw0 num_steps=100): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6749\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Train\expnd-2\expndtw-12  \expnd0\expndtw0 on\expnd-2\expndtw-12  \expnd0\expndtw0 a\expnd-2\expndtw-12  \expnd0\expndtw0 single\expnd-2\expndtw-12  \expnd0\expndtw0 task. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 task\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd0\expndtw-2  self.tasks[task_id]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 start,\expnd-1\expndtw-4  \expnd0\expndtw0 end\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 task['token_range']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.train()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 optimizer\expnd3\expndtw17  \expnd0\expndtw-2 =\expnd4\expndtw19  \expnd0\expndtw-2 torch.optim.Adam(self.model.parameters(),\expnd4\expndtw19  \expnd0\expndtw-2 lr=1e-\expnd-1\expndtw-5 4)\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6058\sl276\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 step\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(num_steps): # Generate task data seq_len = 10\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_tokens\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randint(start,\expnd-2\expndtw-9  \expnd0\expndtw0 end,\expnd-2\expndtw-9  \expnd0\expndtw0 (1,\expnd-2\expndtw-9  \expnd0\expndtw0 seq_len)) target_tokens = input_tokens.clone()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_tokens = input_tokens.to(self.model.device) target_tokens\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 target_tokens.to(self.model.device)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Forward\expnd-1\expndtw-4  pass\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.model(input_tokens,\expnd-3\expndtw-15  \expnd0\expndtw0 update_memory=True) loss = F.cross_entropy(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri5634\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits.view(-1,\expnd-3\expndtw-16  \expnd0\expndtw0 logits.size(-1)), \expnd0\expndtw-2 target_tokens.view(-1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Backward \expnd0\expndtw-2 optimizer.zero_grad() loss.backward() optimizer.step()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6485\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 evaluate_all_tasks(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Evaluate\expnd-2\expndtw-8  \expnd0\expndtw0 performance\expnd-2\expndtw-8  \expnd0\expndtw0 on\expnd-2\expndtw-8  \expnd0\expndtw0 all\expnd-2\expndtw-8  \expnd0\expndtw0 tasks\expnd-2\expndtw-8  \expnd0\expndtw0 learned\expnd-2\expndtw-8  \expnd0\expndtw0 so\expnd-2\expndtw-8  \expnd0\expndtw0 far. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6953\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 self.model.eval() \expnd0\expndtw0 results = \'7B\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6718\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with torch.no_grad(): for\expnd-1\expndtw-3  \expnd0\expndtw0 task\expnd-1\expndtw-3  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw-2 self.tasks:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 task_id\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw-2 task['id']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 start,\expnd-1\expndtw-4  \expnd0\expndtw0 end\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 task['token_range']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 #\expnd-3\expndtw-14  \expnd0\expndtw-2 Test\expnd-3\expndtw-13  \expnd0\expndtw-2 accuracy \expnd0\expndtw0 correct = 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 total\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\fi-245\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-3\expndtw-13  \expnd0\expndtw0 _\expnd-3\expndtw-13  \expnd0\expndtw0 in\expnd-3\expndtw-13  \expnd0\expndtw0 range(20): seq_len = 10\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri1939\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_tokens\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randint(start,\expnd-2\expndtw-9  \expnd0\expndtw0 end,\expnd-2\expndtw-9  \expnd0\expndtw0 (1,\expnd-2\expndtw-9  \expnd0\expndtw0 seq_len)) target_tokens = input_tokens.clone()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_tokens\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw-2 input_tokens.to(self.model.device)\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri1939\sl276\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 self.model(input_tokens,\expnd-3\expndtw-14  \expnd0\expndtw0 update_memory=False) predictions = logits.argmax(dim=-1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\ri861\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 correct\expnd-2\expndtw-11  \expnd0\expndtw0 +=\expnd-2\expndtw-11  \expnd0\expndtw0 (predictions\expnd-2\expndtw-11  \expnd0\expndtw0 ==\expnd-2\expndtw-11  \expnd0\expndtw0 target_tokens.to(self.model.device)).sum().item() total += seq_len\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 accuracy = correct / total results[task_id]\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 accuracy\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 results\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6069\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 run_continual_learning(self): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4180\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Train\expnd-2\expndtw-10  \expnd0\expndtw0 tasks\expnd-2\expndtw-10  \expnd0\expndtw0 sequentially\expnd-2\expndtw-10  \expnd0\expndtw0 and\expnd-2\expndtw-10  \expnd0\expndtw0 measure\expnd-2\expndtw-10  \expnd0\expndtw0 forgetting. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 history\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd-1\expndtw-5 []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri5363\qj\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for task_id in range(self.num_tasks): \expnd0\expndtw-2 print(f"\'5CnTraining Task \'7Btask_id\'7D...") self.train_task(task_id)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Evaluate\expnd-1\expndtw-4  \expnd0\expndtw0 all\expnd-1\expndtw-4  \expnd0\expndtw-2 tasks\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 accuracies\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self.evaluate_all_tasks() \expnd0\expndtw-2 history.append(accuracies)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\ri5224\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"After\expnd-3\expndtw-14  \expnd0\expndtw0 training\expnd-3\expndtw-14  \expnd0\expndtw0 task\expnd-3\expndtw-14  \expnd0\expndtw0 \'7Btask_id\'7D:") for tid, acc in accuracies.items():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-3  \expnd0\expndtw0 tid\expnd0\expndtw-2  \expnd0\expndtw0 <=\expnd0\expndtw-2  task_id:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\expnd8\expndtw40  \expnd0\expndtw0 Task\expnd-2\expndtw-11  \expnd0\expndtw0 \'7Btid\'7D:\expnd-2\expndtw-10  \expnd0\expndtw-2 \'7Bacc:.2%\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Visualize forgetting \expnd0\expndtw-2 self._plot_forgetting(history)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 return\expnd-1\expndtw-6  \expnd0\expndtw-2 history\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 _plot_forgetting(self,\expnd-3\expndtw-15  \expnd0\expndtw0 history): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri4103\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Plot\expnd-1\expndtw-7  \expnd0\expndtw0 accuracy\expnd-1\expndtw-7  \expnd0\expndtw0 matrix\expnd-1\expndtw-7  \expnd0\expndtw0 showing\expnd-1\expndtw-7  \expnd0\expndtw0 forgetting\expnd-1\expndtw-7  \expnd0\expndtw0 over\expnd-1\expndtw-7  \expnd0\expndtw0 time. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 num_evaluated\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw-2 len(history)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3818\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 matrix\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 np.zeros((num_evaluated,\expnd-3\expndtw-14  \expnd0\expndtw0 self.num_tasks)) for i, accuracies in enumerate(history):\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1077\fi-245\ri5088\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-2\expndtw-10  \expnd0\expndtw0 task_id,\expnd-2\expndtw-10  \expnd0\expndtw0 acc\expnd-2\expndtw-10  \expnd0\expndtw0 in\expnd-2\expndtw-10  \expnd0\expndtw0 accuracies.items(): if task_id < self.num_tasks:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li1321\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 matrix[i,\expnd-1\expndtw-6  \expnd0\expndtw0 task_id]\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd-1\expndtw-5 acc\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.figure(figsize=(10,\expnd5\expndtw23  \expnd-1\expndtw-5 8))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.imshow(matrix.T,\expnd-3\expndtw-16  \expnd0\expndtw0 aspect='auto',\expnd-3\expndtw-15  \expnd0\expndtw0 cmap='RdYlGn',\expnd-3\expndtw-15  \expnd0\expndtw0 vmin=0,\expnd-3\expndtw-16  \expnd0\expndtw0 vmax=1) \expnd0\expndtw-2 plt.colorbar(label='Accuracy')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5820\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.xlabel('After\expnd-3\expndtw-16  \expnd0\expndtw0 Training\expnd-3\expndtw-15  \expnd0\expndtw0 Task\expnd-3\expndtw-15  \expnd0\expndtw0 N') plt.ylabel('Task ID')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\fi488\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.title('Continual\expnd-1\expndtw-6  \expnd0\expndtw0 Learning:\expnd-1\expndtw-6  \expnd0\expndtw0 Accuracy\expnd-1\expndtw-6  \expnd0\expndtw0 Matrix\'5Cn(Diagonal\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 current\expnd-1\expndtw-6  \expnd0\expndtw0 task,\expnd-1\expndtw-6  \expnd0\expndtw0 Off-diagonal\expnd-1\expndtw-6  \expnd0\expndtw0 = \expnd0\expndtw-2 retention)')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri511\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.xticks(range(num_evaluated),\expnd-2\expndtw-12  \expnd0\expndtw0 [f'Task\expnd-2\expndtw-12  \expnd0\expndtw0 \'7Bi\'7D'\expnd-2\expndtw-12  \expnd0\expndtw0 for\expnd-2\expndtw-12  \expnd0\expndtw0 i\expnd-2\expndtw-12  \expnd0\expndtw0 in\expnd-2\expndtw-12  \expnd0\expndtw0 range(num_evaluated)]) plt.yticks(range(self.num_tasks), [f'Task \'7Bi\'7D' for i in range(self.num_tasks)]) \expnd0\expndtw-2 plt.tight_layout()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.savefig('continual_learning_results.png',\expnd9\expndtw43  \expnd0\expndtw-2 dpi=150)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-13  \expnd0\expndtw0 Compute\expnd-3\expndtw-13  \expnd0\expndtw0 forgetting\expnd-3\expndtw-13  \expnd0\expndtw0 metric forgetting = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for task_id in range(self.num_tasks - 1): peak_acc = matrix[task_id, task_id] final_acc = matrix[-1, task_id] forgetting.append(peak_acc\expnd-3\expndtw-16  \expnd0\expndtw0 -\expnd-3\expndtw-15  \expnd0\expndtw0 final_acc)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb3\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw360\colsr128\colno2\colw9072\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3783\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 avg_forgetting = np.mean(forgetting) print(f"\'5CnAverage\expnd-3\expndtw-16  \expnd0\expndtw0 forgetting:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bavg_forgetting:.2%\'7D")\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb18\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-20\f2\fs2
{\field\fldlock
{\*\fldinst SHAPE  \\* MERGEFORMAT}
{\fldrslt 
{\shpgrp{\*\shpinst\shplid1810
\shpleft0\shptop0\shpright367\shpbottom20\shpfhdr0
\shpbxcolumn\shpbxignore\shpbypara\shpbyignore\shpwr3\shpwrk0\shpfblwtxt1\shpz7
\shplockanchor
\shpwr3\shpwrk0\shpfblwtxt1{\sp{\sn groupLeft}{\sv 0}}
{\sp{\sn groupTop}{\sv 0}}
{\sp{\sn groupRight}{\sv 367}}
{\sp{\sn groupBottom}{\sv 20}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn lidRegroup}{\sv 0}}
{\sp{\sn posrelh}{\sv 3}}
{\sp{\sn posrelv}{\sv 3}}

{\shp{\*\shpinst\shplid1811
{\sp{\sn relLeft}{\sv 0}}
{\sp{\sn relTop}{\sv 9}}
{\sp{\sn relRight}{\sv 367}}
{\sp{\sn relBottom}{\sv 10}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 1}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
{\pict
{\*\picprop\defshp\shplid1810
{\sp{\sn shapeType}{\sv 75}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn fLayoutInCell}{\sv 1}}
{\sp{\sn fLockPosition}{\sv 1}}
{\sp{\sn fLockRotation}{\sv 1}}
}
\piccropl0\piccropr0\piccropt-20\piccropb20\picwgoal367\pichgoal20
\wmetafile8\bliptag-1003278350\blipupi72
}
}}
\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb159\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-8  \expnd0\expndtw0 **Phase\expnd-1\expndtw-5  \expnd0\expndtw0 8:\expnd-1\expndtw-5  \expnd0\expndtw0 Documentation\expnd-1\expndtw-5  \expnd0\expndtw0 &\expnd-1\expndtw-5  \expnd0\expndtw-2 Deployment**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-10  \expnd0\expndtw0 **Step\expnd-2\expndtw-8  \expnd0\expndtw0 8.1:\expnd-2\expndtw-8  \expnd0\expndtw0 Comprehensive\expnd-2\expndtw-8  \expnd0\expndtw0 Documentation\expnd-2\expndtw-8  \expnd0\expndtw-2 (docs/theory.md)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```markdown\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3818\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-11  \expnd0\expndtw0 Unified\expnd-2\expndtw-11  \expnd0\expndtw0 Mamba-Hopfield-DEQ:\expnd-2\expndtw-11  \expnd0\expndtw0 Theoretical\expnd-2\expndtw-11  \expnd0\expndtw0 Foundation ## Overview\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 This\expnd-1\expndtw-4  \expnd0\expndtw0 architecture\expnd-1\expndtw-4  \expnd0\expndtw0 unifies\expnd-1\expndtw-4  \expnd0\expndtw0 three\expnd-1\expndtw-4  \expnd0\expndtw0 powerful\expnd-1\expndtw-4  \expnd0\expndtw0 paradigms\expnd-1\expndtw-4  \expnd0\expndtw0 into\expnd-1\expndtw-4  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 single\expnd-1\expndtw-4  \expnd0\expndtw0 coherent\expnd-1\expndtw-4  \expnd0\expndtw0 framework\expnd-1\expndtw-4  \expnd0\expndtw0 where memory retrieval, sequence processing, and iterative reasoning emerge from a common optimization objective.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Mathematical\expnd-1\expndtw-7  \expnd0\expndtw-2 Framework\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-4  \expnd0\expndtw0 1.\expnd-1\expndtw-4  \expnd0\expndtw0 Energy\expnd-1\expndtw-3  \expnd0\expndtw-2 Function\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-2\expndtw-8  \expnd0\expndtw0 system\expnd-1\expndtw-5  \expnd0\expndtw0 minimizes\expnd-1\expndtw-5  \expnd0\expndtw0 a\expnd-1\expndtw-6  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw0 energy\expnd-1\expndtw-5  \expnd0\expndtw-2 function:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 E(z,\expnd-1\expndtw-5  \expnd0\expndtw0 x,\expnd-1\expndtw-4  \expnd0\expndtw0 M)\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 E_Hopfield(z,\expnd-1\expndtw-4  \expnd0\expndtw0 M)\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 E_consistency(z,\expnd-1\expndtw-5  \expnd0\expndtw0 x)\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw-2 E_reg(z)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8742\sl276\slmult1\f2\fs22\b0\expnd-1\expndtw-4\charscalex100 ``` \expnd0\expndtw-2 Where:\par\pard\plain\s2\ls17\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-255\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 `E_Hopfield(z,\expnd-2\expndtw-8  \expnd0\expndtw0 M)\expnd-2\expndtw-8  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 -log(\uc1\u931 ?\uc1\u7522 ?\expnd-2\expndtw-8  \expnd0\expndtw0 exp(\uc1\u946 ?\f1 \uc1\u10216 ?\f2 z,\expnd-1\expndtw-7  \expnd0\expndtw0 m\uc1\u7522 ?\f1 \uc1\u10217 ?\f2 ))`:\expnd-2\expndtw-8  \expnd0\expndtw0 Modern\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 pattern\expnd-2\expndtw-8  \expnd0\expndtw-2 retrieval\par\pard\plain\s2\ls17\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb36\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 `E_consistency(z,\expnd-1\expndtw-7  \expnd0\expndtw0 x)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 ||z\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw0 f_mamba(z,\expnd-1\expndtw-6  \expnd0\expndtw0 x)||\'B2`:\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-6  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-6  \expnd0\expndtw-2 residual\par\pard\plain\s2\ls17\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri3871\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 `E_reg(z)\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 \uc1\u955 ?||z||\'B2`:\expnd-1\expndtw-7  \expnd0\expndtw0 Regularization\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 bounded\expnd-1\expndtw-7  \expnd0\expndtw0 solutions ### 2. Unified Dynamics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-5  \expnd0\expndtw0 dynamics\expnd-1\expndtw-5  \expnd0\expndtw0 function\expnd-1\expndtw-5  \expnd0\expndtw0 combines\expnd-1\expndtw-5  \expnd0\expndtw0 temporal\expnd-1\expndtw-5  \expnd0\expndtw0 processing\expnd-1\expndtw-5  \expnd0\expndtw0 (Mamba)\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 associative\expnd-1\expndtw-5  \expnd0\expndtw0 retrieval \expnd0\expndtw-2 (Hopfield):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_\'7Bt+1\'7D\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 f(z_t,\expnd-1\expndtw-5  \expnd0\expndtw0 x,\expnd-1\expndtw-5  \expnd0\expndtw0 M)\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 g(Mamba(z_t,\expnd-1\expndtw-5  \expnd0\expndtw0 x),\expnd-1\expndtw-5  \expnd0\expndtw0 Hopfield(z_t,\expnd-1\expndtw-5  M))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1594\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Where\expnd-1\expndtw-4  \expnd0\expndtw0 `g`\expnd-1\expndtw-4  \expnd0\expndtw0 is\expnd-1\expndtw-4  \expnd0\expndtw0 a\expnd-1\expndtw-4  \expnd0\expndtw0 learned\expnd-1\expndtw-4  \expnd0\expndtw0 gating\expnd-1\expndtw-4  \expnd0\expndtw0 function\expnd-1\expndtw-4  \expnd0\expndtw0 that\expnd-1\expndtw-4  \expnd0\expndtw0 adaptively\expnd-1\expndtw-4  \expnd0\expndtw0 blends\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw0 contributions. ### 3. Equilibrium Conditions\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Convergence\expnd-1\expndtw-7  \expnd0\expndtw0 occurs\expnd-1\expndtw-6  \expnd0\expndtw0 when\expnd-1\expndtw-6  \expnd0\expndtw0 both\expnd-1\expndtw-7  \expnd0\expndtw0 conditions\expnd-1\expndtw-6  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw-2 satisfied:\par\pard\plain\s2\ls18\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Fixed-point**:\expnd-1\expndtw-6  \expnd0\expndtw0 `z*\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 f(z*,\expnd-1\expndtw-5  \expnd0\expndtw0 x,\expnd-1\expndtw-5  M)`\par\pard\plain\s2\ls18\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri5867\sl504\slmult1\sb20\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Energy\expnd-2\expndtw-9  \expnd0\expndtw0 minimum**:\expnd-2\expndtw-9  \expnd0\expndtw0 `\f3 \uc1\u8711 ?\f2 E(z*)\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 0` ## Convergence Guarantees\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb49\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-7  \expnd0\expndtw0 Theorem\expnd-1\expndtw-5  \expnd0\expndtw0 1:\expnd-1\expndtw-4  \expnd0\expndtw0 Existence\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-4  \expnd0\expndtw-2 Equilibria\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 If\expnd-1\expndtw-3  \expnd0\expndtw0 the\expnd-1\expndtw-3  \expnd0\expndtw0 dynamics\expnd-1\expndtw-3  \expnd0\expndtw0 `f`\expnd-1\expndtw-3  \expnd0\expndtw0 are\expnd-1\expndtw-3  \expnd0\expndtw0 contractive\expnd-1\expndtw-3  \expnd0\expndtw0 (Lipschitz\expnd-1\expndtw-3  \expnd0\expndtw0 constant\expnd-1\expndtw-3  \expnd0\expndtw0 L\expnd-1\expndtw-3  \expnd0\expndtw0 <\expnd-1\expndtw-3  \expnd0\expndtw0 1)\expnd-1\expndtw-3  \expnd0\expndtw0 and\expnd-1\expndtw-3  \expnd0\expndtw0 the\expnd-1\expndtw-3  \expnd0\expndtw0 energy\expnd-1\expndtw-3  \expnd0\expndtw0 function\expnd-1\expndtw-3  \expnd0\expndtw0 is\expnd-1\expndtw-3  \expnd0\expndtw0 bounded below, then equilibria exist.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1594\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Proof\expnd-1\expndtw-6  \expnd0\expndtw0 sketch**:\expnd-1\expndtw-6  \expnd0\expndtw0 Banach\expnd-1\expndtw-6  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-6  \expnd0\expndtw0 theorem\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 minimization\expnd-1\expndtw-6  \expnd0\expndtw0 principles. ### Theorem 2: Lyapunov Stability\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-7  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 function\expnd-1\expndtw-7  \expnd0\expndtw0 E\expnd-1\expndtw-6  \expnd0\expndtw0 serves\expnd-1\expndtw-6  \expnd0\expndtw0 as\expnd-1\expndtw-7  \expnd0\expndtw0 a\expnd-1\expndtw-6  \expnd0\expndtw0 Lyapunov\expnd-1\expndtw-6  \expnd0\expndtw0 function,\expnd-1\expndtw-7  \expnd0\expndtw0 guaranteeing\expnd-1\expndtw-6  \expnd0\expndtw0 stable\expnd-1\expndtw-6  \expnd0\expndtw-2 convergence.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Proof**:\expnd-1\expndtw-7  \expnd0\expndtw0 E\expnd-1\expndtw-7  \expnd0\expndtw0 decreases\expnd-1\expndtw-7  \expnd0\expndtw0 monotonically\expnd-1\expndtw-7  \expnd0\expndtw0 along\expnd-1\expndtw-7  \expnd0\expndtw0 trajectories:\expnd-1\expndtw-7  \expnd0\expndtw0 `E(z_\'7Bt+1\'7D)\expnd-1\expndtw-7  \expnd0\expndtw0 \uc1\u8804 ?\expnd-1\expndtw-7  \expnd0\expndtw0 E(z_t)`\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 all\expnd-1\expndtw-6  \expnd-1\expndtw-5 t.\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-7  \expnd0\expndtw0 Theorem\expnd-1\expndtw-6  \expnd0\expndtw0 3:\expnd-1\expndtw-6  \expnd0\expndtw0 Compositional\expnd-1\expndtw-6  \expnd0\expndtw-2 Memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri256\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 The\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 component\expnd-1\expndtw-6  \expnd0\expndtw0 enables\expnd-1\expndtw-6  \expnd0\expndtw0 compositional\expnd-1\expndtw-6  \expnd0\expndtw0 operations:\expnd-1\expndtw-6  \expnd0\expndtw0 binding,\expnd-1\expndtw-6  \expnd0\expndtw0 unbinding,\expnd-1\expndtw-6  \expnd0\expndtw0 and superposition of patterns with graceful degradation.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-2\expndtw-8  \expnd0\expndtw0 Computational\expnd-1\expndtw-7  \expnd0\expndtw-2 Complexity\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls19\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Forward\expnd-1\expndtw-7  \expnd0\expndtw0 pass**:\expnd-1\expndtw-5  \expnd0\expndtw0 O(L\'B7D\'B2)\expnd-1\expndtw-5  \expnd0\expndtw0 where\expnd-1\expndtw-4  \expnd0\expndtw0 L\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 sequence\expnd-1\expndtw-5  \expnd0\expndtw0 length,\expnd-1\expndtw-4  \expnd0\expndtw0 D\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 model\expnd-1\expndtw-4  \expnd0\expndtw-2 dimension\par\pard\plain\s2\ls19\ilvl1\nooverflow\nocwrap\lnbrkrule\li355\fi-133\sl240\slmult1\sb38\tx355\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba:\expnd-1\expndtw-5  \expnd0\expndtw0 O(L\'B7D)\expnd-1\expndtw-5  \expnd0\expndtw0 per\expnd-1\expndtw-5  \expnd0\expndtw0 layer\expnd-1\expndtw-5  \expnd0\expndtw0 (linear\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw-2 sequence\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8781\sl552\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-4\charscalex100 ``` \expnd0\expndtw-2 length)\par\pard\plain\s2\ls19\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hopfield:\expnd-1\expndtw-7  \expnd0\expndtw0 O(M\'B7D)\expnd-1\expndtw-4  \expnd0\expndtw0 where\expnd-1\expndtw-5  \expnd0\expndtw0 M\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 number\expnd-1\expndtw-4  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-4  \expnd0\expndtw-2 patterns\par\pard\plain\s2\ls19\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 DEQ:\expnd-1\expndtw-6  \expnd0\expndtw0 O(K\'B7L\'B7D\'B2)\expnd-1\expndtw-5  \expnd0\expndtw0 where\expnd-1\expndtw-5  \expnd0\expndtw0 K\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 convergence\expnd-1\expndtw-5  \expnd0\expndtw-2 iterations\par\pard\plain\s2\ls19\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Backward\expnd-1\expndtw-7  \expnd0\expndtw0 pass**:\expnd-1\expndtw-7  \expnd0\expndtw0 O(D\'B3)\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 implicit\expnd-1\expndtw-6  \expnd0\expndtw-2 differentiation\par\pard\plain\s2\ls19\ilvl1\nooverflow\nocwrap\lnbrkrule\li355\fi-133\sl240\slmult1\sb38\tx355\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-1\expndtw-6  \expnd0\expndtw0 conjugate\expnd-1\expndtw-6  \expnd0\expndtw0 gradient\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 avoid\expnd-1\expndtw-6  \expnd0\expndtw0 explicit\expnd-1\expndtw-6  \expnd0\expndtw-2 Jacobian\par\pard\plain\s2\ls19\ilvl1\nooverflow\nocwrap\lnbrkrule\li355\fi-133\sl240\slmult1\sb38\tx355\f2\fs22\b0\expnd0\expndtw0\charscalex100 Memory:\expnd-1\expndtw-6  \expnd0\expndtw0 O(D\'B2)\expnd-1\expndtw-5  \expnd0\expndtw0 instead\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw-2 O(K\'B7D\'B2)\par\pard\plain\s2\ls19\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri2113\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Memory\expnd-1\expndtw-6  \expnd0\expndtw0 storage**:\expnd-1\expndtw-6  \expnd0\expndtw0 O(M\'B7D)\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 patterns,\expnd-1\expndtw-6  \expnd0\expndtw0 independent\expnd-1\expndtw-6  \expnd0\expndtw0 of\expnd-1\expndtw-6  \expnd0\expndtw0 sequence\expnd-1\expndtw-6  \expnd0\expndtw0 length ## Comparison to Alternatives\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\tx1842\f2\fs22\b0\expnd0\expndtw-2\charscalex100 |Property\expnd0\expndtw0 \tab \expnd0\expndtw-2 |Transformer|Mamba|MHN-only|**Unified\expnd5\expndtw27  \expnd0\expndtw-2 (Ours)**|\par
{\shpgrp{\*\shpinst\shplid1884
\shpleft1497\shptop177\shpright6411\shpbottom197\shpfhdr0
\shpbxpage\shpbypara\shpwr3\shpwrk0\shpfblwtxt1\shpz8
\shpwr3\shpfblwtxt1{\sp{\sn groupLeft}{\sv 1497}}
{\sp{\sn groupTop}{\sv 177}}
{\sp{\sn groupRight}{\sv 6411}}
{\sp{\sn groupBottom}{\sv 197}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fBehindDocument}{\sv 1}}

{\shp{\*\shpinst\shplid1885
{\sp{\sn relLeft}{\sv 1497}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 3108}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 1611}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(1610,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}

{\shpgrp{\*\shpinst\shplid1886
{\sp{\sn groupLeft}{\sv 3164}}
{\sp{\sn groupTop}{\sv 187}}
{\sp{\sn groupRight}{\sv 6411}}
{\sp{\sn groupBottom}{\sv 188}}
{\sp{\sn relLeft}{\sv 3164}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 6411}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn fBehindDocument}{\sv 1}}

{\shp{\*\shpinst\shplid1886
{\sp{\sn relLeft}{\sv 3164}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 6411}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 3247}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(805,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}

{\shp{\*\shpinst\shplid1886
{\sp{\sn relLeft}{\sv 3164}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 6411}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 3247}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(862,0);(1228,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}

{\shp{\*\shpinst\shplid1886
{\sp{\sn relLeft}{\sv 3164}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 6411}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 3247}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(1285,0);(1871,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}

{\shp{\*\shpinst\shplid1886
{\sp{\sn relLeft}{\sv 3164}}
{\sp{\sn relTop}{\sv 187}}
{\sp{\sn relRight}{\sv 6411}}
{\sp{\sn relBottom}{\sv 188}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 3247}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(1928,0);(3246,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 2}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
}}
\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx1767\tx2630\tx3053\tx3695\tx5070\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 |\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3366\tx4665\tx6017\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Sequence\expnd-1\expndtw-6  \expnd0\expndtw0 complexity\expnd16\expndtw78\charscalex150  \expnd0\expndtw-2\charscalex100 |O(L\'B2)\expnd0\expndtw0 \tab |O(L)\expnd-1\expndtw-5  \expnd0\expndtw-2 |O(L)\expnd0\expndtw0 \tab \expnd0\expndtw-2 |O(L)\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2246\tx3280\tx6308\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Memory\expnd-1\expndtw-7  \expnd0\expndtw-2 capacity\expnd0\expndtw0 \tab \expnd0\expndtw-2 |O(L\'B7D)\expnd0\expndtw0 \tab |O(D)\expnd-1\expndtw-5  \expnd0\expndtw0 |O(M\'B7D)\expnd11\expndtw54  \expnd0\expndtw-2 |O(M\'B7D)\expnd0\expndtw0 \tab \expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb20\tx3065\tx3592\tx4301\tx5622\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Associative\expnd-2\expndtw-11  \expnd0\expndtw0 retrieval\expnd-2\expndtw-10  \expnd-1\expndtw-5 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb5\tx3041\tx3568\tx4277\tx5598\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Iterative\expnd-1\expndtw-6  \expnd0\expndtw0 reasoning\expnd16\expndtw78\charscalex150  \expnd-1\expndtw-5\charscalex100 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb5\tx3538\tx4793\tx6113\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Convergence\expnd-2\expndtw-12  \expnd0\expndtw-2 guarantees|N/A\expnd0\expndtw0 \tab |N/A\expnd11\expndtw55  \expnd-1\expndtw-5 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-5 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-2\expndtw-10 |\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3877\sl504\slmult1\sb5\tx2173\tx3066\tx3592\tx4302\tx5622\f2\fs22\b0\expnd0\expndtw0\charscalex100 |Continual learning\tab \expnd-1\expndtw-6 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-6 |\f3 \uc1\u10007 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-6 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-1\expndtw-6 |\f3 \uc1\u10003 ?\expnd0\expndtw0 \tab \f2\expnd-2\expndtw-10 | \expnd0\expndtw0 ## Key Innovations\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\sb49\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-5  \expnd0\expndtw0 **Unified\expnd-1\expndtw-5  \expnd0\expndtw0 optimization**:\expnd-1\expndtw-5  \expnd0\expndtw0 Single\expnd-1\expndtw-5  \expnd0\expndtw0 equilibrium\expnd-1\expndtw-5  \expnd0\expndtw0 satisfies\expnd-1\expndtw-5  \expnd0\expndtw0 both\expnd-1\expndtw-5  \expnd0\expndtw0 temporal\expnd-1\expndtw-5  \expnd0\expndtw0 consistency\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 memory \expnd0\expndtw-2 retrieval\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-9  \expnd0\expndtw0 **Implicit\expnd-1\expndtw-7  \expnd0\expndtw0 depth**:\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-7  \expnd0\expndtw0 wrapper\expnd-1\expndtw-7  \expnd0\expndtw0 provides\expnd-1\expndtw-6  \expnd0\expndtw0 unbounded\expnd-1\expndtw-7  \expnd0\expndtw0 reasoning\expnd-1\expndtw-7  \expnd0\expndtw0 depth\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-7  \expnd0\expndtw0 constant\expnd-1\expndtw-6  \expnd0\expndtw-2 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-11  \expnd0\expndtw0 **Compositional\expnd-2\expndtw-9  \expnd0\expndtw0 memory**:\expnd-2\expndtw-8  \expnd0\expndtw0 Hopfield\expnd-2\expndtw-9  \expnd0\expndtw0 enables\expnd-2\expndtw-8  \expnd0\expndtw0 structured\expnd-2\expndtw-9  \expnd0\expndtw0 knowledge\expnd-2\expndtw-8  \expnd0\expndtw-2 representation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2014\sl552\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 **Theoretical\expnd-1\expndtw-7  \expnd0\expndtw0 guarantees**:\expnd-1\expndtw-7  \expnd0\expndtw0 Provable\expnd-1\expndtw-7  \expnd0\expndtw0 convergence\expnd-1\expndtw-7  \expnd0\expndtw0 under\expnd-1\expndtw-7  \expnd0\expndtw0 mild\expnd-1\expndtw-7  \expnd0\expndtw0 conditions ## References\par\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba:\expnd-1\expndtw-5  \expnd0\expndtw0 Gu\expnd-1\expndtw-4  \expnd0\expndtw0 &\expnd-1\expndtw-4  \expnd0\expndtw0 Dao\expnd-1\expndtw-4  \expnd0\expndtw0 (2023)\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-4  \expnd0\expndtw0 Selective\expnd-1\expndtw-4  \expnd0\expndtw0 State\expnd-1\expndtw-4  \expnd0\expndtw0 Space\expnd-1\expndtw-4  \expnd0\expndtw-2 Models\par\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Modern\expnd-2\expndtw-9  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 Networks:\expnd-1\expndtw-7  \expnd0\expndtw0 Ramsauer\expnd-1\expndtw-6  \expnd0\expndtw0 et\expnd-1\expndtw-7  \expnd0\expndtw0 al.\expnd-1\expndtw-7  \expnd0\expndtw0 (2020)\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 Networks\expnd-1\expndtw-6  \expnd0\expndtw0 is\expnd-1\expndtw-7  \expnd0\expndtw0 All\expnd-1\expndtw-7  \expnd0\expndtw0 You\expnd-1\expndtw-6  \expnd-1\expndtw-4 Need\par\sect\sectd\sbkpage\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb80\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Deep\expnd-2\expndtw-8  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-5  \expnd0\expndtw0 Models:\expnd-1\expndtw-5  \expnd0\expndtw0 Bai\expnd-1\expndtw-5  \expnd0\expndtw0 et\expnd-1\expndtw-5  \expnd0\expndtw0 al.\expnd-1\expndtw-6  \expnd0\expndtw0 (2019)\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-5  \expnd0\expndtw0 Deep\expnd-1\expndtw-5  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-5  \expnd0\expndtw-2 Models\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 --\expnd-2\expndtw-12 -\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-8  \expnd0\expndtw0 **Step\expnd-1\expndtw-5  \expnd0\expndtw0 8.2:\expnd-1\expndtw-5  \expnd0\expndtw0 README\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 Examples\expnd-1\expndtw-5  \expnd0\expndtw-2 (README.md)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```markdown\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Unified\expnd-2\expndtw-9  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-2\expndtw-8  \expnd0\expndtw-2 Architecture\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 A\expnd-2\expndtw-10  \expnd0\expndtw0 research\expnd-1\expndtw-7  \expnd0\expndtw0 implementation\expnd-1\expndtw-7  \expnd0\expndtw0 unifying\expnd-2\expndtw-8  \expnd0\expndtw0 three\expnd-1\expndtw-7  \expnd0\expndtw0 powerful\expnd-1\expndtw-7  \expnd0\expndtw-2 paradigms:\par\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Mamba**:\expnd-2\expndtw-8  \expnd0\expndtw0 Efficient\expnd-1\expndtw-7  \expnd0\expndtw0 selective\expnd-2\expndtw-8  \expnd0\expndtw0 state\expnd-1\expndtw-7  \expnd0\expndtw0 space\expnd-1\expndtw-7  \expnd0\expndtw0 models\expnd-2\expndtw-8  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 sequence\expnd-1\expndtw-7  \expnd0\expndtw-2 processing\par\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Modern\expnd-2\expndtw-11  \expnd0\expndtw0 Hopfield\expnd-2\expndtw-8  \expnd0\expndtw0 Networks**:\expnd-2\expndtw-9  \expnd0\expndtw0 Associative\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-2\expndtw-9  \expnd0\expndtw0 with\expnd-2\expndtw-8  \expnd0\expndtw0 exponential\expnd-2\expndtw-8  \expnd0\expndtw-2 capacity\par\pard\plain\s2\ls20\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri1979\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Deep\expnd-1\expndtw-6  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-6  \expnd0\expndtw0 Models**:\expnd-1\expndtw-6  \expnd0\expndtw0 Implicit\expnd-1\expndtw-6  \expnd0\expndtw0 depth\expnd-1\expndtw-6  \expnd0\expndtw0 through\expnd-1\expndtw-6  \expnd0\expndtw0 fixed-point\expnd-1\expndtw-6  \expnd0\expndtw0 computation ## Installation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```bash\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2968\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 git\expnd-3\expndtw-16  \expnd0\expndtw0 clone\expnd-3\expndtw-15  \expnd0\expndtw0 https://github.com/your-repo/unified-mamba-hopfield-deq cd unified-mamba-hopfield-deq\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 pip\expnd-3\expndtw-14  \expnd0\expndtw0 install\expnd-3\expndtw-14  \expnd0\expndtw0 -r\expnd-3\expndtw-14  \expnd0\expndtw0 requirements.txt pip install -e .\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7719\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ## Quick Start ###\expnd-3\expndtw-16  \expnd0\expndtw0 Basic\expnd-3\expndtw-15  \expnd0\expndtw0 Usage\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8294\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python \expnd0\expndtw0 import\expnd-3\expndtw-16  \expnd0\expndtw0 torch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-10  \expnd0\expndtw0 src.models.unified\expnd-2\expndtw-9  \expnd0\expndtw0 import\expnd-2\expndtw-9  \expnd0\expndtw-2 UnifiedMambaHopfieldDEQ\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Initialize\expnd-1\expndtw-5  \expnd0\expndtw-2 model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 model\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedMambaHopfieldDEQ( \expnd0\expndtw-2 vocab_size=10000,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6841\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 d_model=512, d_state=64, memory_size=5000, solver_type='alternating'\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Forward\expnd-1\expndtw-4  pass\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 torch.randint(0,\expnd-1\expndtw-5  \expnd0\expndtw0 10000,\expnd-1\expndtw-5  \expnd0\expndtw0 (2,\expnd-1\expndtw-5  \expnd0\expndtw0 128))\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-5  \expnd0\expndtw0 (batch,\expnd-1\expndtw-5  \expnd0\expndtw0 seq_len) logits = model(input_ids)\expnd8\expndtw40  \expnd0\expndtw0 # (batch, seq_len, vocab_size)\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 With\expnd0\expndtw-2  diagnostics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2968\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits, diagnostics = model(input_ids, return_diagnostics=True) print(f"Converged: \'7Bdiagnostics['solver_info']['converged']\'7D") print(f"Iterations: \'7Bdiagnostics['solver_info']['iterations']\'7D") print(f"Final\expnd-3\expndtw-16  \expnd0\expndtw0 energy:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bdiagnostics['solver_info']['final_energy']:.4f\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-3  \expnd0\expndtw-2 Training\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-10  \expnd0\expndtw0 src.training.trainer\expnd-2\expndtw-10  \expnd0\expndtw0 import\expnd-2\expndtw-10  \expnd0\expndtw-2 UnifiedModelTrainer\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-11  \expnd0\expndtw0 src.training.objectives\expnd-2\expndtw-11  \expnd0\expndtw0 import\expnd-2\expndtw-11  \expnd0\expndtw-2 UnifiedTrainingObjective\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Setup\expnd-1\expndtw-3  \expnd0\expndtw-2 training\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5875\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 objective\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedTrainingObjective( \expnd0\expndtw-2 task_weight=1.0, energy_weight=0.1, convergence_weight=0.05\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 trainer\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedModelTrainer( \expnd0\expndtw-2 model=model,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3319\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 optimizer=torch.optim.AdamW(model.parameters(),\expnd-3\expndtw-16  \expnd0\expndtw0 lr=1e-4), \expnd0\expndtw-2 train_loader=train_loader,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 val_loader=val_loader, objective=objective\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Train with curriculum \expnd0\expndtw-2 trainer.train(num_epochs=10)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-3  \expnd0\expndtw-2 Generation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6547\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Autoregressive generation prompt\expnd-2\expndtw-8  \expnd0\expndtw0 =\expnd-2\expndtw-8  \expnd0\expndtw0 "Once\expnd-2\expndtw-8  \expnd0\expndtw0 upon\expnd-2\expndtw-8  \expnd0\expndtw0 a\expnd-2\expndtw-8  \expnd0\expndtw0 time"\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 prompt_ids\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 tokenizer.encode(prompt)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 prompt_tensor\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw-2 torch.tensor(prompt_ids).unsqueeze(0)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 generated\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 model.generate( \expnd0\expndtw-2 prompt_tensor, max_length=100,\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri7378\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 temperature=0.8, top_k=50\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print(tokenizer.decode(generated[0]))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6953\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-3\expndtw-16  \expnd0\expndtw0 Architecture\expnd-3\expndtw-15  \expnd0\expndtw0 Details ### Information Flow\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Input\expnd-1\expndtw-5  \expnd0\expndtw-2 Tokens\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\fi244\ri8060\sl276\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ? \expnd0\expndtw-2 Embedding\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mamba\expnd-2\expndtw-9  \expnd0\expndtw0 Layers\expnd-1\expndtw-6  \expnd0\expndtw0 (process\expnd-1\expndtw-6  \expnd0\expndtw-2 sequence)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb20\f2\fs22\b0\expnd0\expndtw0\charscalex100 Extract\expnd-1\expndtw-6  \expnd0\expndtw0 State\expnd-1\expndtw-6  \expnd-1\expndtw-5 z\f3 \uc1\u8320 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb23\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 \uc1\u9484 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9488 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3010\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd11\expndtw53  \expnd0\expndtw0 DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-3  \expnd0\expndtw-2 Finding\expnd0\expndtw0 \tab \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2008\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u9474 ?\expnd0\expndtw0 \tab \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd10\expndtw51  \expnd0\expndtw0 Iterate\expnd-1\expndtw-5  \expnd0\expndtw0 until\expnd-1\expndtw-5  \expnd0\expndtw0 convergence:\expnd-1\expndtw-5  \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd11\expndtw55  \expnd0\expndtw0 1.\expnd-1\expndtw-3  \expnd0\expndtw0 Query\expnd-1\expndtw-3  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-3  \expnd0\expndtw0 memory\expnd5\expndtw26   \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3011\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd11\expndtw55  \expnd0\expndtw0 2.\expnd-1\expndtw-3  \expnd0\expndtw0 Update\expnd0\expndtw-2  \expnd0\expndtw0 Mamba\expnd-1\expndtw-3  \expnd0\expndtw-2 state\expnd0\expndtw0 \tab \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2840\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd11\expndtw54  \expnd0\expndtw0 3.\expnd-1\expndtw-3  \expnd0\expndtw0 Compute\expnd0\expndtw-2  energy\expnd0\expndtw0 \tab \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2974\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd11\expndtw57  \expnd0\expndtw0 4.\expnd0\expndtw-2  \expnd0\expndtw0 Check\expnd0\expndtw-2  convergence\expnd0\expndtw0 \tab \expnd-2\expndtw-10 \uc1\u9474 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9472 ?\uc1\u9496 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Equilibrium\expnd-2\expndtw-8  \expnd0\expndtw0 State\expnd-2\expndtw-8  \expnd-1\expndtw-5 z*\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb37\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 Output\expnd-1\expndtw-6  \expnd0\expndtw-2 Projection\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\fi244\ri8864\sl276\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u8595 ? \expnd0\expndtw-2 Logits\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-5  \expnd0\expndtw0 Solver\expnd-1\expndtw-4  \expnd0\expndtw-2 Options\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Three\expnd-1\expndtw-6  \expnd0\expndtw0 solver\expnd-1\expndtw-5  \expnd0\expndtw0 modes\expnd-1\expndtw-5  \expnd0\expndtw-2 available:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls21\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Alternating**\expnd-2\expndtw-11  \expnd0\expndtw0 (default):\expnd-2\expndtw-9  \expnd0\expndtw0 Alternates\expnd-2\expndtw-9  \expnd0\expndtw0 between\expnd-2\expndtw-9  \expnd0\expndtw0 fixed-point\expnd-2\expndtw-9  \expnd0\expndtw0 and\expnd-2\expndtw-9  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw-2 descent\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls21\ilvl1\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Best\expnd-1\expndtw-4  \expnd0\expndtw0 for\expnd-1\expndtw-3  \expnd0\expndtw-2 stability\par\sect\sectd\sbkpage\pard\plain\s2\ls21\ilvl1\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb80\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Slower\expnd-1\expndtw-6  \expnd0\expndtw-2 convergence\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s2\ls22\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb1\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Simultaneous**:\expnd-2\expndtw-12  \expnd0\expndtw0 Jointly\expnd-2\expndtw-9  \expnd0\expndtw0 optimizes\expnd-2\expndtw-9  \expnd0\expndtw0 both\expnd-2\expndtw-9  \expnd0\expndtw-2 objectives\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s2\ls22\ilvl1\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Faster\expnd-1\expndtw-6  \expnd0\expndtw-2 convergence\par\pard\plain\s2\ls22\ilvl1\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Requires\expnd-2\expndtw-10  \expnd0\expndtw0 careful\expnd-2\expndtw-10  \expnd0\expndtw0 hyperparameter\expnd-2\expndtw-9  \expnd0\expndtw-2 tuning\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls23\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Cascade**:\expnd-2\expndtw-8  \expnd0\expndtw0 Fixed-point\expnd-2\expndtw-8  \expnd0\expndtw0 first,\expnd-2\expndtw-8  \expnd0\expndtw0 then\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw-2 refinement\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls23\ilvl1\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Good\expnd-1\expndtw-7  \expnd0\expndtw0 when\expnd-1\expndtw-6  \expnd0\expndtw0 objectives\expnd-1\expndtw-7  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw0 well-\expnd0\expndtw-2 aligned\par\pard\plain\s2\ls23\ilvl1\nooverflow\nocwrap\lnbrkrule\li100\ri6639\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Most\expnd-2\expndtw-11  \expnd0\expndtw0 efficient\expnd-2\expndtw-11  \expnd0\expndtw0 when\expnd-2\expndtw-11  \expnd0\expndtw0 it\expnd-2\expndtw-11  \expnd0\expndtw0 works ## Experiments\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6487\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ### 1. Theoretical Validation Verify\expnd-3\expndtw-16  \expnd0\expndtw0 convergence\expnd-3\expndtw-15  \expnd0\expndtw0 properties:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 from\expnd2\expndtw10  \expnd0\expndtw-2 experiments.theory.convergence_proofs\expnd2\expndtw10  \expnd0\expndtw-2 import\expnd2\expndtw11  \expnd0\expndtw-2 ConvergenceValidator\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5466\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 validator\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 ConvergenceValidator(model) results = validator.run_all_tests()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-10  \expnd0\expndtw0 2.\expnd-2\expndtw-10  \expnd0\expndtw0 Energy\expnd-2\expndtw-10  \expnd0\expndtw0 Landscape\expnd-2\expndtw-10  \expnd0\expndtw0 Analysis Visualize energy surfaces:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 from\expnd2\expndtw9  \expnd0\expndtw-2 experiments.theory.energy_analysis\expnd2\expndtw9  \expnd0\expndtw-2 import\expnd2\expndtw10  \expnd0\expndtw-2 EnergyLandscapeAnalyzer\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 analyzer = EnergyLandscapeAnalyzer(model) analyzer.visualize_2d_slice(z_equilibrium, context) \expnd0\expndtw-2 analyzer.visualize_convergence_trajectories() analyzer.visualize_basin_of_attraction(z_equilibrium, context)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6953\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-10  \expnd0\expndtw0 3.\expnd-2\expndtw-10  \expnd0\expndtw0 Associative\expnd-2\expndtw-10  \expnd0\expndtw0 Recall \expnd0\expndtw-2 Test\expnd-1\expndtw-7  \expnd0\expndtw-2 memory\expnd-1\expndtw-7  \expnd0\expndtw-2 capabilities:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-3\expndtw-14  \expnd0\expndtw0 experiments.tasks.memory_tasks\expnd-3\expndtw-13  \expnd0\expndtw0 import\expnd-3\expndtw-13  \expnd0\expndtw-2 AssociativeRecallExperiment\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4507\sl276\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 experiment\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-12  \expnd0\expndtw0 AssociativeRecallExperiment(model) accuracies\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 experiment.evaluate(num_trials=100)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6311\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ### 4. Continual Learning Measure\expnd-3\expndtw-16  \expnd0\expndtw0 catastrophic\expnd-3\expndtw-15  \expnd0\expndtw0 forgetting:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-3\expndtw-14  \expnd0\expndtw0 experiments.tasks.memory_tasks\expnd-3\expndtw-13  \expnd0\expndtw0 import\expnd-3\expndtw-13  \expnd0\expndtw-2 ContinualLearningExperiment\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2558\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 experiment\expnd-3\expndtw-15  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 ContinualLearningExperiment(model,\expnd-3\expndtw-15  \expnd0\expndtw0 num_tasks=5) history = experiment.run_continual_learning()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd0\expndtw-2  Configuration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Key\expnd-1\expndtw-5  \expnd0\expndtw-2 hyperparameters:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri8545\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python \expnd0\expndtw0 config\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-3  \expnd0\expndtw0 Model\expnd-1\expndtw-3  \expnd0\expndtw-2 architecture\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4803\sl276\slmult1\sb38\tx2493\tx2676\f2\fs22\b0\expnd0\expndtw0\charscalex100 'd_model': 512,\tab \tab # Hidden dimension 'd_state': 64,\tab #\expnd-3\expndtw-13  \expnd0\expndtw0 SSM\expnd-3\expndtw-13  \expnd0\expndtw0 state\expnd-3\expndtw-13  \expnd0\expndtw0 dimension\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4425\sl276\slmult1\tx2480\f2\fs22\b0\expnd0\expndtw0\charscalex100 'd_conv': 4,\tab # Convolution width 'n_layers': 6,\tab #\expnd-2\expndtw-10  \expnd0\expndtw0 Number\expnd-2\expndtw-10  \expnd0\expndtw0 of\expnd-2\expndtw-10  \expnd0\expndtw0 Mamba\expnd-2\expndtw-10  \expnd0\expndtw0 layers\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3630\sl276\slmult1\sb38\tx2383\tx3018\f2\fs22\b0\expnd0\expndtw0\charscalex100 'memory_size': 10000,\tab #\expnd-2\expndtw-10  \expnd0\expndtw0 Number\expnd-2\expndtw-10  \expnd0\expndtw0 of\expnd-2\expndtw-10  \expnd0\expndtw0 storable\expnd-2\expndtw-10  \expnd0\expndtw0 patterns 'beta': 2.0,\tab # Hopfield inverse temperature\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6708\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # DEQ solver 'solver_type':\expnd-3\expndtw-16  \expnd0\expndtw0 'alternating', 'max_iterations': 30, 'tol_fixedpoint': 1e-3, 'tol_energy': 1e-3,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb245\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri7220\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 # Training 'learning_rate':\expnd-3\expndtw-16  \expnd0\expndtw0 1e-4, 'batch_size': 32,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'gradient_clip':\expnd3\expndtw16  \expnd-1\expndtw-5 1.0\par\sect\sectd\sbkpage\margtsxn1660\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7183\sl552\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 ## Performance Tips ###\expnd-3\expndtw-16  \expnd0\expndtw0 Memory\expnd-3\expndtw-15  \expnd0\expndtw0 Efficiency\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1159\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Enable gradient checkpointing \expnd0\expndtw-2 model.dynamics.mamba.gradient_checkpointing_enable()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Limit convergence iterations during training model.solver.max_iter\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 10\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-2\expndtw-9  \expnd0\expndtw0 Increase\expnd-2\expndtw-9  \expnd0\expndtw0 gradually\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Use\expnd-1\expndtw-3  \expnd0\expndtw0 mixed\expnd-1\expndtw-3  \expnd0\expndtw-2 precision\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-9  \expnd0\expndtw0 torch.cuda.amp\expnd-2\expndtw-8  \expnd0\expndtw0 import\expnd-2\expndtw-8  \expnd0\expndtw0 autocast,\expnd-2\expndtw-8  \expnd0\expndtw-2 GradScaler\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7183\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 scaler\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 GradScaler() with autocast():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 model(input_ids)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-5  \expnd0\expndtw0 Faster\expnd-1\expndtw-4  \expnd0\expndtw-2 Convergence\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-13  \expnd0\expndtw0 Warm-start\expnd-3\expndtw-13  \expnd0\expndtw0 with\expnd-3\expndtw-13  \expnd0\expndtw0 previous\expnd-3\expndtw-13  \expnd0\expndtw0 equilibrium previous_z = None\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-1\expndtw-4  \expnd0\expndtw0 batch\expnd-1\expndtw-3  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw-2 dataloader:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits,\expnd-2\expndtw-11  \expnd0\expndtw0 diagnostics\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 model(batch,\expnd-2\expndtw-11  \expnd0\expndtw0 z_init=previous_z) previous_z = diagnostics['z_equilibrium'].detach()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-5  \expnd0\expndtw0 Better\expnd-1\expndtw-4  \expnd0\expndtw-2 Stability\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-5  \expnd0\expndtw0 Increase\expnd-1\expndtw-4  \expnd0\expndtw-2 regularization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 objective\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 UnifiedTrainingObjective(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 stability_weight=0.1,\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-2\expndtw-9  \expnd0\expndtw0 Encourage\expnd-2\expndtw-9  \expnd0\expndtw0 contractive\expnd-2\expndtw-9  \expnd0\expndtw0 dynamics \expnd0\expndtw-2 contraction_target=0.8\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Reduce\expnd-1\expndtw-7  \expnd0\expndtw0 learning\expnd-1\expndtw-7  \expnd0\expndtw0 rate\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 patterns optimizer = torch.optim.AdamW([\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 \'7B'params':\expnd-2\expndtw-8  \expnd0\expndtw0 [p\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 n,\expnd-1\expndtw-5  \expnd0\expndtw0 p\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-6  \expnd0\expndtw0 model.named_parameters()\expnd-1\expndtw-5  \expnd0\expndtw0 if\expnd-1\expndtw-5  \expnd0\expndtw0 'memory'\expnd-1\expndtw-6  \expnd0\expndtw0 not\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd-1\expndtw-4 n]\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \'7B'params':\expnd-3\expndtw-14  \expnd0\expndtw0 [model.memory_patterns],\expnd-3\expndtw-14  \expnd0\expndtw0 'lr':\expnd-3\expndtw-14  \expnd0\expndtw0 1e-\expnd-1\expndtw-5 5\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ],\expnd-2\expndtw-8  \expnd0\expndtw0 lr=1e-\expnd-1\expndtw-5 4)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd0\expndtw-2  Troubleshooting\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-5  \expnd0\expndtw0 Issue:\expnd-1\expndtw-5  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw0 doesn\'92t\expnd-1\expndtw-4  \expnd0\expndtw-2 converge\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Solutions:**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Reduce\expnd-2\expndtw-8  \expnd0\expndtw0 `max_iter`\expnd-1\expndtw-7  \expnd0\expndtw0 initially\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 gradually\expnd-1\expndtw-7  \expnd0\expndtw-2 increase\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Increase\expnd-2\expndtw-9  \expnd0\expndtw0 `tolerance`\expnd-2\expndtw-8  \expnd0\expndtw0 during\expnd-2\expndtw-8  \expnd0\expndtw-2 warmup\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Check\expnd-2\expndtw-8  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-5  \expnd0\expndtw0 constant\expnd-1\expndtw-5  \expnd0\expndtw0 (should\expnd-1\expndtw-6  \expnd0\expndtw0 be\expnd-1\expndtw-5  \expnd0\expndtw0 <\expnd-1\expndtw-5  1)\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri6757\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Add\expnd-3\expndtw-16  \expnd0\expndtw0 stability\expnd-3\expndtw-15  \expnd0\expndtw0 regularization ### Issue: NaN losses\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Solutions:**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Enable\expnd-2\expndtw-8  \expnd0\expndtw0 gradient\expnd-1\expndtw-7  \expnd0\expndtw0 clipping\expnd-1\expndtw-7  \expnd0\expndtw-2 (max_norm=1.0)\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Reduce\expnd-2\expndtw-9  \expnd0\expndtw0 learning\expnd-1\expndtw-7  \expnd-1\expndtw-4 rate\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Check\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 function\expnd-1\expndtw-6  \expnd0\expndtw0 components\expnd-1\expndtw-5  \expnd0\expndtw0 (one\expnd-1\expndtw-6  \expnd0\expndtw0 might\expnd-1\expndtw-6  \expnd0\expndtw0 be\expnd-1\expndtw-5  \expnd0\expndtw-2 exploding)\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri6305\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Use\expnd-3\expndtw-13  \expnd0\expndtw0 mixed\expnd-3\expndtw-13  \expnd0\expndtw0 precision\expnd-3\expndtw-13  \expnd0\expndtw0 cautiously ### Issue: Slow training\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Solutions:**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Reduce\expnd-1\expndtw-7  \expnd0\expndtw0 `max_iter`\expnd-1\expndtw-6  \expnd0\expndtw0 (quality\expnd-1\expndtw-6  \expnd0\expndtw0 vs\expnd-1\expndtw-6  \expnd0\expndtw0 speed\expnd-1\expndtw-6  \expnd0\expndtw-2 tradeoff)\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Use\expnd-2\expndtw-8  \expnd0\expndtw0 \'91cascade\'92\expnd-1\expndtw-6  \expnd0\expndtw0 solver\expnd-1\expndtw-6  \expnd0\expndtw0 (faster\expnd-1\expndtw-6  \expnd0\expndtw0 than\expnd-1\expndtw-5  \expnd0\expndtw-2 \'91alternating\'92)\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Enable\expnd-1\expndtw-7  \expnd0\expndtw0 gradient\expnd-1\expndtw-7  \expnd0\expndtw-2 checkpointing\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri5844\sl552\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Batch\expnd-3\expndtw-15  \expnd0\expndtw0 multiple\expnd-3\expndtw-15  \expnd0\expndtw0 sequences\expnd-3\expndtw-15  \expnd0\expndtw0 efficiently ## Citation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 If\expnd-1\expndtw-7  \expnd0\expndtw0 you\expnd-1\expndtw-4  \expnd0\expndtw0 use\expnd-1\expndtw-4  \expnd0\expndtw0 this\expnd-1\expndtw-4  \expnd0\expndtw0 code\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-4  \expnd0\expndtw0 your\expnd-1\expndtw-4  \expnd0\expndtw0 research,\expnd-1\expndtw-4  \expnd0\expndtw0 please\expnd-1\expndtw-4  \expnd0\expndtw-2 cite:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```bibtex @software\'7Bunified_mamba_hopfield_deq,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li222\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 title=\'7BUnified\expnd-3\expndtw-16  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-3\expndtw-15  \expnd0\expndtw0 Architecture\'7D, author=\'7BYour Name\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li222\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 year=\'7B2024\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li222\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw-2\charscalex100 url=\'7Bhttps://github.com/your-repo/unified-mamba-hopfield-\expnd-1\expndtw-4 deq\'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd0\expndtw-2  License\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5224\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 MIT\expnd-1\expndtw-6  \expnd0\expndtw0 License\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw0 see\expnd-1\expndtw-6  \expnd0\expndtw0 LICENSE\expnd-1\expndtw-6  \expnd0\expndtw0 file\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 details ## Acknowledgments\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Built\expnd-1\expndtw-4  \expnd0\expndtw0 on\expnd-1\expndtw-3  \expnd0\expndtw0 top\expnd-1\expndtw-3  \expnd-1\expndtw-5 of:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 [Mamba](https://github.com/state-spaces/mamba)\expnd-3\expndtw-15  \expnd0\expndtw0 by\expnd-3\expndtw-13  \expnd0\expndtw0 Gu\expnd-3\expndtw-13  \expnd0\expndtw0 &\expnd-2\expndtw-12  \expnd-1\expndtw-5 Dao\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Modern\expnd-2\expndtw-8  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 Networks\expnd-1\expndtw-6  \expnd0\expndtw0 theory\expnd-1\expndtw-5  \expnd0\expndtw0 by\expnd-1\expndtw-6  \expnd0\expndtw0 Ramsauer\expnd-1\expndtw-6  \expnd0\expndtw0 et\expnd-1\expndtw-5  al.\par\pard\plain\s2\ls24\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 framework\expnd-1\expndtw-4  \expnd0\expndtw0 by\expnd-1\expndtw-4  \expnd0\expndtw0 Bai\expnd-1\expndtw-4  \expnd0\expndtw0 et\expnd-1\expndtw-3  \expnd-1\expndtw-5 al.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 --\expnd-2\expndtw-12 -\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ####\expnd-2\expndtw-8  \expnd0\expndtw0 **Step\expnd-1\expndtw-6  \expnd0\expndtw0 8.3:\expnd-1\expndtw-6  \expnd0\expndtw0 Interactive\expnd-1\expndtw-6  \expnd0\expndtw0 Demo\expnd-1\expndtw-5  \expnd0\expndtw-2 (notebooks/demo.ipynb)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7862\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-13  \expnd0\expndtw0 Cell\expnd-3\expndtw-13  \expnd0\expndtw0 1:\expnd-3\expndtw-13  \expnd0\expndtw0 Setup \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Unified\expnd-2\expndtw-9  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-2\expndtw-8  \expnd-1\expndtw-4 Demo\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2014\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 This\expnd-1\expndtw-5  \expnd0\expndtw0 notebook\expnd-1\expndtw-5  \expnd0\expndtw0 demonstrates\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 key\expnd-1\expndtw-5  \expnd0\expndtw0 capabilities\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 unified\expnd-1\expndtw-5  \expnd0\expndtw0 architecture. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 import\expnd-2\expndtw-8  \expnd0\expndtw-2 torch\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 import\expnd-1\expndtw-5  \expnd0\expndtw0 numpy\expnd-1\expndtw-4  \expnd0\expndtw0 as\expnd-1\expndtw-4  \expnd-1\expndtw-5 np\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 import\expnd-2\expndtw-9  \expnd0\expndtw0 matplotlib.pyplot\expnd-2\expndtw-8  \expnd0\expndtw0 as\expnd-2\expndtw-8  \expnd-1\expndtw-5 plt\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3492\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 from src.models.unified import UnifiedMambaHopfieldDEQ from\expnd-3\expndtw-16  \expnd0\expndtw0 src.analysis.convergence\expnd-3\expndtw-15  \expnd0\expndtw0 import\expnd-3\expndtw-15  \expnd0\expndtw0 ConvergenceValidator\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-3\expndtw-13  \expnd0\expndtw0 src.analysis.energy_landscape\expnd-3\expndtw-13  \expnd0\expndtw0 import\expnd-3\expndtw-13  \expnd0\expndtw-2 EnergyLandscapeAnalyzer\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Initialize\expnd-1\expndtw-5  \expnd0\expndtw-2 model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 model\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 UnifiedMambaHopfieldDEQ( \expnd0\expndtw-2 vocab_size=1000,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6953\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 d_model=128, d_state=32, memory_size=500, max_iterations=20\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-253\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Model\expnd-2\expndtw-12  \expnd0\expndtw-2 initialized!")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Parameters:\expnd-2\expndtw-10  \expnd0\expndtw0 \'7Bsum(p.numel()\expnd-2\expndtw-8  \expnd0\expndtw0 for\expnd-2\expndtw-8  \expnd0\expndtw0 p\expnd-2\expndtw-8  \expnd0\expndtw0 in\expnd-1\expndtw-7  \expnd0\expndtw-2 model.parameters()):,\'7D")\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6547\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Cell\expnd-2\expndtw-8  \expnd0\expndtw0 2:\expnd-2\expndtw-8  \expnd0\expndtw0 Basic\expnd-2\expndtw-8  \expnd0\expndtw0 Forward\expnd-2\expndtw-8  \expnd0\expndtw0 Pass \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-4  \expnd0\expndtw0 Basic\expnd-1\expndtw-3  \expnd0\expndtw-2 Usage\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3492\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Let's\expnd-1\expndtw-5  \expnd0\expndtw0 run\expnd-1\expndtw-5  \expnd0\expndtw0 a\expnd-1\expndtw-5  \expnd0\expndtw0 simple\expnd-1\expndtw-5  \expnd0\expndtw0 forward\expnd-1\expndtw-5  \expnd0\expndtw0 pass\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw0 examine\expnd-1\expndtw-5  \expnd0\expndtw0 the\expnd-1\expndtw-5  \expnd0\expndtw0 equilibrium. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Create\expnd-1\expndtw-4  \expnd0\expndtw0 dummy\expnd-1\expndtw-4  \expnd0\expndtw-2 input\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 torch.randint(0,\expnd-1\expndtw-7  \expnd0\expndtw0 1000,\expnd-1\expndtw-7  \expnd0\expndtw0 (1,\expnd-1\expndtw-6  \expnd-1\expndtw-4 20))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Forward\expnd-1\expndtw-4  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw-2 diagnostics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits,\expnd-1\expndtw-7  \expnd0\expndtw0 diag\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 model(input_ids,\expnd-1\expndtw-7  \expnd0\expndtw-2 return_diagnostics=True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Forward\expnd-2\expndtw-9  \expnd0\expndtw0 pass\expnd-2\expndtw-9  \expnd0\expndtw-2 complete!")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3761\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Converged: \'7Bdiag['solver_info']['converged']\'7D") print(f"Iterations: \'7Bdiag['solver_info']['iterations']\'7D") print(f"Final\expnd-3\expndtw-16  \expnd0\expndtw0 energy:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bdiag['solver_info']['final_energy']:.4f\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-7  \expnd0\expndtw0 Visualize\expnd-1\expndtw-7  \expnd0\expndtw-2 convergence\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4680\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 if 'energy_history' in diag['solver_info']: plt.figure(figsize=(10, 4)) plt.plot(diag['solver_info']['energy_history'],\expnd-3\expndtw-16  \expnd0\expndtw0 'o-') \expnd0\expndtw-2 plt.xlabel('Iteration')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.ylabel('Energy')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.title('Energy\expnd-3\expndtw-16  \expnd0\expndtw0 During\expnd-3\expndtw-15  \expnd0\expndtw0 Convergence') plt.grid(True, alpha=0.3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.show()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Cell\expnd-2\expndtw-10  \expnd0\expndtw0 3:\expnd-2\expndtw-10  \expnd0\expndtw0 Memory\expnd-2\expndtw-10  \expnd0\expndtw0 Operations \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-4  \expnd0\expndtw0 Memory\expnd-1\expndtw-4  \expnd0\expndtw-2 Dynamics\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3818\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Examine\expnd-1\expndtw-6  \expnd0\expndtw0 how\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-6  \expnd0\expndtw0 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 are\expnd-1\expndtw-6  \expnd0\expndtw0 stored\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 retrieved. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Check current memory usage memory_stats\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 diag['memory_usage']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2313\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Memory\expnd-3\expndtw-15  \expnd0\expndtw0 attention\expnd-3\expndtw-15  \expnd0\expndtw0 entropy:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bmemory_stats['attention_entropy']:.4f\'7D") print(f"Top-10 pattern mass: \'7Bmemory_stats['top_10_mass']:.4f\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5925\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-11  \expnd0\expndtw0 Visualize\expnd-2\expndtw-11  \expnd0\expndtw0 attention\expnd-2\expndtw-11  \expnd0\expndtw0 over\expnd-2\expndtw-11  \expnd0\expndtw0 memory z_eq = diag['z_equilibrium']\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 similarities\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 torch.matmul(z_eq,\expnd-2\expndtw-10  \expnd0\expndtw-2 model.memory_patterns.T)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 torch.softmax(similarities,\expnd-3\expndtw-14  \expnd0\expndtw0 dim=-\expnd-1\expndtw-5 1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.figure(figsize=(12,\expnd5\expndtw23  \expnd-1\expndtw-5 4))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.subplot(1,\expnd-2\expndtw-8  \expnd0\expndtw0 2,\expnd-2\expndtw-8  \expnd-1\expndtw-5 1)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3818\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.bar(range(len(attention[0])),\expnd-3\expndtw-16  \expnd0\expndtw0 attention[0].cpu().numpy()) plt.xlabel('Memory Pattern Index')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.ylabel('Attention Weight') plt.title('Memory\expnd-3\expndtw-16  \expnd0\expndtw0 Retrieval\expnd-3\expndtw-15  \expnd0\expndtw0 Pattern')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.subplot(1,\expnd-2\expndtw-8  \expnd0\expndtw0 2,\expnd-2\expndtw-8  \expnd-1\expndtw-5 2)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 top_k\expnd-1\expndtw-3  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-1\expndtw-5 20\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 top_indices\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 attention[0].topk(top_k).indices.cpu().numpy() top_values = attention[0].topk(top_k).values.cpu().numpy() plt.barh(range(top_k), top_values)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6742\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.xlabel('Attention\expnd-3\expndtw-16  \expnd0\expndtw0 Weight') plt.ylabel('Pattern Rank')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.title(f'Top\expnd-3\expndtw-16  \expnd0\expndtw0 \'7Btop_k\'7D\expnd-3\expndtw-15  \expnd0\expndtw0 Retrieved\expnd-3\expndtw-15  \expnd0\expndtw0 Patterns') \expnd0\expndtw-2 plt.gca().invert_yaxis()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7378\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.tight_layout() plt.show()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6311\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-10  \expnd0\expndtw0 Cell\expnd-2\expndtw-10  \expnd0\expndtw0 4:\expnd-2\expndtw-10  \expnd0\expndtw0 Convergence\expnd-2\expndtw-10  \expnd0\expndtw0 Analysis \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Theoretical\expnd-1\expndtw-6  \expnd0\expndtw-2 Validation\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Test\expnd-1\expndtw-3  \expnd0\expndtw-2 convergence\expnd-1\expndtw-3  \expnd0\expndtw-2 properties\expnd-1\expndtw-3  \expnd0\expndtw-2 empirically. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 validator\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 ConvergenceValidator(model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Running convergence tests...") \expnd0\expndtw-2 print("\'5Cn1. Testing contraction property...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 contraction_results\expnd-2\expndtw-12  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw-2 validator.test_contraction_property(num_samples=20)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("\'5Cn2.\expnd0\expndtw0  \expnd0\expndtw-2 Testing\expnd0\expndtw0  \expnd0\expndtw-2 energy\expnd0\expndtw0  \expnd0\expndtw-2 descent...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 descent_results\expnd3\expndtw16  \expnd0\expndtw-2 =\expnd4\expndtw18  \expnd0\expndtw-2 validator.test_energy_descent(num_trajectories=10,\expnd4\expndtw18  \expnd0\expndtw-2 num_steps=20)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("\'5Cn3.\expnd0\expndtw1  \expnd0\expndtw-2 Testing\expnd0\expndtw2  \expnd0\expndtw-2 fixed-point\expnd0\expndtw2  \expnd0\expndtw-2 stability...")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 stability_results\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw-2 validator.test_fixed_point_stability(num_fixed_points=5)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6547\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("\'5Cn" + "="*50) \expnd0\expndtw-2 print("RESULTS\expnd-3\expndtw-14  \expnd0\expndtw-2 SUMMARY")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("="*50)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb20\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\f3 \uc1\u10003 ?\expnd-2\expndtw-11  \f2\expnd0\expndtw0 Contraction:\expnd-2\expndtw-10  \expnd0\expndtw-2 \'7Bcontraction_results['is_contraction']\'7D")\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2377\sl244\slmult1\sb62\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"\f3 \uc1\u10003 ?\expnd-3\expndtw-16  \f2\expnd0\expndtw0 Energy\expnd-3\expndtw-15  \expnd0\expndtw0 Descent:\expnd-3\expndtw-15  \expnd0\expndtw0 \'7Bdescent_results['monotonic_descent']\'7D") print(f"\f3 \uc1\u10003 ? \f2 Stability: \'7Bstability_results['is_stable']\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb54\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6749\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-11  \expnd0\expndtw0 Cell\expnd-2\expndtw-11  \expnd0\expndtw0 5:\expnd-2\expndtw-11  \expnd0\expndtw0 Energy\expnd-2\expndtw-11  \expnd0\expndtw0 Landscape \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-6  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 Landscape\expnd-1\expndtw-5  \expnd0\expndtw-2 Visualization\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4347\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Visualize\expnd-2\expndtw-8  \expnd0\expndtw0 the\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw0 surface\expnd-2\expndtw-8  \expnd0\expndtw0 around\expnd-2\expndtw-8  \expnd0\expndtw0 an\expnd-2\expndtw-8  \expnd0\expndtw0 equilibrium. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl-582\sb32\f2\fs22\b0\expnd0\expndtw0\charscalex100 analyzer\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 EnergyLandscapeAnalyzer(model) # Get an equilibrium point\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-221\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4836\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_init = torch.randn(1, model.d_model) context\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randn(1,\expnd-2\expndtw-11  \expnd0\expndtw0 10,\expnd-2\expndtw-11  \expnd0\expndtw0 model.d_model)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq,\expnd-2\expndtw-11  \expnd0\expndtw0 _\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-10  \expnd0\expndtw0 model.solver.solve(z_init,\expnd-2\expndtw-11  \expnd0\expndtw0 context,\expnd-2\expndtw-10  \expnd0\expndtw-2 model.memory_patterns)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Visualize\expnd-1\expndtw-5  \expnd0\expndtw0 2D\expnd-1\expndtw-5  \expnd0\expndtw-2 slice\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Computing\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 landscape\expnd-1\expndtw-6  \expnd0\expndtw0 (this\expnd-1\expndtw-6  \expnd0\expndtw0 may\expnd-1\expndtw-6  \expnd0\expndtw0 take\expnd-1\expndtw-6  \expnd0\expndtw0 a\expnd-1\expndtw-6  \expnd0\expndtw0 minute)...") energies, residuals = analyzer.visualize_2d_slice(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 z_eq,\expnd-2\expndtw-9  \expnd0\expndtw0 context,\expnd-2\expndtw-9  \expnd0\expndtw0 resolution=30,\expnd-2\expndtw-9  \expnd0\expndtw-2 radius=2.0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5634\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 print("Landscape\expnd-3\expndtw-16  \expnd0\expndtw0 visualization\expnd-3\expndtw-15  \expnd0\expndtw0 saved!") # Cell 6: Associative Memory Test\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb40\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Associative\expnd-1\expndtw-6  \expnd0\expndtw0 Memory\expnd-1\expndtw-6  \expnd0\expndtw-2 Capabilities\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri7048\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Test\expnd-2\expndtw-9  \expnd0\expndtw-2 key-value\expnd-2\expndtw-9  \expnd0\expndtw-2 retrieval. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 test_associative_recall(model,\expnd-3\expndtw-15  \expnd0\expndtw0 num_pairs=10): """Simple associative recall test."""\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Create\expnd-1\expndtw-5  \expnd0\expndtw0 key-value\expnd-1\expndtw-5  \expnd-1\expndtw-4 pairs\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4572\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 keys = torch.randint(0, 500, (num_pairs,)) values\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randint(500,\expnd-2\expndtw-11  \expnd0\expndtw0 1000,\expnd-2\expndtw-11  \expnd0\expndtw0 (num_pairs,))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-6  \expnd0\expndtw0 Build\expnd-1\expndtw-6  \expnd0\expndtw0 sequence:\expnd-1\expndtw-6  \expnd0\expndtw0 [k1,\expnd-1\expndtw-6  \expnd0\expndtw0 v1,\expnd-1\expndtw-6  \expnd0\expndtw0 k2,\expnd-1\expndtw-6  \expnd0\expndtw0 v2,\expnd-1\expndtw-6  \expnd0\expndtw0 ...,\expnd-1\expndtw-6  \expnd0\expndtw0 query_key] sequence = []\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4973\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for k, v in zip(keys, values): \expnd0\expndtw-2 sequence.extend([k.item(), v.item()])\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Query\expnd-1\expndtw-4  \expnd0\expndtw0 random\expnd-1\expndtw-4  \expnd-1\expndtw-5 key\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3818\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 query_idx\expnd-2\expndtw-11  \expnd0\expndtw0 =\expnd-2\expndtw-11  \expnd0\expndtw0 torch.randint(0,\expnd-2\expndtw-11  \expnd0\expndtw0 num_pairs,\expnd-2\expndtw-11  \expnd0\expndtw0 (1,)).item() query_key = keys[query_idx].item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 target_value\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw-2 values[query_idx].item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 sequence.append(query_key)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw-2 torch.tensor(sequence).unsqueeze(0)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd0\expndtw-1  \expnd0\expndtw-2 Predict\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 with\expnd-1\expndtw-4  \expnd0\expndtw-2 torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd0\expndtw-2 model(input_ids)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 prediction\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 logits[0,\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd0\expndtw-2 1].argmax().item()\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 correct = (prediction == target_value) return\expnd-3\expndtw-14  \expnd0\expndtw0 correct,\expnd-3\expndtw-14  \expnd0\expndtw0 prediction,\expnd-3\expndtw-14  \expnd0\expndtw0 target_value\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Run\expnd-1\expndtw-4  \expnd0\expndtw0 multiple\expnd-1\expndtw-4  \expnd0\expndtw-2 trials\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print("Testing associative recall...") \expnd0\expndtw0 num_trials = 20\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 correct_count\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd-2\expndtw-10 0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 for\expnd-1\expndtw-4  \expnd0\expndtw0 trial\expnd-1\expndtw-3  \expnd0\expndtw0 in\expnd-1\expndtw-3  \expnd0\expndtw-2 range(num_trials):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri1939\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 correct,\expnd-2\expndtw-9  \expnd0\expndtw0 pred,\expnd-2\expndtw-9  \expnd0\expndtw0 target\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 test_associative_recall(model,\expnd-2\expndtw-9  \expnd0\expndtw0 num_pairs=10) correct_count += correct\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 if\expnd-1\expndtw-3  \expnd0\expndtw0 trial\expnd-1\expndtw-3  \expnd0\expndtw0 <\expnd0\expndtw-2  \expnd0\expndtw0 5:\expnd11\expndtw56  \expnd0\expndtw0 #\expnd0\expndtw-2  \expnd0\expndtw0 Show\expnd-1\expndtw-3  \expnd0\expndtw0 first\expnd0\expndtw-2  \expnd-1\expndtw-5 few\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb20\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Trial\expnd-2\expndtw-12  \expnd0\expndtw0 \'7Btrial+1\'7D:\expnd-2\expndtw-12  \expnd0\expndtw0 Pred=\'7Bpred\'7D,\expnd-2\expndtw-12  \expnd0\expndtw0 Target=\'7Btarget\'7D,\expnd-2\expndtw-11  \expnd0\expndtw0 \'7B'\f3 \uc1\u10003 ?\f2 '\expnd-2\expndtw-12  \expnd0\expndtw0 if\expnd-2\expndtw-12  \expnd0\expndtw0 correct\expnd-2\expndtw-12  \expnd0\expndtw0 else\expnd-2\expndtw-11  \expnd0\expndtw-2 '\f3 \uc1\u10007 ?\f2 '\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb60\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 accuracy\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 correct_count\expnd-1\expndtw-6  \expnd0\expndtw0 /\expnd-1\expndtw-5  \expnd0\expndtw-2 num_trials\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 print(f"\'5CnAccuracy:\expnd3\expndtw16  \expnd0\expndtw-2 \'7Baccuracy:.1%\'7D\expnd3\expndtw17  \expnd0\expndtw-2 (\'7Bcorrect_count\'7D/\'7Bnum_trials\'7D)")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri6311\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-11  \expnd0\expndtw0 Cell\expnd-2\expndtw-11  \expnd0\expndtw0 7:\expnd-2\expndtw-11  \expnd0\expndtw0 Interactive\expnd-2\expndtw-11  \expnd0\expndtw0 Exploration \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Interactive\expnd-1\expndtw-6  \expnd0\expndtw-2 Exploration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5506\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Modify\expnd-2\expndtw-12  \expnd0\expndtw0 parameters\expnd-2\expndtw-12  \expnd0\expndtw0 and\expnd-2\expndtw-12  \expnd0\expndtw0 observe\expnd-2\expndtw-12  \expnd0\expndtw0 effects. \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri3818\sl-582\sb32\f2\fs22\b0\expnd0\expndtw0\charscalex100 from\expnd-2\expndtw-11  \expnd0\expndtw0 ipywidgets\expnd-2\expndtw-11  \expnd0\expndtw0 import\expnd-2\expndtw-11  \expnd0\expndtw0 interact,\expnd-2\expndtw-11  \expnd0\expndtw0 FloatSlider,\expnd-2\expndtw-11  \expnd0\expndtw0 IntSlider \expnd0\expndtw-2 @interact(\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl-221\f2\fs22\b0\expnd0\expndtw0\charscalex100 beta=FloatSlider(min=0.1,\expnd-3\expndtw-14  \expnd0\expndtw0 max=5.0,\expnd-3\expndtw-14  \expnd0\expndtw0 step=0.1,\expnd-3\expndtw-14  \expnd0\expndtw-2 value=2.0),\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri2632\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_iter=IntSlider(min=5, max=50, step=5, value=20), tolerance=FloatSlider(min=1e-4,\expnd-3\expndtw-14  \expnd0\expndtw0 max=1e-2,\expnd-3\expndtw-14  \expnd0\expndtw0 step=1e-4,\expnd-3\expndtw-14  \expnd0\expndtw0 value=1e-3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 )\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4507\sl276\slmult1\sb80\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 explore_parameters(beta,\expnd-3\expndtw-15  \expnd0\expndtw0 max_iter,\expnd-3\expndtw-15  \expnd0\expndtw0 tolerance): """Interactive parameter exploration."""\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri5735\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 # Update model parameters model.energy_fn.beta = beta model.dynamics.beta = beta model.solver.max_iter = max_iter model.solver.tol_fp = tolerance model.solver.tol_energy\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 tolerance\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Run\expnd-1\expndtw-4  \expnd0\expndtw0 forward\expnd-1\expndtw-3  \expnd-1\expndtw-4 pass\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 input_ids\expnd-2\expndtw-9  \expnd0\expndtw0 =\expnd-2\expndtw-9  \expnd0\expndtw0 torch.randint(0,\expnd-2\expndtw-9  \expnd0\expndtw0 1000,\expnd-2\expndtw-9  \expnd0\expndtw0 (1,\expnd-2\expndtw-9  \expnd0\expndtw0 20)) with torch.no_grad():\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 logits,\expnd-1\expndtw-7  \expnd0\expndtw0 diag\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-7  \expnd0\expndtw0 model(input_ids,\expnd-1\expndtw-7  \expnd0\expndtw-2 return_diagnostics=True)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-1\expndtw-4  \expnd0\expndtw0 Display\expnd-1\expndtw-4  \expnd0\expndtw-2 results\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri5486\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 info = diag['solver_info'] print(f"Converged:\expnd-3\expndtw-16  \expnd0\expndtw0 \'7Binfo['converged']\'7D") print(f"Iterations: \'7Binfo['iterations']\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 print(f"Final\expnd-2\expndtw-10  \expnd0\expndtw0 energy:\expnd-2\expndtw-10  \expnd0\expndtw-2 \'7Binfo['final_energy']:.4f\'7D")\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb144\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\fi-245\ri5767\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 if 'energy_history' in info: plt.figure(figsize=(8, 4)) plt.plot(info['energy_history'],\expnd-3\expndtw-16  \expnd0\expndtw0 'o-') \expnd0\expndtw-2 plt.xlabel('Iteration') plt.ylabel('Energy')\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\ri1831\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 plt.title(f'Convergence\expnd-3\expndtw-14  \expnd0\expndtw0 (\uc1\u946 ?=\'7Bbeta\'7D,\expnd-3\expndtw-14  \expnd0\expndtw0 max_iter=\'7Bmax_iter\'7D,\expnd-3\expndtw-14  \expnd0\expndtw0 tol=\'7Btolerance\'7D)') plt.grid(True, alpha=0.3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 plt.show()\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb18\f2\fs20\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl-20\f2\fs2
{\field\fldlock
{\*\fldinst SHAPE  \\* MERGEFORMAT}
{\fldrslt 
{\shpgrp{\*\shpinst\shplid2327
\shpleft0\shptop0\shpright367\shpbottom20\shpfhdr0
\shpbxcolumn\shpbxignore\shpbypara\shpbyignore\shpwr3\shpwrk0\shpfblwtxt1\shpz9
\shplockanchor
\shpwr3\shpwrk0\shpfblwtxt1{\sp{\sn groupLeft}{\sv 0}}
{\sp{\sn groupTop}{\sv 0}}
{\sp{\sn groupRight}{\sv 367}}
{\sp{\sn groupBottom}{\sv 20}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn lidRegroup}{\sv 0}}
{\sp{\sn posrelh}{\sv 3}}
{\sp{\sn posrelv}{\sv 3}}

{\shp{\*\shpinst\shplid2328
{\sp{\sn relLeft}{\sv 0}}
{\sp{\sn relTop}{\sv 9}}
{\sp{\sn relRight}{\sv 367}}
{\sp{\sn relBottom}{\sv 10}}
{\sp{\sn fRelFlipH}{\sv 0}}
{\sp{\sn fRelFlipV}{\sv 0}}
{\sp{\sn shapeType}{\sv 0}}
{\sp{\sn rotation}{\sv 0}}
{\sp{\sn geoRight}{\sv 367}}
{\sp{\sn geoBottom}{\sv 1}}
{\sp{\sn shapePath}{\sv 4}}
{\sp{\sn pVerticies}{\sv 8;2;(0,0);(366,0)}}
{\sp{\sn pSegmentInfo}{\sv 2;5;16384;45824;1;45824;32768}}
{\sp{\sn fFillOK}{\sv 1}}
{\sp{\sn fFilled}{\sv 0}}
{\sp{\sn lineWidth}{\sv 12293}}
{\sp{\sn lineColor}{\sv 0}}
{\sp{\sn fLine}{\sv 1}}{\sp{\sn lineDashing}{\sv 1}}
{\sp{\sn lineType}{\sv 0}}
{\sp{\sn posrelh}{\sv 1}}
{\sp{\sn posrelv}{\sv 1}}
{\sp{\sn fArrowheadsOK}{\sv 1}}
{\sp{\sn fBehindDocument}{\sv 1}}
}}
}}
{\pict
{\*\picprop\defshp\shplid2327
{\sp{\sn shapeType}{\sv 75}}
{\sp{\sn fFlipH}{\sv 0}}
{\sp{\sn fFlipV}{\sv 0}}
{\sp{\sn fPseudoInline}{\sv 1}}
{\sp{\sn fLayoutInCell}{\sv 1}}
{\sp{\sn fLockPosition}{\sv 1}}
{\sp{\sn fLockRotation}{\sv 1}}
}
\piccropl0\piccropr0\piccropt-20\piccropb20\picwgoal367\pichgoal20
\wmetafile8\bliptag-1003278350\blipupi72
}
}}
\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb159\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-5  \expnd0\expndtw0 Prompt\expnd-1\expndtw-5  \expnd0\expndtw0 for\expnd-1\expndtw-4  \expnd0\expndtw0 AI\expnd-1\expndtw-5  \expnd0\expndtw0 Code\expnd-1\expndtw-4  \expnd0\expndtw0 Assistant\expnd-1\expndtw-5  \expnd0\expndtw0 (Final\expnd-1\expndtw-4  \expnd0\expndtw-2 Compilation)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 When\expnd-2\expndtw-8  \expnd0\expndtw0 ready\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 build\expnd-1\expndtw-6  \expnd0\expndtw0 Option\expnd-1\expndtw-5  \expnd0\expndtw0 3,\expnd-1\expndtw-5  \expnd0\expndtw0 provide\expnd-1\expndtw-6  \expnd0\expndtw0 this\expnd-1\expndtw-5  \expnd0\expndtw0 comprehensive\expnd-1\expndtw-5  \expnd0\expndtw-2 prompt:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Project:\expnd-2\expndtw-11  \expnd0\expndtw0 Unified\expnd-2\expndtw-11  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-2\expndtw-11  \expnd0\expndtw0 Architecture\expnd-2\expndtw-11  \expnd0\expndtw0 (Option\expnd-2\expndtw-10  \expnd-1\expndtw-4 3)**\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 >\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri664\sl276\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 Create a complete research-grade Python implementation where Mamba temporal processing,\expnd-1\expndtw-7  \expnd0\expndtw0 Modern\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw0 Network\expnd-1\expndtw-7  \expnd0\expndtw0 memory,\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 Deep\expnd-1\expndtw-7  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-7  \expnd0\expndtw0 Model\expnd-1\expndtw-7  \expnd0\expndtw0 reasoning\expnd-1\expndtw-7  \expnd0\expndtw0 are unified into a single energy-based framework.\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Core\expnd-1\expndtw-6  \expnd0\expndtw-2 Requirements:**\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\sect\sectd\sbkpage\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb80\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-8  \expnd0\expndtw0 Single\expnd-1\expndtw-6  \expnd0\expndtw0 energy\expnd-1\expndtw-6  \expnd0\expndtw0 function\expnd-1\expndtw-6  \expnd0\expndtw0 that\expnd-1\expndtw-6  \expnd0\expndtw0 encompasses\expnd-1\expndtw-5  \expnd0\expndtw0 both\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 retrieval\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 DEQ\expnd-1\expndtw-5  \expnd0\expndtw-2 equilibrium\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-8  \expnd0\expndtw0 Unified\expnd-1\expndtw-6  \expnd0\expndtw0 dynamics\expnd-1\expndtw-6  \expnd0\expndtw0 where\expnd-1\expndtw-6  \expnd0\expndtw0 each\expnd-1\expndtw-6  \expnd0\expndtw0 iteration\expnd-1\expndtw-5  \expnd0\expndtw0 performs\expnd-1\expndtw-6  \expnd0\expndtw0 both\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-6  \expnd0\expndtw0 updates\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-5  \expnd0\expndtw-2 retrieval\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb20\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-6  \expnd0\expndtw0 Hybrid\expnd-1\expndtw-4  \expnd0\expndtw0 solver\expnd-1\expndtw-4  \expnd0\expndtw0 that\expnd-1\expndtw-4  \expnd0\expndtw0 finds\expnd-1\expndtw-4  \expnd0\expndtw0 states\expnd-1\expndtw-4  \expnd0\expndtw0 satisfying\expnd-1\expndtw-4  \expnd0\expndtw0 both\expnd-1\expndtw-4  \expnd0\expndtw0 z*\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 f(z*)\expnd-1\expndtw-4  \expnd0\expndtw0 AND\expnd-1\expndtw-4  \f3\expnd0\expndtw0 \uc1\u8711 ?\f2 E(z*)\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-3  \expnd-2\expndtw-10 0\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb23\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-9  \expnd0\expndtw0 Three\expnd-1\expndtw-7  \expnd0\expndtw0 solver\expnd-1\expndtw-7  \expnd0\expndtw0 modes:\expnd-1\expndtw-6  \expnd0\expndtw0 alternating,\expnd-1\expndtw-7  \expnd0\expndtw0 simultaneous,\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw-2 cascade\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb37\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-3\expndtw-13  \expnd0\expndtw0 Implicit\expnd-2\expndtw-10  \expnd0\expndtw0 differentiation\expnd-2\expndtw-11  \expnd0\expndtw0 for\expnd-2\expndtw-10  \expnd0\expndtw0 memory-efficient\expnd-2\expndtw-10  \expnd0\expndtw-2 backpropagation\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Implementation\expnd3\expndtw16  \expnd0\expndtw-2 Order:**\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-6  \expnd0\expndtw0 Phase\expnd-1\expndtw-5  \expnd0\expndtw0 1:\expnd-1\expndtw-5  \expnd0\expndtw0 Repository\expnd-1\expndtw-5  \expnd0\expndtw0 structure\expnd-1\expndtw-5  \expnd0\expndtw0 and\expnd-1\expndtw-5  \expnd0\expndtw-2 dependencies\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri278\sl276\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-6  \expnd0\expndtw0 Phase\expnd-1\expndtw-6  \expnd0\expndtw0 2:\expnd-1\expndtw-6  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 function\expnd-1\expndtw-6  \expnd0\expndtw0 (src/core/energy.py)\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-6  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 consistency\expnd-1\expndtw-6  \expnd0\expndtw0 +\expnd-1\expndtw-6  \expnd0\expndtw0 regularization \expnd0\expndtw-2 terms\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Phase\expnd-1\expndtw-7  \expnd0\expndtw0 3:\expnd-1\expndtw-7  \expnd0\expndtw0 Unified\expnd-1\expndtw-7  \expnd0\expndtw0 dynamics\expnd-1\expndtw-7  \expnd0\expndtw0 (src/core/dynamics.py)\expnd-1\expndtw-7  \expnd0\expndtw0 blending\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 and\expnd-1\expndtw-7  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-7  \expnd0\expndtw-2 updates\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-9  \expnd0\expndtw0 Phase\expnd-2\expndtw-9  \expnd0\expndtw0 4:\expnd-2\expndtw-8  \expnd0\expndtw0 Hybrid\expnd-2\expndtw-9  \expnd0\expndtw0 equilibrium\expnd-2\expndtw-8  \expnd0\expndtw0 solver\expnd-2\expndtw-9  \expnd0\expndtw0 (src/solvers/hybrid_solver.py)\expnd-2\expndtw-9  \expnd0\expndtw0 with\expnd-2\expndtw-8  \expnd0\expndtw0 all\expnd-2\expndtw-9  \expnd0\expndtw0 three\expnd-2\expndtw-8  \expnd0\expndtw-2 modes\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Phase\expnd-1\expndtw-7  \expnd0\expndtw0 5:\expnd-1\expndtw-7  \expnd0\expndtw0 Full\expnd-1\expndtw-7  \expnd0\expndtw0 model\expnd-1\expndtw-7  \expnd0\expndtw0 (src/models/unified.py)\expnd-1\expndtw-7  \expnd0\expndtw0 integrating\expnd-1\expndtw-7  \expnd0\expndtw0 all\expnd-1\expndtw-6  \expnd0\expndtw-2 components\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-10  \expnd0\expndtw0 Phase\expnd-2\expndtw-8  \expnd0\expndtw0 6:\expnd-2\expndtw-8  \expnd0\expndtw0 Training\expnd-2\expndtw-8  \expnd0\expndtw0 infrastructure\expnd-1\expndtw-7  \expnd0\expndtw0 with\expnd-2\expndtw-8  \expnd0\expndtw0 energy-based\expnd-2\expndtw-8  \expnd0\expndtw0 objectives\expnd-2\expndtw-8  \expnd0\expndtw0 and\expnd-2\expndtw-8  \expnd0\expndtw0 curriculum\expnd-1\expndtw-7  \expnd0\expndtw-2 learning\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-3\expndtw-13  \expnd0\expndtw0 Phase\expnd-2\expndtw-11  \expnd0\expndtw0 7:\expnd-2\expndtw-11  \expnd0\expndtw0 Theoretical\expnd-2\expndtw-11  \expnd0\expndtw0 validation\expnd-2\expndtw-11  \expnd0\expndtw0 experiments\expnd-2\expndtw-11  \expnd0\expndtw0 (convergence,\expnd-2\expndtw-11  \expnd0\expndtw0 Lyapunov,\expnd-2\expndtw-10  \expnd0\expndtw-2 contraction)\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Phase\expnd-1\expndtw-7  \expnd0\expndtw0 8:\expnd-1\expndtw-7  \expnd0\expndtw0 Practical\expnd-1\expndtw-7  \expnd0\expndtw0 task\expnd-1\expndtw-6  \expnd0\expndtw0 experiments\expnd-1\expndtw-7  \expnd0\expndtw0 (associative\expnd-1\expndtw-7  \expnd0\expndtw0 recall,\expnd-1\expndtw-7  \expnd0\expndtw0 continual\expnd-1\expndtw-6  \expnd0\expndtw-2 learning)\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Phase\expnd-1\expndtw-6  \expnd0\expndtw0 9:\expnd-1\expndtw-6  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 landscape\expnd-1\expndtw-6  \expnd0\expndtw0 visualization\expnd-1\expndtw-6  \expnd0\expndtw-2 tools\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-6  \expnd0\expndtw0 Phase\expnd-1\expndtw-6  \expnd0\expndtw0 10:\expnd-1\expndtw-6  \expnd0\expndtw0 Documentation\expnd-1\expndtw-6  \expnd0\expndtw0 and\expnd-1\expndtw-6  \expnd0\expndtw0 interactive\expnd-1\expndtw-6  \expnd0\expndtw0 demo\expnd-1\expndtw-5  \expnd0\expndtw-2 notebook\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Key\expnd-1\expndtw-6  \expnd0\expndtw0 Design\expnd-1\expndtw-5  \expnd0\expndtw-2 Principles:**\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-6  \expnd0\expndtw0 Energy\expnd-1\expndtw-6  \expnd0\expndtw0 minimization\expnd-1\expndtw-6  \expnd0\expndtw0 as\expnd-1\expndtw-6  \expnd0\expndtw0 the\expnd-1\expndtw-6  \expnd0\expndtw0 primary\expnd-1\expndtw-6  \expnd0\expndtw0 objective\expnd-1\expndtw-6  \expnd0\expndtw0 (not\expnd-1\expndtw-6  \expnd0\expndtw0 just\expnd-1\expndtw-6  \expnd0\expndtw0 fixed-\expnd0\expndtw-2 point)\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-10  \expnd0\expndtw0 Lyapunov\expnd-2\expndtw-8  \expnd0\expndtw0 stability\expnd-2\expndtw-8  \expnd0\expndtw0 guarantees\expnd-2\expndtw-8  \expnd0\expndtw0 through\expnd-2\expndtw-8  \expnd0\expndtw0 proper\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-1\expndtw-7  \expnd0\expndtw-2 design\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-8  \expnd0\expndtw0 Compositional\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-2\expndtw-8  \expnd0\expndtw0 via\expnd-2\expndtw-8  \expnd0\expndtw0 Hopfield\'92s\expnd-2\expndtw-8  \expnd0\expndtw0 associative\expnd-1\expndtw-7  \expnd0\expndtw-2 properties\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb37\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-4  \expnd0\expndtw0 Implicit\expnd-1\expndtw-4  \expnd0\expndtw0 depth\expnd-1\expndtw-4  \expnd0\expndtw0 via\expnd-1\expndtw-4  \expnd0\expndtw0 DEQ\expnd-1\expndtw-4  \expnd0\expndtw-2 wrapper\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-6  \expnd0\expndtw0 Theoretical\expnd-1\expndtw-6  \expnd0\expndtw0 rigor\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-6  \expnd0\expndtw0 empirical\expnd-1\expndtw-6  \expnd0\expndtw-2 validation\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Success\expnd-2\expndtw-9  \expnd0\expndtw-2 Criteria:**\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-11  \expnd0\expndtw0 All\expnd-2\expndtw-9  \expnd0\expndtw0 convergence\expnd-2\expndtw-8  \expnd0\expndtw0 tests\expnd-2\expndtw-9  \expnd0\expndtw0 pass\expnd-2\expndtw-8  \expnd0\expndtw0 (contraction,\expnd-2\expndtw-9  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw0 descent,\expnd-2\expndtw-9  \expnd0\expndtw0 stability,\expnd-2\expndtw-8  \expnd0\expndtw-2 Lyapunov)\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-7  \expnd0\expndtw0 Energy\expnd-1\expndtw-5  \expnd0\expndtw0 landscapes\expnd-1\expndtw-5  \expnd0\expndtw0 show\expnd-1\expndtw-5  \expnd0\expndtw0 clear\expnd-1\expndtw-5  \expnd0\expndtw0 basins\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-4  \expnd0\expndtw-2 attraction\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-8  \expnd0\expndtw0 Outperforms\expnd-2\expndtw-8  \expnd0\expndtw0 baseline\expnd-1\expndtw-7  \expnd0\expndtw0 on\expnd-2\expndtw-8  \expnd0\expndtw0 memory-intensive\expnd-1\expndtw-7  \expnd-1\expndtw-4 tasks\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-11  \expnd0\expndtw0 Demonstrates\expnd-2\expndtw-8  \expnd0\expndtw0 continual\expnd-2\expndtw-8  \expnd0\expndtw0 learning\expnd-2\expndtw-8  \expnd0\expndtw0 without\expnd-2\expndtw-8  \expnd0\expndtw0 catastrophic\expnd-2\expndtw-8  \expnd0\expndtw-2 forgetting\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li288\fi-188\sl240\slmult1\sb38\tx288\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-2\expndtw-10  \expnd0\expndtw0 Clean,\expnd-2\expndtw-8  \expnd0\expndtw0 modular,\expnd-2\expndtw-8  \expnd0\expndtw0 well-documented\expnd-1\expndtw-7  \expnd0\expndtw0 code\expnd-2\expndtw-8  \expnd0\expndtw0 with\expnd-2\expndtw-8  \expnd0\expndtw0 type\expnd-1\expndtw-7  \expnd0\expndtw-2 hints\par\pard\plain\s2\ls25\ilvl0\nooverflow\nocwrap\lnbrkrule\li228\fi-128\sl240\slmult1\sb38\tx228\f2\fs22\b0\charscalex100 \uc1\u8203 ?\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```markdown\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-9  \expnd0\expndtw0 Advanced\expnd-2\expndtw-8  \expnd0\expndtw0 Unified\expnd-2\expndtw-8  \expnd0\expndtw0 Architecture:\expnd-2\expndtw-8  \expnd0\expndtw0 Optimization\expnd-2\expndtw-8  \expnd0\expndtw-2 Variants\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri194\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Build\expnd-1\expndtw-4  \expnd0\expndtw0 an\expnd-1\expndtw-4  \expnd0\expndtw0 enhanced\expnd-1\expndtw-4  \expnd0\expndtw0 version\expnd-1\expndtw-4  \expnd0\expndtw0 of\expnd-1\expndtw-4  \expnd0\expndtw0 the\expnd-1\expndtw-4  \expnd0\expndtw0 Mamba-Hopfield-DEQ\expnd-1\expndtw-4  \expnd0\expndtw0 architecture\expnd-1\expndtw-4  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw0 the\expnd-1\expndtw-4  \expnd0\expndtw0 following\expnd-1\expndtw-4  \expnd0\expndtw0 modular improvements. Implement as separate, swappable components that can be mixed and \expnd0\expndtw-2 matched.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-5  \expnd0\expndtw0 Project\expnd-1\expndtw-4  \expnd0\expndtw-2 Structure\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 unified-mamba-hopfield-deq-advanced/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd-1\expndtw-4 src/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  backbones/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3150\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  mamba.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 Original\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-4  \expnd0\expndtw-2 backbone\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2955\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  hybrid.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-3  \expnd0\expndtw0 +\expnd-1\expndtw-3  \expnd0\expndtw0 sparse\expnd-1\expndtw-3  \expnd0\expndtw-2 attention\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2919\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  retnet.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-4  \expnd0\expndtw0 RetNet\expnd-1\expndtw-3  \expnd0\expndtw-2 alternative\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2914\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  rwkv.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-5  \expnd0\expndtw0 RWKV\expnd-1\expndtw-4  \expnd0\expndtw-2 alternative\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  memory/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3004\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  hopfield.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Basic\expnd-1\expndtw-4  \expnd0\expndtw0 Modern\expnd-1\expndtw-4  \expnd0\expndtw-2 Hopfield\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3114\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  hierarchical.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Multi-level\expnd-1\expndtw-6  \expnd0\expndtw0 memory\expnd-1\expndtw-6  \expnd0\expndtw-2 (L1/L2/L3)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3310\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  sparse_hash.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 LSH-based\expnd-1\expndtw-5  \expnd0\expndtw0 sparse\expnd-1\expndtw-5  \expnd0\expndtw-2 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3232\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  product_key.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Factorized\expnd-1\expndtw-5  \expnd0\expndtw-2 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  solvers/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3151\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  anderson.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Anderson\expnd-1\expndtw-7  \expnd0\expndtw0 acceleration\expnd-1\expndtw-7  \expnd0\expndtw-2 (baseline)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx2882\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  lbfgs.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Quasi-Newton\expnd-1\expndtw-6  \expnd0\expndtw-2 methods\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3212\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  neural_ode.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 ODE-based\expnd-1\expndtw-5  \expnd0\expndtw-2 solver\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3029\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  learned.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-9  \expnd0\expndtw0 Meta-learned\expnd-1\expndtw-6  \expnd0\expndtw-2 accelerator\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3053\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  early_exit.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-10  \expnd0\expndtw0 Confidence-based\expnd-1\expndtw-7  \expnd0\expndtw0 early\expnd-1\expndtw-7  \expnd0\expndtw-2 stopping\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  optimizations/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3114\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  contractive.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-6  \expnd0\expndtw0 Guaranteed\expnd-1\expndtw-5  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-5  \expnd0\expndtw0 <\expnd-1\expndtw-5  \expnd-2\expndtw-10 1\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb37\tx3432\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  energy_shaping.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-4  \expnd0\expndtw0 Hessian\expnd-1\expndtw-4  \expnd0\expndtw-2 conditioning\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3395\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9500 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  mixed_precision.py\expnd0\expndtw0 \tab #\expnd-1\expndtw-7  \expnd0\expndtw0 FP16/FP32\expnd-1\expndtw-5  \expnd0\expndtw-2 mixing\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx3053\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9474 ?\expnd6\expndtw30   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  caching.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-10  \expnd0\expndtw0 Warm-start\expnd-2\expndtw-9  \expnd0\expndtw-2 equilibria\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 \uc1\u9474 ?\expnd6\expndtw29   \expnd0\expndtw0 \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd0\expndtw-2  models/\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\tx664\tx3454\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \uc1\u9474 ?\expnd0\expndtw0 \tab \uc1\u9492 ?\uc1\u9472 ?\uc1\u9472 ?\expnd-1\expndtw-3  \expnd0\expndtw-2 unified_advanced.py\expnd0\expndtw0 \tab #\expnd-2\expndtw-8  \expnd0\expndtw0 Main\expnd-1\expndtw-6  \expnd0\expndtw0 configurable\expnd-1\expndtw-5  \expnd0\expndtw-2 model\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-5  \expnd0\expndtw0 Core\expnd-1\expndtw-4  \expnd0\expndtw0 Components\expnd-1\expndtw-5  \expnd0\expndtw0 to\expnd-1\expndtw-4  \expnd0\expndtw-2 Implement\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-9  \expnd0\expndtw0 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Hybrid\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba-Attention\expnd-1\expndtw-7  \expnd0\expndtw0 Backbone\expnd-1\expndtw-6  \expnd0\expndtw-2 (src/backbones/hybrid.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri6045\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 HybridBackbone(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri1159\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Interleave\expnd-1\expndtw-5  \expnd0\expndtw0 Mamba\expnd-1\expndtw-5  \expnd0\expndtw0 layers\expnd-1\expndtw-5  \expnd0\expndtw0 (cheap,\expnd-1\expndtw-5  \expnd0\expndtw0 O(L))\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 sparse\expnd-1\expndtw-5  \expnd0\expndtw0 attention\expnd-1\expndtw-5  \expnd0\expndtw0 (expensive,\expnd-1\expndtw-5  \expnd0\expndtw0 O(L\'B2)). Pattern: [Mamba \'D7 N, Attention, Mamba \'D7 N, Attention, ...]\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Config:\par\pard\plain\s2\ls26\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention_every:\expnd-2\expndtw-8  \expnd0\expndtw0 Insert\expnd-1\expndtw-7  \expnd0\expndtw0 attention\expnd-1\expndtw-7  \expnd0\expndtw0 every\expnd-1\expndtw-7  \expnd0\expndtw0 N\expnd-1\expndtw-7  \expnd0\expndtw0 Mamba\expnd-1\expndtw-7  \expnd0\expndtw0 layers\expnd-1\expndtw-7  \expnd0\expndtw0 (default:\expnd-1\expndtw-7  \expnd-1\expndtw-5 4)\par\pard\plain\s2\ls26\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 attention_type:\expnd-2\expndtw-8  \expnd0\expndtw0 'local'\expnd-1\expndtw-7  \expnd0\expndtw0 (sliding\expnd-2\expndtw-8  \expnd0\expndtw0 window)\expnd-1\expndtw-7  \expnd0\expndtw0 or\expnd-2\expndtw-8  \expnd0\expndtw0 'global'\expnd-1\expndtw-7  \expnd0\expndtw0 (full\expnd-1\expndtw-7  \expnd0\expndtw-2 attention)\par\pard\plain\s2\ls26\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 window_size:\expnd-2\expndtw-8  \expnd0\expndtw0 For\expnd-2\expndtw-8  \expnd0\expndtw0 local\expnd-1\expndtw-7  \expnd0\expndtw0 attention\expnd-2\expndtw-8  \expnd0\expndtw0 (default:\expnd-1\expndtw-7  \expnd-1\expndtw-4 256)\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb80\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri512\sl552\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Key\expnd-1\expndtw-5  \expnd0\expndtw0 method**:\expnd-1\expndtw-5  \expnd0\expndtw0 `forward(x)`\expnd-1\expndtw-5  \expnd0\expndtw0 returns\expnd-1\expndtw-5  \expnd0\expndtw0 processed\expnd-1\expndtw-5  \expnd0\expndtw0 sequence\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 mixed\expnd-1\expndtw-5  \expnd0\expndtw0 local/global\expnd-1\expndtw-5  \expnd0\expndtw0 context ### 2. Hierarchical Memory (src/memory/hierarchical.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5703\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 HierarchicalMemory(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Three-tier\expnd-2\expndtw-9  \expnd0\expndtw0 memory\expnd-1\expndtw-7  \expnd0\expndtw0 system\expnd-1\expndtw-7  \expnd0\expndtw0 inspired\expnd-1\expndtw-7  \expnd0\expndtw0 by\expnd-1\expndtw-7  \expnd0\expndtw0 biological\expnd-1\expndtw-7  \expnd0\expndtw-2 memory:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 L1\expnd-2\expndtw-9  \expnd0\expndtw0 (Episodic):\expnd-1\expndtw-6  \expnd0\expndtw0 Recent\expnd-1\expndtw-6  \expnd0\expndtw0 patterns,\expnd-1\expndtw-7  \expnd0\expndtw0 size\expnd-1\expndtw-6  \expnd0\expndtw0 ~1K,\expnd-1\expndtw-6  \expnd0\expndtw0 beta=2.0\expnd-1\expndtw-6  \expnd0\expndtw-2 (sharp)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri2750\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 L2\expnd-1\expndtw-6  \expnd0\expndtw0 (Semantic):\expnd-1\expndtw-6  \expnd0\expndtw0 Mid-term\expnd-1\expndtw-7  \expnd0\expndtw0 patterns,\expnd-1\expndtw-6  \expnd0\expndtw0 size\expnd-1\expndtw-6  \expnd0\expndtw0 ~10K,\expnd-1\expndtw-7  \expnd0\expndtw0 beta=1.0\expnd-1\expndtw-6  \expnd0\expndtw0 (medium) L3 (Schematic): Abstract schemas, size ~500, beta=0.5 (broad)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb3\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb67\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22\expnd0\expndtw-2 Methods:\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\li133\fi-133\sl240\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 retrieve(query)\expnd-2\expndtw-10  \expnd0\expndtw0 ->\expnd-1\expndtw-7  \expnd0\expndtw0 weighted\expnd-1\expndtw-7  \expnd0\expndtw0 combination\expnd-1\expndtw-7  \expnd0\expndtw0 from\expnd-1\expndtw-7  \expnd0\expndtw0 all\expnd-1\expndtw-7  \expnd0\expndtw-2 levels\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\li133\fi-133\sl240\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 store(pattern,\expnd-2\expndtw-8  \expnd0\expndtw0 level='auto')\expnd-1\expndtw-7  \expnd0\expndtw0 ->\expnd-2\expndtw-8  \expnd0\expndtw0 add\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-2\expndtw-8  \expnd0\expndtw0 appropriate\expnd-1\expndtw-7  \expnd0\expndtw-2 level\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\li133\fi-133\sl240\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 consolidate()\expnd-2\expndtw-9  \expnd0\expndtw0 ->\expnd-2\expndtw-8  \expnd0\expndtw0 periodic\expnd-2\expndtw-8  \expnd0\expndtw0 L1->L2->L3\expnd-2\expndtw-8  \expnd0\expndtw-2 transfer\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\ri3941\sl276\slmult1\sb37\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 router(query)\expnd-1\expndtw-6  \expnd0\expndtw0 ->\expnd-1\expndtw-6  \expnd0\expndtw0 learned\expnd-1\expndtw-6  \expnd0\expndtw0 routing\expnd-1\expndtw-6  \expnd0\expndtw0 weights\expnd-1\expndtw-6  \expnd0\expndtw0 [w1,\expnd-1\expndtw-6  \expnd0\expndtw0 w2,\expnd-1\expndtw-6  \expnd0\expndtw0 w3] \expnd-1\expndtw-4 """\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Routing**:\expnd-1\expndtw-4  \expnd0\expndtw0 Use\expnd-1\expndtw-4  \expnd0\expndtw0 small\expnd-1\expndtw-4  \expnd0\expndtw0 MLP\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-4  \expnd0\expndtw0 predict\expnd-1\expndtw-4  \expnd0\expndtw0 which\expnd-1\expndtw-4  \expnd0\expndtw0 memory\expnd-1\expndtw-4  \expnd0\expndtw0 level(s)\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-4  \expnd0\expndtw0 query\expnd-1\expndtw-4  \expnd0\expndtw0 based\expnd-1\expndtw-4  \expnd0\expndtw0 on\expnd-1\expndtw-4  \expnd0\expndtw0 query\expnd-1\expndtw-4  \expnd0\expndtw0 features ### 3. L-BFGS Solver with Early Exit (src/solvers/lbfgs.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri7488\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 LBFGSSolver: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Quasi-Newton\expnd-2\expndtw-8  \expnd0\expndtw0 solver\expnd-2\expndtw-8  \expnd0\expndtw0 for\expnd-2\expndtw-8  \expnd0\expndtw0 equilibrium\expnd-2\expndtw-8  \expnd0\expndtw-2 finding.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri4973\sl580\sb2\f2\fs22\b0\expnd0\expndtw0\charscalex100 Objective:\expnd-1\expndtw-7  \expnd0\expndtw0 minimize\expnd-1\expndtw-7  \expnd0\expndtw0 ||z\expnd-1\expndtw-7  \expnd0\expndtw0 -\expnd-1\expndtw-7  \expnd0\expndtw0 f(z)||\'B2\expnd-1\expndtw-7  \expnd0\expndtw0 +\expnd-1\expndtw-7  \expnd0\expndtw0 \uc1\u955 ?\'B7E(z) \expnd0\expndtw-2 Features:\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb40\tx477\f2\fs22\b0\expnd0\expndtw-2\charscalex100 L-BFGS\expnd0\expndtw1  \expnd0\expndtw-2 optimizer\expnd0\expndtw2  \expnd0\expndtw-2 (PyTorch\expnd0\expndtw2  \expnd0\expndtw-2 built-\expnd-1\expndtw-5 in)\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Early\expnd-1\expndtw-7  \expnd0\expndtw0 exit:\expnd-1\expndtw-7  \expnd0\expndtw0 confidence\expnd-1\expndtw-7  \expnd0\expndtw0 predictor\expnd-1\expndtw-7  \expnd0\expndtw0 (small\expnd-1\expndtw-7  \expnd0\expndtw0 MLP)\expnd-1\expndtw-7  \expnd0\expndtw0 estimates\expnd-1\expndtw-6  \expnd0\expndtw-2 convergence\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mixed\expnd-1\expndtw-7  \expnd0\expndtw0 iterations:\expnd-1\expndtw-4  \expnd0\expndtw0 first\expnd-1\expndtw-5  \expnd0\expndtw0 70%\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd0\expndtw0 FP16,\expnd-1\expndtw-4  \expnd0\expndtw0 last\expnd-1\expndtw-5  \expnd0\expndtw0 30%\expnd-1\expndtw-4  \expnd0\expndtw0 in\expnd-1\expndtw-4  FP32\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Config:\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 max_iter:\expnd-1\expndtw-6  \expnd0\expndtw0 30\expnd-1\expndtw-5  \expnd0\expndtw-2 (default)\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 min_iter:\expnd-1\expndtw-6  \expnd0\expndtw0 5\expnd-1\expndtw-5  \expnd0\expndtw0 (minimum\expnd-1\expndtw-6  \expnd0\expndtw0 before\expnd-1\expndtw-5  \expnd0\expndtw0 early\expnd-1\expndtw-6  \expnd0\expndtw0 exit\expnd-1\expndtw-5  \expnd0\expndtw-2 allowed)\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw-2\charscalex100 confidence_threshold:\expnd4\expndtw21  \expnd-1\expndtw-4 0.95\par\sect\sectd\sbkpage\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri5695\sl276\slmult1\sb80\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 history_size:\expnd-3\expndtw-13  \expnd0\expndtw0 10\expnd-3\expndtw-13  \expnd0\expndtw0 (L-BFGS\expnd-3\expndtw-13  \expnd0\expndtw0 memory) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb30\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\fi-245\ri4530\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 def\expnd-2\expndtw-10  \expnd0\expndtw0 solve(self,\expnd-2\expndtw-10  \expnd0\expndtw0 z_init,\expnd-2\expndtw-10  \expnd0\expndtw0 dynamics_fn,\expnd-2\expndtw-10  \expnd0\expndtw0 energy_fn): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Returns:\expnd-2\expndtw-12  \expnd0\expndtw0 (z_equilibrium,\expnd-2\expndtw-11  \expnd0\expndtw-2 info_dict)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\ri2369\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 info_dict\expnd-2\expndtw-9  \expnd0\expndtw0 contains:\expnd-2\expndtw-9  \expnd0\expndtw0 iterations_used,\expnd-2\expndtw-9  \expnd0\expndtw0 converged,\expnd-2\expndtw-9  \expnd0\expndtw0 confidence,\expnd-2\expndtw-9  \expnd0\expndtw0 energy \expnd-1\expndtw-4 """\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri258\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Confidence\expnd-1\expndtw-5  \expnd0\expndtw0 predictor**:\expnd-1\expndtw-5  \expnd0\expndtw0 Train\expnd-1\expndtw-5  \expnd0\expndtw0 auxiliary\expnd-1\expndtw-5  \expnd0\expndtw0 MLP\expnd-1\expndtw-5  \expnd0\expndtw0 on\expnd-1\expndtw-5  \expnd0\expndtw0 (z,\expnd-1\expndtw-5  \expnd0\expndtw0 residual)\expnd-1\expndtw-5  \expnd0\expndtw0 ->\expnd-1\expndtw-5  \expnd0\expndtw0 probability\expnd-1\expndtw-5  \expnd0\expndtw0 of\expnd-1\expndtw-5  \expnd0\expndtw0 being\expnd-1\expndtw-5  \expnd0\expndtw0 converged. Meta-train this across many convergence trajectories.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-1\expndtw-5  \expnd0\expndtw0 4.\expnd-1\expndtw-4  \expnd0\expndtw0 Sparse\expnd-1\expndtw-4  \expnd0\expndtw0 Hash\expnd-1\expndtw-4  \expnd0\expndtw0 Memory\expnd-1\expndtw-4  \expnd0\expndtw-2 (src/memory/sparse_hash.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5654\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 SparseHashMemory(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Locality-Sensitive\expnd-2\expndtw-10  \expnd0\expndtw0 Hashing\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 O(\uc1\u8730 ?M)\expnd-2\expndtw-8  \expnd0\expndtw0 retrieval\expnd-1\expndtw-7  \expnd0\expndtw0 instead\expnd-1\expndtw-7  \expnd0\expndtw0 of\expnd-1\expndtw-7  \expnd0\expndtw-2 O(M).\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Uses\expnd-1\expndtw-7  \expnd0\expndtw0 random\expnd-1\expndtw-7  \expnd0\expndtw0 projection\expnd-1\expndtw-6  \expnd0\expndtw-2 hashing:\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 num_buckets:\expnd-2\expndtw-8  \expnd0\expndtw0 256\expnd-1\expndtw-7  \expnd0\expndtw-2 (default)\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 patterns\expnd-1\expndtw-6  \expnd0\expndtw0 stored\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd0\expndtw-2 buckets\par\pard\plain\s2\ls28\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 retrieve\expnd-1\expndtw-6  \expnd0\expndtw0 only\expnd-1\expndtw-5  \expnd0\expndtw0 from\expnd-1\expndtw-5  \expnd0\expndtw0 top-K\expnd-1\expndtw-5  \expnd0\expndtw-2 buckets\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb30\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22\expnd0\expndtw-2 Methods:\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\li133\fi-133\sl240\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 hash(query)\expnd-1\expndtw-7  \expnd0\expndtw0 ->\expnd-1\expndtw-6  \expnd0\expndtw0 bucket_indices\expnd-1\expndtw-7  \expnd0\expndtw0 (top\expnd-1\expndtw-6  \expnd0\expndtw0 K\expnd-1\expndtw-6  \expnd0\expndtw-2 buckets)\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\li133\fi-133\sl240\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 store(pattern)\expnd-1\expndtw-7  \expnd0\expndtw0 ->\expnd-1\expndtw-7  \expnd0\expndtw0 adds\expnd-1\expndtw-6  \expnd0\expndtw0 to\expnd-1\expndtw-7  \expnd0\expndtw0 appropriate\expnd-1\expndtw-6  \expnd0\expndtw-2 bucket\par\pard\plain\s2\ls27\ilvl0\nooverflow\nocwrap\lnbrkrule\ri3425\sl276\slmult1\sb38\tx133\f2\fs22\b0\expnd0\expndtw0\charscalex100 retrieve(query,\expnd-2\expndtw-10  \expnd0\expndtw0 top_k=10)\expnd-2\expndtw-10  \expnd0\expndtw0 ->\expnd-2\expndtw-10  \expnd0\expndtw0 Hopfield\expnd-2\expndtw-10  \expnd0\expndtw0 over\expnd-2\expndtw-10  \expnd0\expndtw0 candidates\expnd-2\expndtw-10  \expnd0\expndtw0 only \expnd-1\expndtw-4 """\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Hash\expnd-1\expndtw-4  \expnd0\expndtw0 function**:\expnd-1\expndtw-4  \expnd0\expndtw0 Learnable\expnd-1\expndtw-4  \expnd0\expndtw0 random\expnd-1\expndtw-4  \expnd0\expndtw0 projection:\expnd-1\expndtw-4  \expnd0\expndtw0 `hash_id\expnd-1\expndtw-4  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 argmax(W\expnd-1\expndtw-4  \expnd0\expndtw0 @\expnd-1\expndtw-4  \expnd0\expndtw0 query)`\expnd-1\expndtw-4  \expnd0\expndtw0 where\expnd-1\expndtw-4  \expnd0\expndtw0 W\expnd-1\expndtw-4  \expnd0\expndtw0 is (d_model, num_buckets)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-8  \expnd0\expndtw0 5.\expnd-1\expndtw-6  \expnd0\expndtw0 Contractive\expnd-1\expndtw-6  \expnd0\expndtw0 Dynamics\expnd-1\expndtw-6  \expnd0\expndtw-2 (src/optimizations/contractive.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5581\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 ContractiveDynamics(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Guarantee\expnd-1\expndtw-7  \expnd0\expndtw0 Lipschitz\expnd-1\expndtw-5  \expnd0\expndtw0 constant\expnd-1\expndtw-5  \expnd0\expndtw0 <\expnd-1\expndtw-5  \expnd0\expndtw0 1\expnd-1\expndtw-5  \expnd0\expndtw0 by\expnd-1\expndtw-5  \expnd0\expndtw-2 construction.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Techniques:\par\pard\plain\s2\ls29\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb37\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Spectral\expnd-1\expndtw-7  \expnd0\expndtw0 normalization\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-7  \expnd0\expndtw0 all\expnd-1\expndtw-6  \expnd0\expndtw0 linear\expnd-1\expndtw-6  \expnd0\expndtw-2 layers\par\sect\sectd\sbkpage\pard\plain\s2\ls29\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb80\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Bounded\expnd-2\expndtw-8  \expnd0\expndtw0 activations\expnd-2\expndtw-8  \expnd0\expndtw0 (tanh,\expnd-2\expndtw-8  \expnd0\expndtw-2 sigmoid)\par\pard\plain\s2\ls29\ilvl0\nooverflow\nocwrap\lnbrkrule\li344\ri4774\sl552\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Residual with contraction_factor < 1 Formula:\expnd-1\expndtw-5  \expnd0\expndtw0 z_next\expnd-1\expndtw-5  \expnd0\expndtw0 =\expnd-1\expndtw-5  \expnd0\expndtw0 z\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u945 ?\'B7(f(z)\expnd-1\expndtw-5  \expnd0\expndtw0 -\expnd-1\expndtw-5  \expnd0\expndtw0 z)\expnd-1\expndtw-5  \expnd0\expndtw0 where\expnd-1\expndtw-5  \expnd0\expndtw0 \uc1\u945 ?=0.9\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri1675\sl276\slmult1\expnd0\expndtw0\charscalex100 \column \f2\fs22 This\expnd-2\expndtw-8  \expnd0\expndtw0 mathematically\expnd-2\expndtw-8  \expnd0\expndtw0 guarantees\expnd-2\expndtw-8  \expnd0\expndtw0 convergence\expnd-2\expndtw-8  \expnd0\expndtw0 (Banach\expnd-2\expndtw-8  \expnd0\expndtw0 fixed-point\expnd-2\expndtw-8  \expnd0\expndtw0 theorem). \expnd-1\expndtw-4 """\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ###\expnd-2\expndtw-8  \expnd0\expndtw0 6.\expnd-1\expndtw-6  \expnd0\expndtw0 Equilibrium\expnd-1\expndtw-6  \expnd0\expndtw0 Caching\expnd-1\expndtw-5  \expnd0\expndtw-2 (src/optimizations/caching.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri7109\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 EquilibriumCache: \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Cache\expnd-1\expndtw-7  \expnd0\expndtw0 recent\expnd-1\expndtw-7  \expnd0\expndtw0 equilibria\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 warm-start\expnd-1\expndtw-6  \expnd0\expndtw-2 initialization.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s2\ls30\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Hash\expnd-1\expndtw-6  \expnd0\expndtw0 input\expnd-1\expndtw-6  \expnd0\expndtw0 contexts\expnd-1\expndtw-6  \expnd0\expndtw0 (using\expnd-1\expndtw-6  \expnd0\expndtw0 frozen\expnd-1\expndtw-5  \expnd0\expndtw-2 encoder)\par\pard\plain\s2\ls30\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 Store\expnd-2\expndtw-11  \expnd0\expndtw0 (context_hash,\expnd-2\expndtw-11  \expnd0\expndtw0 z_equilibrium)\expnd-2\expndtw-11  \expnd0\expndtw-2 pairs\par\pard\plain\s2\ls30\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 LRU\expnd-1\expndtw-4  \expnd0\expndtw0 cache\expnd-1\expndtw-4  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw-2 max_size=1000\par\pard\plain\s2\ls30\ilvl0\nooverflow\nocwrap\lnbrkrule\li477\fi-133\sl240\slmult1\sb38\tx477\f2\fs22\b0\expnd0\expndtw0\charscalex100 On\expnd-1\expndtw-7  \expnd0\expndtw0 forward\expnd-1\expndtw-5  \expnd0\expndtw0 pass:\expnd-1\expndtw-5  \expnd0\expndtw0 find\expnd-1\expndtw-5  \expnd0\expndtw0 nearest\expnd-1\expndtw-5  \expnd0\expndtw0 cached\expnd-1\expndtw-5  \expnd0\expndtw0 context,\expnd-1\expndtw-5  \expnd0\expndtw0 use\expnd-1\expndtw-5  \expnd0\expndtw0 as\expnd-1\expndtw-4  \expnd0\expndtw-2 z_init\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri3221\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Expected\expnd-1\expndtw-6  \expnd0\expndtw0 speedup:\expnd-1\expndtw-6  \expnd0\expndtw0 40-60%\expnd-1\expndtw-6  \expnd0\expndtw0 fewer\expnd-1\expndtw-6  \expnd0\expndtw0 iterations\expnd-1\expndtw-6  \expnd0\expndtw0 when\expnd-1\expndtw-6  \expnd0\expndtw0 cache\expnd-1\expndtw-6  \expnd0\expndtw0 hits \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri4507\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-3\expndtw-16  \expnd0\expndtw0 get_warm_start(self,\expnd-3\expndtw-15  \expnd0\expndtw0 context_embedding): """Returns cached z_init or None"""\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs17\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb169\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li244\fi-245\ri3602\sl276\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22 def\expnd-3\expndtw-14  \expnd0\expndtw0 update(self,\expnd-3\expndtw-14  \expnd0\expndtw0 context_embedding,\expnd-3\expndtw-14  \expnd0\expndtw0 z_equilibrium): """Add new equilibrium to cache"""\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri1939\sl552\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Context\expnd-1\expndtw-6  \expnd0\expndtw0 hashing**:\expnd-1\expndtw-6  \expnd0\expndtw0 Use\expnd-1\expndtw-6  \expnd0\expndtw0 mean-pooled\expnd-1\expndtw-6  \expnd0\expndtw0 Mamba\expnd-1\expndtw-6  \expnd0\expndtw0 output\expnd-1\expndtw-6  \expnd0\expndtw0 as\expnd-1\expndtw-6  \expnd0\expndtw0 context\expnd-1\expndtw-6  \expnd0\expndtw0 signature ### 7. Energy Shaping (src/optimizations/energy_shaping.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri4161\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 ShapedEnergyFunction(UnifiedEnergyFunction): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Add\expnd-2\expndtw-11  \expnd0\expndtw0 regularization\expnd-2\expndtw-8  \expnd0\expndtw0 terms\expnd-2\expndtw-8  \expnd0\expndtw0 for\expnd-2\expndtw-8  \expnd0\expndtw0 better-conditioned\expnd-2\expndtw-8  \expnd0\expndtw0 energy\expnd-2\expndtw-8  \expnd0\expndtw-2 landscape.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Additional\expnd-2\expndtw-10  \expnd0\expndtw-2 terms:\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Curvature\expnd-3\expndtw-15  \expnd0\expndtw0 regularization:\expnd-2\expndtw-12  \expnd0\expndtw0 penalize\expnd-2\expndtw-12  \expnd0\expndtw0 badly-conditioned\expnd-2\expndtw-12  \expnd0\expndtw-2 Hessian\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Saddle\expnd-2\expndtw-8  \expnd0\expndtw0 avoidance:\expnd-2\expndtw-8  \expnd0\expndtw0 penalize\expnd-2\expndtw-8  \expnd0\expndtw0 negative\expnd-2\expndtw-8  \expnd0\expndtw-2 eigenvalues\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li586\fi-242\sl240\slmult1\sb38\tx586\f2\fs22\b0\expnd0\expndtw0\charscalex100 Basin\expnd-2\expndtw-9  \expnd0\expndtw0 shaping:\expnd-1\expndtw-7  \expnd0\expndtw0 encourage\expnd-1\expndtw-7  \expnd0\expndtw0 single\expnd-1\expndtw-7  \expnd0\expndtw0 global\expnd-1\expndtw-6  \expnd0\expndtw-2 minimum\par\sect\sectd\sbkpage\margtsxn1660\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb71\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_total\expnd-1\expndtw-7  \expnd0\expndtw0 =\expnd-1\expndtw-4  \expnd0\expndtw0 E_hop\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 E_cons\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 \uc1\u955 ?1\'B7E_curvature\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw-2 \uc1\u955 ?2\'B7E_saddle\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb6\f2\fs20\b0\i0\par\sect\sectd\sbknone\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb244\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb93\expnd0\expndtw0\charscalex100 \column \f2\fs22\expnd0\expndtw-2 where:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri3602\sl276\slmult1\sb37\f2\fs22\b0\expnd0\expndtw0\charscalex100 E_curvature\expnd-1\expndtw-6  \expnd0\expndtw0 =\expnd-1\expndtw-6  \expnd0\expndtw0 \uc1\u931 ?(\uc1\u955 ?i\expnd-1\expndtw-6  \expnd0\expndtw0 -\expnd-1\expndtw-6  \expnd0\expndtw0 target)\'B2\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 Hessian\expnd-1\expndtw-6  \expnd0\expndtw0 eigenvalues\expnd-1\expndtw-6  \expnd0\expndtw0 \uc1\u955 ?i E_saddle = -min(0, min(\uc1\u955 ?i))\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 """\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri256\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Hessian\expnd-1\expndtw-5  \expnd0\expndtw0 estimation**:\expnd-1\expndtw-5  \expnd0\expndtw0 Use\expnd-1\expndtw-5  \expnd0\expndtw0 Hutchinson\'92s\expnd-1\expndtw-5  \expnd0\expndtw0 trace\expnd-1\expndtw-5  \expnd0\expndtw0 estimator\expnd-1\expndtw-5  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 random\expnd-1\expndtw-5  \expnd0\expndtw0 vectors\expnd-1\expndtw-5  \expnd0\expndtw0 (don\'92t\expnd-1\expndtw-5  \expnd0\expndtw0 compute full Hessian)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-6  \expnd0\expndtw0 Main\expnd-1\expndtw-6  \expnd0\expndtw0 Configurable\expnd-1\expndtw-6  \expnd0\expndtw0 Model\expnd-1\expndtw-5  \expnd0\expndtw-2 (src/models/unified_advanced.py)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\fi-245\ri5397\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 class\expnd-3\expndtw-16  \expnd0\expndtw0 AdvancedUnifiedModel(nn.Module): \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Unified\expnd-1\expndtw-7  \expnd0\expndtw0 model\expnd-1\expndtw-6  \expnd0\expndtw0 with\expnd-1\expndtw-6  \expnd0\expndtw0 swappable\expnd-1\expndtw-6  \expnd0\expndtw-2 components.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Config\expnd-1\expndtw-6  \expnd0\expndtw-2 dict:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri3221\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'backbone':\expnd-1\expndtw-6  \expnd0\expndtw0 'hybrid',\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw0 or\expnd-1\expndtw-6  \expnd0\expndtw0 'mamba',\expnd-1\expndtw-6  \expnd0\expndtw0 'retnet',\expnd-1\expndtw-6  \expnd0\expndtw0 'rwkv' 'backbone_config': \'7B'attention_every': 4\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri1159\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'memory':\expnd-1\expndtw-7  \expnd0\expndtw0 'hierarchical',\expnd8\expndtw40  \expnd0\expndtw0 #\expnd-1\expndtw-7  \expnd0\expndtw0 or\expnd-1\expndtw-7  \expnd0\expndtw0 'hopfield',\expnd-1\expndtw-7  \expnd0\expndtw0 'sparse_hash',\expnd-1\expndtw-7  \expnd0\expndtw0 'product_key' 'memory_config': \'7B'l1_size': 1000, 'l2_size': 10000, 'l3_size': 500\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri2377\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'solver': 'lbfgs',\expnd8\expndtw40  \expnd0\expndtw0 # or 'anderson', 'neural_ode', 'learned' 'solver_config':\expnd-2\expndtw-11  \expnd0\expndtw0 \'7B'max_iter':\expnd-2\expndtw-11  \expnd0\expndtw0 30,\expnd-2\expndtw-11  \expnd0\expndtw0 'confidence_threshold':\expnd-2\expndtw-11  \expnd0\expndtw0 0.95\'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li832\fi-245\ri6311\sl276\slmult1\sb1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'optimizations': \'7B 'contractive': True, 'energy_shaping':\expnd-3\expndtw-16  \expnd0\expndtw0 True, 'caching': True, \expnd0\expndtw-2 'mixed_precision': True, \expnd0\expndtw0 'early_exit': True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri8973\sl276\slmult1\sb38\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb37\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 def\expnd-1\expndtw-3  \f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 init\f0\expnd13\expndtw65\charscalex100{\ul   \f2\expnd0\expndtw0}\f2\expnd0\expndtw0 (self,\expnd0\expndtw-2  config):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-2\expndtw-8  \expnd0\expndtw0 Instantiate\expnd-1\expndtw-6  \expnd0\expndtw0 components\expnd-1\expndtw-6  \expnd0\expndtw0 based\expnd-1\expndtw-6  \expnd0\expndtw0 on\expnd-1\expndtw-5  \expnd0\expndtw-2 config\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri8\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 self.backbone\expnd-3\expndtw-15  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 self._build_backbone(config['backbone'],\expnd-3\expndtw-15  \expnd0\expndtw0 config['backbone_config']) self.memory = self._build_memory(config['memory'], config['memory_config'])\par\sect\sectd\sbkpage\cols2\colno1\colw360\colsr128\colno2\colw9072\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb155\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri2232\sl276\slmult1\sb80\expnd0\expndtw0\charscalex100 \column \f2\fs22 self.solver\expnd-3\expndtw-14  \expnd0\expndtw0 =\expnd-3\expndtw-14  \expnd0\expndtw0 self._build_solver(config['solver'],\expnd-3\expndtw-14  \expnd0\expndtw0 config['solver_config']) # etc.\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-2\expndtw-8  \expnd0\expndtw0 Implementation\expnd-2\expndtw-8  \expnd0\expndtw-2 Priority\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Phase\expnd-1\expndtw-5  \expnd0\expndtw0 1**\expnd-1\expndtw-5  \expnd0\expndtw0 (Core\expnd-1\expndtw-5  \expnd0\expndtw-2 enhancements):\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-8  \expnd0\expndtw0 Hybrid\expnd-2\expndtw-8  \expnd0\expndtw0 Mamba-Attention\expnd-1\expndtw-7  \expnd0\expndtw-2 backbone\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-7  \expnd0\expndtw0 Hierarchical\expnd-1\expndtw-7  \expnd0\expndtw-2 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-4  \expnd0\expndtw0 L-BFGS\expnd-1\expndtw-4  \expnd0\expndtw-2 solver\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Phase\expnd-1\expndtw-5  \expnd0\expndtw0 2**\expnd-1\expndtw-5  \expnd0\expndtw-2 (Efficiency):\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Early\expnd-1\expndtw-5  \expnd0\expndtw0 exit\expnd-1\expndtw-4  \expnd0\expndtw0 with\expnd-1\expndtw-4  \expnd0\expndtw-2 confidence\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Equilibrium\expnd-2\expndtw-11  \expnd0\expndtw-2 caching\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Mixed\expnd-1\expndtw-5  \expnd0\expndtw-2 precision\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Phase\expnd-1\expndtw-5  \expnd0\expndtw0 3**\expnd-1\expndtw-5  \expnd0\expndtw-2 (Theoretical):\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Contractive\expnd-2\expndtw-11  \expnd0\expndtw-2 dynamics\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Energy\expnd-1\expndtw-6  \expnd0\expndtw-2 shaping\par\pard\plain\s2\ls31\ilvl0\nooverflow\nocwrap\lnbrkrule\li342\fi-242\sl240\slmult1\sb38\tx342\f2\fs22\b0\expnd0\expndtw0\charscalex100 Sparse\expnd-1\expndtw-5  \expnd0\expndtw0 hash\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-5  \expnd0\expndtw0 (for\expnd-1\expndtw-5  \expnd0\expndtw0 very\expnd-1\expndtw-5  \expnd0\expndtw0 large\expnd-1\expndtw-4  \expnd0\expndtw-2 scale)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-5  \expnd0\expndtw0 Experiments\expnd-1\expndtw-4  \expnd0\expndtw0 to\expnd-1\expndtw-5  \expnd0\expndtw0 Add\expnd-1\expndtw-4  \expnd0\expndtw-2 (experiments/comparisons/)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4973\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 # experiments/comparisons/ablation_study.py \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Compare\expnd-1\expndtw-5  \expnd0\expndtw0 all\expnd-1\expndtw-5  \expnd0\expndtw-2 variants:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-5  \expnd0\expndtw0 Baseline\expnd-1\expndtw-4  \expnd0\expndtw0 (Mamba\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw0 Hopfield\expnd-1\expndtw-4  \expnd0\expndtw0 +\expnd-1\expndtw-4  \expnd0\expndtw-2 Anderson)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-3  \expnd0\expndtw0 +\expnd-1\expndtw-3  \expnd0\expndtw0 Hybrid\expnd0\expndtw-2  backbone\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-5  \expnd0\expndtw0 +\expnd-1\expndtw-5  \expnd0\expndtw0 Hierarchical\expnd-1\expndtw-4  \expnd0\expndtw-2 memory\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd-1\expndtw-3  \expnd0\expndtw0 +\expnd-1\expndtw-3  \expnd0\expndtw0 L-BFGS\expnd0\expndtw-2  solver\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 -\expnd0\expndtw-2  \expnd0\expndtw0 +\expnd0\expndtw-2  \expnd0\expndtw0 All\expnd0\expndtw-1  \expnd0\expndtw-2 optimizations\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Metrics:\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Convergence\expnd-2\expndtw-8  \expnd0\expndtw0 speed\expnd-2\expndtw-8  \expnd0\expndtw-2 (iterations)\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Wall-clock\expnd0\expndtw2  \expnd-1\expndtw-4 time\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Memory\expnd-1\expndtw-6  \expnd0\expndtw-2 usage\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 Task\expnd-2\expndtw-8  \expnd0\expndtw-2 accuracy\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li100\ri4937\sl276\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Scaling\expnd-2\expndtw-8  \expnd0\expndtw0 (vary\expnd-2\expndtw-8  \expnd0\expndtw0 sequence\expnd-2\expndtw-8  \expnd0\expndtw0 length,\expnd-2\expndtw-8  \expnd0\expndtw0 memory\expnd-2\expndtw-8  \expnd0\expndtw0 size) \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri4809\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 #\expnd-3\expndtw-16  \expnd0\expndtw0 experiments/comparisons/scaling_analysis.py \expnd-1\expndtw-4 """\par\sect\sectd\sbkpage\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb80\f2\fs22\b0\expnd0\expndtw-2\charscalex100 Test\expnd-1\expndtw-7  \expnd0\expndtw-2 scaling\expnd-1\expndtw-6  \expnd0\expndtw-2 behavior:\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Sequence\expnd-1\expndtw-5  \expnd0\expndtw0 length:\expnd-1\expndtw-5  \expnd0\expndtw0 512,\expnd-1\expndtw-5  \expnd0\expndtw0 1K,\expnd-1\expndtw-5  \expnd0\expndtw0 4K,\expnd-1\expndtw-5  16K\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Memory\expnd-1\expndtw-6  \expnd0\expndtw0 patterns:\expnd-1\expndtw-5  \expnd0\expndtw0 1K,\expnd-1\expndtw-6  \expnd0\expndtw0 10K,\expnd-1\expndtw-5  \expnd0\expndtw0 100K,\expnd-1\expndtw-5  1M\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl240\slmult1\sb38\tx233\f2\fs22\b0\expnd0\expndtw0\charscalex100 Model\expnd-1\expndtw-7  \expnd0\expndtw0 size:\expnd-1\expndtw-5  \expnd0\expndtw0 125M,\expnd-1\expndtw-5  \expnd0\expndtw0 350M,\expnd-1\expndtw-5  \expnd0\expndtw0 760M\expnd-1\expndtw-4  \expnd0\expndtw-2 params\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5433\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Plot:\expnd-1\expndtw-7  \expnd0\expndtw0 time\expnd-1\expndtw-7  \expnd0\expndtw0 vs\expnd-1\expndtw-7  \expnd0\expndtw0 scale\expnd-1\expndtw-7  \expnd0\expndtw0 for\expnd-1\expndtw-7  \expnd0\expndtw0 each\expnd-1\expndtw-7  \expnd0\expndtw0 configuration \expnd-1\expndtw-4 """\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Recommended\expnd-1\expndtw-7  \expnd0\expndtw0 Default\expnd-1\expndtw-6  \expnd0\expndtw-2 Configuration\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri5925\sl276\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 ```python \expnd0\expndtw0 RECOMMENDED_CONFIG\expnd-3\expndtw-16  \expnd0\expndtw0 =\expnd-3\expndtw-15  \expnd0\expndtw0 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'backbone': 'hybrid', \expnd0\expndtw-2 'backbone_config':\expnd3\expndtw16  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\ri6781\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'attention_every': 4, 'attention_type':\expnd-3\expndtw-16  \expnd0\expndtw0 'local', 'window_size': 256\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6941\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'memory':\expnd-3\expndtw-16  \expnd0\expndtw0 'hierarchical', 'memory_config': \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'l1_size':\expnd-2\expndtw-10  \expnd0\expndtw-2 1000,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'l2_size':\expnd-2\expndtw-10  \expnd0\expndtw-2 10000,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'l3_size':\expnd-2\expndtw-10  \expnd-1\expndtw-4 500,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'consolidation_freq':\expnd-1\expndtw-7  \expnd0\expndtw0 1000\expnd10\expndtw48  \expnd0\expndtw0 #\expnd-1\expndtw-6  \expnd0\expndtw-2 steps\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'solver': 'lbfgs', \expnd0\expndtw-2 'solver_config':\expnd3\expndtw16  \expnd-2\expndtw-10 \'7B\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'max_iter':\expnd-2\expndtw-11  \expnd-1\expndtw-5 30,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'min_iter':\expnd-2\expndtw-11  \expnd-1\expndtw-5 5,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw-2\charscalex100 'confidence_threshold':\expnd4\expndtw21  \expnd0\expndtw-2 0.95,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\sl240\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 'history_size':\expnd-3\expndtw-15  \expnd-1\expndtw-5 10\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D,\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb75\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li588\fi-245\ri6547\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 'optimizations': \'7B 'contractive': True, 'energy_shaping':\expnd-3\expndtw-16  \expnd0\expndtw0 True, 'caching': True, \expnd0\expndtw-2 'mixed_precision': True, \expnd0\expndtw0 'early_exit': True\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li344\sl240\slmult1\sb1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 \'7D,\par\sect\sectd\sbkpage\cols2\colno1\colw320\colsr24\colno2\colw9216\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb231\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-2\expndtw-10\charscalex100 \'7D\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\sb38\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\ri7085\sl276\slmult1\sb80\expnd0\expndtw0\charscalex100 \column \f2\fs22 # Training 'gradient_clip': 1.0, 'learning_rate': 1e-4, 'warmup_steps':\expnd-3\expndtw-16  \expnd0\expndtw0 1000\par\sect\sectd\sbknone\cols1\colno1\colw9560\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-5  \expnd0\expndtw0 Success\expnd-1\expndtw-4  \expnd0\expndtw-2 Criteria\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 **Must\expnd-1\expndtw-6  \expnd0\expndtw-2 achieve**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs22\b0\i0\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-318\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-17  \f2\fs22\expnd0\expndtw0 2-3x\expnd-1\expndtw-5  \expnd0\expndtw0 faster\expnd-1\expndtw-4  \expnd0\expndtw0 convergence\expnd-1\expndtw-5  \expnd0\expndtw0 than\expnd-1\expndtw-5  \expnd0\expndtw0 baseline\expnd-1\expndtw-4  \expnd0\expndtw0 (measured\expnd-1\expndtw-5  \expnd0\expndtw0 in\expnd-1\expndtw-5  \expnd0\expndtw0 wall-clock\expnd-1\expndtw-4  \expnd0\expndtw-2 time)\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-291\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-17  \f2\fs22\expnd0\expndtw0 Support\expnd-1\expndtw-4  \expnd0\expndtw0 10x\expnd-1\expndtw-4  \expnd0\expndtw0 more\expnd-1\expndtw-5  \expnd0\expndtw0 memory\expnd-1\expndtw-4  \expnd0\expndtw0 patterns\expnd-1\expndtw-4  \expnd0\expndtw0 (100K+)\expnd-1\expndtw-4  \expnd0\expndtw0 with\expnd-1\expndtw-5  \expnd0\expndtw0 hierarchical\expnd-1\expndtw-4  \expnd0\expndtw0 or\expnd-1\expndtw-4  \expnd0\expndtw0 sparse\expnd-1\expndtw-4  \expnd0\expndtw-2 memory\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-291\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-2\expndtw-12  \f2\fs22\expnd0\expndtw0 Maintain\expnd0\expndtw-2  \expnd0\expndtw0 or\expnd0\expndtw-2  \expnd0\expndtw0 improve\expnd0\expndtw-2  \expnd0\expndtw0 task\expnd0\expndtw-1  \expnd0\expndtw-2 accuracy\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-318\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-16  \f2\fs22\expnd0\expndtw0 All\expnd-1\expndtw-4  \expnd0\expndtw0 components\expnd-1\expndtw-4  \expnd0\expndtw0 work\expnd-1\expndtw-4  \expnd0\expndtw0 independently\expnd-1\expndtw-4  \expnd0\expndtw0 and\expnd-1\expndtw-4  \expnd0\expndtw0 compose\expnd-1\expndtw-4  \expnd0\expndtw-2 correctly\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb57\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw-2\charscalex100 **Bonus**:\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb2\f2\fs22\b0\i0\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-318\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-17  \f2\fs22\expnd0\expndtw0 Theoretical\expnd-1\expndtw-6  \expnd0\expndtw0 convergence\expnd-1\expndtw-7  \expnd0\expndtw0 guarantees\expnd-1\expndtw-6  \expnd0\expndtw0 hold\expnd-1\expndtw-6  \expnd0\expndtw0 empirically\expnd-1\expndtw-7  \expnd0\expndtw0 (with\expnd-1\expndtw-6  \expnd0\expndtw0 contractive\expnd-1\expndtw-6  \expnd0\expndtw-2 dynamics)\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-291\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-16  \f2\fs22\expnd0\expndtw0 Learned\expnd-1\expndtw-6  \expnd0\expndtw0 accelerator\expnd-1\expndtw-6  \expnd0\expndtw0 achieves\expnd-1\expndtw-5  \expnd0\expndtw0 50%+\expnd-1\expndtw-6  \expnd0\expndtw0 iteration\expnd-1\expndtw-6  \expnd0\expndtw0 reduction\expnd-1\expndtw-6  \expnd0\expndtw0 after\expnd-1\expndtw-5  \expnd0\expndtw0 meta-\expnd0\expndtw-2 training\par\pard\plain\s2\ls32\ilvl0\nooverflow\nocwrap\lnbrkrule\li233\fi-133\sl-318\tx233\f4\fs26\b0\expnd0\expndtw0\charscalex100 \uc1\u9989 ?\expnd-3\expndtw-15  \f2\fs22\expnd0\expndtw0 Scales\expnd-1\expndtw-3  \expnd0\expndtw0 to\expnd-1\expndtw-3  \expnd0\expndtw0 1M+\expnd-1\expndtw-3  \expnd0\expndtw0 memory\expnd-1\expndtw-3  \expnd0\expndtw0 patterns\expnd-1\expndtw-3  \expnd0\expndtw0 with\expnd-1\expndtw-3  \expnd0\expndtw0 sparse\expnd0\expndtw-2  hashing\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb57\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 ##\expnd-1\expndtw-7  \expnd0\expndtw0 Key\expnd-1\expndtw-6  \expnd0\expndtw0 Implementation\expnd-1\expndtw-6  \expnd0\expndtw-2 Notes\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-6  \expnd0\expndtw0 **Modularity**:\expnd-1\expndtw-6  \expnd0\expndtw0 Each\expnd-1\expndtw-6  \expnd0\expndtw0 component\expnd-1\expndtw-6  \expnd0\expndtw0 must\expnd-1\expndtw-6  \expnd0\expndtw0 work\expnd-1\expndtw-6  \expnd0\expndtw0 independently.\expnd-1\expndtw-6  \expnd0\expndtw0 Use\expnd-1\expndtw-6  \expnd0\expndtw0 factory\expnd-1\expndtw-6  \expnd0\expndtw0 pattern\expnd-1\expndtw-6  \expnd0\expndtw0 for\expnd-1\expndtw-6  \expnd0\expndtw0 building \expnd0\expndtw-2 components.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-9  \expnd0\expndtw0 **Config-driven**:\expnd-1\expndtw-6  \expnd0\expndtw0 Single\expnd-1\expndtw-7  \expnd0\expndtw0 config\expnd-1\expndtw-6  \expnd0\expndtw0 dict\expnd-1\expndtw-6  \expnd0\expndtw0 controls\expnd-1\expndtw-7  \expnd0\expndtw0 everything.\expnd-1\expndtw-6  \expnd0\expndtw0 Easy\expnd-1\expndtw-7  \expnd0\expndtw0 to\expnd-1\expndtw-6  \expnd0\expndtw0 run\expnd-1\expndtw-6  \expnd0\expndtw-2 ablations.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri256\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-5  \expnd0\expndtw0 **Gradients**:\expnd-1\expndtw-5  \expnd0\expndtw0 Ensure\expnd-1\expndtw-5  \expnd0\expndtw0 all\expnd-1\expndtw-5  \expnd0\expndtw0 new\expnd-1\expndtw-5  \expnd0\expndtw0 components\expnd-1\expndtw-5  \expnd0\expndtw0 are\expnd-1\expndtw-5  \expnd0\expndtw0 differentiable\expnd-1\expndtw-5  \expnd0\expndtw0 (or\expnd-1\expndtw-5  \expnd0\expndtw0 have\expnd-1\expndtw-5  \expnd0\expndtw0 custom\expnd-1\expndtw-5  \expnd0\expndtw0 backward \expnd0\expndtw-2 passes).\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-2\expndtw-12  \expnd0\expndtw0 **Testing**:\expnd-2\expndtw-9  \expnd0\expndtw0 Unit\expnd-2\expndtw-10  \expnd0\expndtw0 test\expnd-2\expndtw-9  \expnd0\expndtw0 each\expnd-2\expndtw-9  \expnd0\expndtw0 component\expnd-2\expndtw-10  \expnd0\expndtw0 separately\expnd-2\expndtw-9  \expnd0\expndtw0 before\expnd-2\expndtw-9  \expnd0\expndtw-2 integration.\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri256\sl276\slmult1\sb38\f2\fs22\b0\expnd0\expndtw0\charscalex100 1.\expnd-1\expndtw-5  \expnd0\expndtw0 **Logging**:\expnd-1\expndtw-5  \expnd0\expndtw0 Track\expnd-1\expndtw-5  \expnd0\expndtw0 per-component\expnd-1\expndtw-5  \expnd0\expndtw0 metrics\expnd-1\expndtw-5  \expnd0\expndtw0 (backbone\expnd-1\expndtw-5  \expnd0\expndtw0 time,\expnd-1\expndtw-5  \expnd0\expndtw0 solver\expnd-1\expndtw-5  \expnd0\expndtw0 iterations,\expnd-1\expndtw-5  \expnd0\expndtw0 cache\expnd-1\expndtw-5  \expnd0\expndtw0 hit\expnd-1\expndtw-5  \expnd0\expndtw0 rate, \expnd0\expndtw-2 etc.)\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\ri51\sl276\slmult1\f2\fs22\b0\expnd0\expndtw0\charscalex100 Start\expnd-1\expndtw-3  \expnd0\expndtw0 with\expnd-1\expndtw-3  \expnd0\expndtw0 Phase\expnd-1\expndtw-3  \expnd0\expndtw0 1,\expnd-1\expndtw-3  \expnd0\expndtw0 implement\expnd-1\expndtw-3  \expnd0\expndtw0 one\expnd-1\expndtw-3  \expnd0\expndtw0 component\expnd-1\expndtw-3  \expnd0\expndtw0 at\expnd-1\expndtw-3  \expnd0\expndtw0 a\expnd-1\expndtw-3  \expnd0\expndtw0 time,\expnd-1\expndtw-3  \expnd0\expndtw0 and\expnd-1\expndtw-3  \expnd0\expndtw0 validate\expnd-1\expndtw-3  \expnd0\expndtw0 before\expnd-1\expndtw-3  \expnd0\expndtw0 moving\expnd-1\expndtw-3  \expnd0\expndtw0 to\expnd-1\expndtw-3  \expnd0\expndtw0 the\expnd-1\expndtw-3  \expnd0\expndtw0 next. Each component should have a standalone test showing it improves on the baseline in its specific dimension (speed, memory, accuracy, etc.).\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb38\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\sl240\slmult1\sb76\f2\fs22\b0\i0\par\pard\plain\s1\nooverflow\nocwrap\lnbrkrule\li100\sl240\slmult1\f2\fs22\b0\expnd-1\expndtw-5\charscalex100 ```\par}